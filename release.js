!function(){"use strict";angular.module("enviroCar",["ngMaterial","ui-leaflet","ngAnimate","ngCookies","ui.router","pascalprecht.translate","translations","nvd3","enviroCar.api","enviroCar.auth","enviroCar.track","enviroCar.tracks","enviroCar.profile","enviroCar.community","materialCalendar","cl.paging","rzModule"]).value("ecBaseUrl","http://localhost:9999").run(["$rootScope","$state","$stateParams","$http","$cookies","UserCredentialsService",function(e,t,a,n,r,o){"ngInject";console.log("app started"),e.previewurl="",e.$state=t,e.$stateParams=a,o.clearCredentials(),e.$on("$stateChangeStart",function(e,a,n,r,s){var i=o.getCredentials();a.authenticate&&!i.username&&(t.transitionTo("login"),e.preventDefault())}),n.defaults.headers.post["X-CSRFToken"]=r.csrftoken}]),angular.module("enviroCar.api",[]),angular.module("enviroCar.auth",[]),angular.module("enviroCar.track",[]),angular.module("enviroCar.tracks",[]),angular.module("enviroCar.profile",[]),angular.module("enviroCar.community",[]),angular.module("ui-leaflet").directive("legend",["leafletLogger","$http","$timeout","leafletHelpers","leafletLegendHelpers",function(e,t,a,n,r){"ngInject";var o=e,s=n.errorHeader+" [Legend] ";return{restrict:"A",scope:!1,replace:!1,require:"leaflet",transclude:!1,link:function(e,t,a,i){var l,c,d,u,m=n.isArray,h=n.isString,g=n.isDefined,p=n.isFunction,_=i.getLeafletScope(),v=_.legend;_.$watch("legend",function(e){g(e)&&(l=e.legendClass?e.legendClass:"legend",c=e.position||"bottomright",u=e.type||"arcgis")},!0);var f=function(e,t,a){t&&t.layers&&t.layers.length>0&&(g(d)?r.updateLegend(d.getContainer(),t,u,a):(d=L.control({position:c}),d.onAdd=r.getOnAddLegend(t,l,u,a),d.addTo(e)),g(v.loadedData)&&p(v.loadedData)&&v.loadedData())};i.getMap().then(function(e){_.$watch("legend",function(t){return g(t)?g(t.url)||"arcgis"!==u||m(t.colors)&&m(t.labels)&&t.colors.length===t.labels.length?g(t.url)?void o.info(s+" loading legend service."):(g(d)&&(d.remove(e),d=null),d=L.control({position:c}),"arcgis"===u&&(d.onAdd=r.getOnAddArrayLegend(t,l)),void d.addTo(e)):void o.warn(s+" legend.colors and legend.labels must be set."):void(g(d)&&(d.removeFrom(e),d=null))}),_.$watch("legend.url",function(t){if(g(t)){if(!m(t)&&!h(t))return void o.warn(s+" legend.url must be an array or string.");for(var n,i=h(t)?[t]:t,l=function(e){o.warn(s+" legend.url not loaded.",e)},c=0;c<i.length;c++)r.addLegendURL(a.id,{url:i[c],method:"GET"}).then(function(a,r){return function(l){g(l.data.error)?o.warn(s+"Error loadin legend from: "+r,l.data.error.message):n&&n.layers&&n.layers.length>0?n.layers=n.layers.concat(l.data.layers):n=l.data,a===i.length-1&&f(e,n,t)}}(c)).catch(l)}}),_.$watch("legend.legendData",function(t){o.debug("legendData",t),!g(_.legend.url)&&g(t)&&f(e,t)},!0)})}}}]),angular.module("ui-leaflet").decorator("legendDirective",["$delegate",function(e){"ngInject";console.log(". . . . . . . . . . . . . ."),console.log("There are %s matching directives.",e.length),console.log(". . . . . . . . . . . . . .");var t=e[1];return console.log(". . . . . . . . . . . . . ."),[t]}])}(),function(){"use strict";function e(e,t,a,n){"ngInject";e.message="Initial Setup",e.loggedIn=""!==a.getCredentials().username,e.screenIsXS=t("xs"),e.screenIsSM=t("sm"),e.screenIsGTSM=t("gt-sm"),e.screenIsMD=t("md"),e.screenIsGTMD=t("gt-md"),e.$watch(function(){return t("xs")},function(t){console.log("screen is XS:"+t),e.screenIsXS=t}),e.$watch(function(){return t("sm")},function(t){console.log("screen is SM:"+t),e.screenIsSM=t}),e.$watch(function(){return t("gt-sm")},function(t){console.log("screen is gt-SM:"+t),e.screenIsGTSM=t}),e.$watch(function(){return t("md")},function(t){console.log("screen is MD:"+t),e.screenIsMD=t}),e.$watch(function(){return t("gt-md")},function(t){console.log("screen is gt-MD:"+t),e.screenIsGTMD=t}),e.logout=function(){a.clearCredentials(),n.resetFilterStates(),a.deleteCookies()},e.loggedIn=function(){return e.loggedIn}}e.$inject=["$scope","$mdMedia","UserCredentialsService","FilterStateService"],angular.module("enviroCar").controller("AppCtrl",e)}(),angular.module("translations",[]).constant("LOCALES",{locales:{de_DE:"Deutsch",en_EN:"English"},preferredLocale:"en_EN"}).config(["$translateProvider",function(e){"ngInject";console.log("translation configuration set up"),e.translations("en",{"WEBSITE-TITLE":"EnviroCar Webapp",LANGUAGE:"Language",CLICK_FOR_MORE_INFO:"click for more information...",COMMING_SOON:"Coming Soon...",NO_TRACKS:"You have no tracks uploaded yet.",CHANGE_LANGUAGE:"Change Language","OPEN-NAV":"Open Sidenav","CLOSE-NAV":"Close Sidenav","TT_SIDENAV-OPEN":"opens the sidenavigation","TT_SIDENAV-CLOSE":"closes the sidenavigation",TT_SN_DASHBOARD_OPEN:"opens the dashboard",TT_SN_TRACKS_OPEN:"opens the trackview",TT_SN_PROFILE_OPEN:"opens the profileview",TT_SN_SEGMENT_OPEN:"opens the communitydataview",DASHBOARD:"Dashboard",TRACKS:"Tracks",TABLE:"Profile",COMMUNITY:"Community data",SITE_FEEDBACK:"Site feedback",SITE_IMPRINT:"Imprint",SITE_TERMS:"Terms",LINK_IMPRINT:"https://www.envirocar.org/dev/imprint.html?lng=en",LINK_TERMS:"https://www.envirocar.org/dev/conditions.html?lng=en",USERNAME:"Username",PASSWORD:"Password",REGISTER:"Register",LOGIN:"Login",FORGOT_PASSWORD:"forgot password?",INVALID_LOGIN:"Invalid user credentials.",PASSWORD_REPEAT:"repeat the password",BACK_TO_LOGIN:"Back to Login",UNMATCHING_PASSWORDS:"The passwords do not match.",EMPTY_PASSWORD:"You must fill in both password fields.",INVALID_EMAIL:"The email is invalid.",USERNAME_IN_USE_1:"The username ",USERNAME_IN_USE_2:" is already in use. Please choose a different username.",EMPTY_USERNAME:"Please choose a username.",LOGOUT:"Logout",USERNAME_TOO_SHORT:"The username must contain at least 4 characters.",RESET_PASSWORD:"Passwordreset",RESET_MY_PASSWORD:"Reset my password",EMPTY_NAME:"You must type in your username.",INVALID_USER:"The given combination of username and email is invalid.",ALREADY_REQUESTED:"The given user has already requested a reset of his password. Please check your emails.",RESET_PASSWORD_REQUESTED:"An email has been sent to you. Please follow the instructions in the email to set a new password.",REGISTERED:"The registration process was successful.",DISTANCE:"Distance",TT_DB_TRACKS:"amount of your tracks",TT_DB_DURATION:"your total duration",TT_DB_DISTANCE:"your total distance",TT_DB_TOTAL_USERS:"number of enviroCar users",TT_DB_TOTAL_TRACKS:"number of enviroCar tracks",TT_DB_TOTAL_DISTANCE:"total distance driven by all community members",TOTAL_USERS:"Users",TOTAL_TRACKS:"Tracks",TOTAL_DISTANCE:"Total Distance",ENGINE_LOAD:"Engine load",SPEED:"Speed",RPM:"Rounds per minute",CO2:"CO2 emissions",CONSUMPTION:" Consumption",CO2_EMISSION:"CO2 emissions",GPS_SPEED:"GPS Speed",COMPARISON_CHART_TITLE:"You compared to the enviroCar community",LABEL_USER:"You",LABEL_PUBLIC:"enviroCar Ø",TT_LABEL_USER:"Your average",TT_LABEL_PUBLIC:"enviroCar community average",COMPARISON_CHART_DESCRIPTION:"Your statistic averages compared to the enviroCar community's statistic averages.",TITLE_TRACKS:"Latest tracks",LATEST_TRACKS_CHART_DESCRIPTION:"Your latest six tracks are listed here. You can see a summary of the driven distance, your used vehicle, and the duration of the track. Hover over a track to see a map preview of the track. Click on a track to get redirect to the single track analysis page.",TITLE_HEATMAP:"Your footprints",HEATMAP_DESCRIPTION:"This heat map shows you the start- and endpoints of all your driven tracks.",SPEED_ZONES:"Speedzones",SPEEDZONES_CHART_TITLE:"Your speed zones",SPEEDZONES_CHART_DESCRIPTION:"There are three speed zones defined as 'slower than 60km/h','between 60 and 130km/h', and 'above 130km/h'. How much time did you spend in each of these speed zones and which distances did you cover?",SPEEDZONES_DESC_SHORT:"Your duration and distance above 130km/h, below 60km/h and in-between.",HIGH_SPEED_ZONE:"faster than 130km/h",MID_SPEED_ZONE:"between 60 and 130km/h",LOW_SPEED_ZONE:"slower than 60km/h",HOURS:"hours",NAN_SPEED_ZONE:"unknown",HIGH_SPEED_ZONE_TT:"your total duration and distance above 130km/h",MID_SPEED_ZONE_TT:"your total duration and distance between 60 and 130km/h",LOW_SPEED_ZONE_TT:"your total duration and distance below 60km/h",NAN_SPEED_ZONE_TT:"your total duration and distance with erroneous measurements",WEEKDAYS_CHART_TITLE:"Your weekday distribution",WEEKDAYS_CHART_DESCRIPTION:"Your driven distance across weekdays",WEEKDAYS:"Weekdays",MONDAY:"Monday",TUESDAY:"Tuesday",WEDNESDAY:"Wednesday",THURSDAY:"Thursday",FRIDAY:"Friday",SATURDAY:"Saturday",SUNDAY:"Sunday",TRACK_ID:"Track ID",NAME:"Name",CREATED:"created",DOWNLOAD_TRACK:"download track",DOWNLOAD_TRACK_TOOLTIP:"Download the track as a *.csv file",DELETE_TRACK:"delete track",DELETE_TRACK_TOOLTIP:"Delete the track from the enviroCar server",DIALOG_DELETE_TRACK_TITLE:"Delete Your track?",DIALOG_DELETE_TRACK_TEXT:"Are you sure you want to irrevocable delete this track?",DIALOG_DELETE_TRACK_CONFIRM:"irrevocable delete",DIALOG_DELETE_TRACK_CANCEL:"cancel",SEGMENT_ANALYSIS:"Segment analysis",TRACK_MAP_TITLE:"Track map",TRACK_MAP_DESCRIPTION:"this map visualizes the selected track. Change phenomenom or select a segment of the track in the toolbar above.",TRACK_CHART_TITLE:"Time series",TRACK_CHART_DESCRIPTION:"this chart shows the selected phenomenon from start to end of the selected track. Change phenomenon or select a segment of the track in the toolbar above.",COMPARISON_TRACK_CHART_TITLE:"Compared to enviroCar",COMPARISON_TRACK_CHART_DESCRIPTION:"Your track's statistic averages compared to the enviroCar community's statstic averages.",TRACK_LABEL_USER:"this track",TRACK_LABEL_PUBLIC:"enviroCar Ø",TT_TRACK_LABEL_USER:"track's average",TT_TRACK_LABEL_PUBLIC:"enviroCar community average",TRACK_SUMMARY_TITLE:"Track Summary",TRACK_SUMMARY_DESCRIPTION:"Your track's phenomenons summary",VEHICLE_TYPE:"Vehicle type",START_TIME:"Starttime",END_TIME:"Finishtime",CO2EMISSION:"CO2 emission",DURATION:"Duration",PER_HOUR:"per hour",PER_100_KM:"per 100km",ON_SEGMENT:"on segment",STOPS:"Stop-and-go's",SPEED_RANGES_CHART_TITLE:"In intervals",SPEED_RANGES_CHART_DESCRIPTION:"How much percentages of the track did you spend in which interval? Click on one of the intervals and the map highlights all measuered values within that interval. Click again to remove the highlight.",CALENDAR_OF_TRACKS_TAB:"Calendar",ALL_TRACKS_TAB:"All Tracks",DAILY_OVERVIEW:"Daily overview",MONTHLY_OVERVIEW:"Monthly overview",SELECTION_OVERVIEW:"Selection overview",CALENDAR_TITLE:"Calendar of your tracks",CALENDAR_DESCRIPTION:"The calendar shows you the number of tracks for each day. An overview of the monthly tracks is displayd at the bottom. You can select a single day by clicking on it. You can select a range of days by clicking on the start and end day. The statistics overview at the bottom matches your selection. The pagination list on the right also matches your selection.",CALENDAR_OVERVIEW_DESCRIPTION:"This pagination list shows all tracks of the selected day range. The tracks are ordered by upload date. You can navigate through the pages via the controls. If you click on one of the tracks, you will be moved to the single track analysis page.",ALL_TRACKS_OVERVIEW_TITLE:"List of tracks",ALL_TRACKS_OVERVIEW_DESCRIPTION:"This pagination list shows all filtered tracks. The tracks are ordered by upload date. You can navigate through the pages via the controls on the bottom. If you click on one of the tracks, you will be moved to the single track analysis page.",PAGE:"Page",OF:"of",WITH_TRACKS:"with tracks",FROM_TO:"to",SHOWING:"Showing",ALL_TRACKS_FILTER_TITLE:"Filter options",ALL_TRACKS_FILTER_DESCRIPTION:"In this card you can set filter options for the tracks in the pagination list. You can create distance, duration, date, vehicle and location filters by clicking on the '+Filter'-button. The tracks in the pagination list will be automatically filtered by your filters.",TT_ADD_FILTER_BUTTON:"Click to create a new filter",CHANGE_FILTER_OPTION:"Edit",CLICK_TO_CHANGE_FILTER_OPTION:"Click to edit filter options",CLICK_TO_REMOVE:"Click to remove this filter",FILTER_OKAY:"Okay",CLOSE_DIALOG:"Click to cancel",ERROR_NEGATIVE:"You can not enter negative numbers",ERROR_NO_INPUT:"You must enter at least one input. Click on the cross on the top right to cancel.",BTN_ADD_FILTER:"add filter",FILTER_DISTANCE_TITLE:"Distance filter",FILTER_DISTANCE_DESCRIPTION:"The distance filter filters your tracks by their length. You can specify a minimum length and/or a maximum length.",FILTER_DISTANCE_HEADING:"Distance filter options",FILTER_DISTANCE:"Distance",DISTANCE_LONGER_THAN:"Minimum length (km)",DISTANCE_SHORTER_THAN:"Maximum length (km)",DISTANCE_OVERLAP_ERROR:"The maximum field must be bigger than or at least equal to the minimum field.",DISTANCE_ERROR_NOINPUT:"You must specify at least one of the fields. Click on the cross on the top right to cancel.",DISTANCE_CARD_MIN:"Minimum distance",DISTANCE_CARD_MAX:"Maximum distance",FILTER_DATE_TITLE:"Date filter",FILTER_DATE_DESCRIPTION:"The date filter filters your tracks by their date. You can specify a minimum date and/or a maximum date.",FILTER_DATE_HEADING:"Date filter options",FILTER_DATE:"Date",DATE_MIN_DATE:"Minimum date",DATE_MAX_DATE:"Maximum date",DATE_OVERLAP_ERROR:"The maximum date must be later than or at least equal to the minimum date. Click on the cross on the top right to cancel.",FILTER_DURATION_TITLE:"Duration filter",FILTER_DURATION_DESCRIPTION:"The duration filter filters your tracks by their duration. You can specify a minimum duration and/or a maximum duration.",FILTER_DURATION_HEADING:"Duration filter options",FILTER_DURATION:"Duration",DURATION_MIN:"Minimum duration (in minutes)",DURATION_MAX:"Maximum duration (in minutes)",DURATION_OVERLAP_ERROR:"The maximum duration must be bigger than or at least equal to the minimum duration.",DURATION_CARD_MIN:"Minimum duration",DURATION_CARD_MAX:"Maximum duration",MINUTES:"minutes",FILTER_VEHICLE_TITLE:"Vehicle filter",FILTER_VEHICLE_DESCRIPTION:"The vehicle filter filters your tracks by their vehicle. You can specify a set of vehicles.",FILTER_VEHICLE_HEADING:"Vehicle filter options",FILTER_VEHICLE:"Vehicle",SELECT_VEHICLES:"Select Vehicles",VEHICLES:"Vehicles",ERROR_NOSELECTION:"You must select at least one vehicle. Click on the cross on the top right to remove this filter.",FILTER_SPATIAL_TITLE:"Location filter",FILTER_SPATIAL_DESCRIPTION:"The location filter filters your tracks by their location. You can specify a bounding box on the map. The resulting tracks have at least one measurement within the bounding box.",FILTER_SPATIAL_HEADING:"Location filter options",FILTER_SPATIAL:"Location",FILTER_SPATIAL_DESCRIPTION_SHORT_1:"Select the ",FILTER_SPATIAL_DESCRIPTION_SHORT_2:"-button to draw a rectangle.",SPATIAL_INPUT_MISSING_ERROR:"You must specify a bounding box before you can use this filter. Click on the X on the top right to cancel this filter.",SPATIAL_SERVER_REQUEST_ERROR:"The server did not respond to your selection. Please try again with another bounding box.",JAN:"JANUARY",FEB:"FEBRUARY",MAR:"MARCH",APR:"APRIL",MAY:"MAY",JUN:"JUNE",JUL:"JULY",AUG:"AUGUST",SEP:"SEPTEMBER",OCT:"OCTOBER",NOV:"NOVEMBER",DEZ:"DECEMBER",BIO:"Profile",EMAIL:"E-mail",COUNTRY:"Country",GENDER:"Gender",MODIFIED:"last edit",TERMS_OF_USE:"Terms of Use version",FIRST_NAME:"First Name",LAST_NAME:"Last Name",ENTER_DATE:"Enter Date",OLD_PASSWORD:"Old Password",NEW_PASSWORD:"New Password",NEW_PASSWORD_REPEAT:"New Password(Repeat)",DATE_OF_BIRTH:"Date of Birth",EDIT_PERSONAL_INFO:"Edit Personal Information",HINT_EDIT_PASSWORD:"Leave these fields blank if you do not want to change your password.",INFO_UPDATE_SUCCESS:"Your details have been updated",MALE:"Male",FEMALE:"Female",BUTTON_UPDATE_PROFILE:"Update Profile",BUTTON_DELETE_PROFILE:"Delete Profile",GERMAN:"German",ENGLISH:"English",DIALOG_DELETE_TITLE:"Delete Your Account?",DIALOG_DELETE_TEXT:"Are you sure you want to irrevocable delete your enviroCar user account?",DIALOG_DELETE_CONFIRM:"irrevocable delete",DIALOG_DELETE_CANCEL:"cancel",DELETE_ALL_TRACKS_TOO_1:"Also delete all my ",DELETE_ALL_TRACKS_TOO_2:" enviroCar tracks",WRONG_PASSWORD_ENTERED:"You entered a wrong password. Please correct the password and try again.",CONFIRM_DELETE_PASSWORD_LABEL:"Confirm with your password:",CONFIRM_DELETE_PASSWORD:"Enter your password here",COMMUNITY_MAP_TITLE:"Segment analysis map",COMMUNITY_MAP_DESCRIPTION_1:"Click on the ",COMMUNITY_MAP_DESCRIPTION_2:"-button to create a polyline of segments. After final creation, statistics for each segment are presented on the right.",COMMUNITY_MAP_DESCRIPTION:"Statistics for segments by anonymous enviroCar community data."}),e.translations("de",{"WEBSITE-TITLE":"EnviroCar Webapp",LANGUAGE:"Sprache",CLICK_FOR_MORE_INFO:"Klick für weitere Informationen...",COMMING_SOON:"Demnächst Verfügbar...",NO_TRACKS:"Du hast noch keine Fahrten hochgeladen.",CHANGE_LANGUAGE:"Sprache wechseln","OPEN-NAV":"Öffne Seitenleiste","CLOSE-NAV":"Schließe Seitenleiste","TT_SIDENAV-OPEN":"öffnet die Navigation","TT_SIDENAV-CLOSE":"schließt die Navigation",TT_SN_DASHBOARD_OPEN:"öffnet das Dashboard",TT_SN_TRACKS_OPEN:"öffnet die Fahrtansicht",TT_SN_PROFILE_OPEN:"öffnet deine Profileeinstellungen",TT_SN_SEGMENT_OPEN:"öffnet die Communitydatenanalyse",DASHBOARD:"Dashboard",TRACKS:"Fahrten",TABLE:"Profil",COMMUNITY:"Communitydaten",SITE_FEEDBACK:"Seitenfeedback",SITE_IMPRINT:"Impressum",SITE_TERMS:"Nutzungsbedingungen",LINK_IMPRINT:"https://www.envirocar.org/dev/imprint.html?lng=de",LINK_TERMS:"https://www.envirocar.org/dev/conditions.html?lng=de",USERNAME:"Benutzername",PASSWORD:"Passwort",REGISTER:"Registrieren",LOGIN:"Anmelden",FORGOT_PASSWORD:"Passwort vergessen?",INVALID_LOGIN:"Fehlerhafte Benutzerdaten.",PASSWORD_REPEAT:"Passwort (erneut)",BACK_TO_LOGIN:"Zur Anmeldung",UNMATCHING_PASSWORDS:"Die Passwörter stimmen nicht überein.",EMPTY_PASSWORD:"Du musst beide Passwortfelder ausfüllen.",INVALID_EMAIL:"Die Email ist ungültig.",USERNAME_IN_USE_1:"Der Nutzername ",USERNAME_IN_USE_2:" ist bereits vergeben. Bitte wähle einen anderen Nutzernamen.",EMPTY_USERNAME:"Du musst deinen Benutzernamen noch wählen.",LOGOUT:"Ausloggen",USERNAME_TOO_SHORT:"Der Benutzername muss mindestens 4 Zeichen enthalten.",RESET_PASSWORD:"Passwort Zurücksetzen",RESET_MY_PASSWORD:"Zurücksetzen",EMPTY_NAME:"Du musst deinen Benutzernamen eingeben.",INVALID_USER:"Die Kombination aus Benutzername und Email ist nicht gültig.",ALREADY_REQUESTED:"Dieser Benutzer hat bereits ein Zurücksetzen seines Passworts angefordert. Bitte überprüfe deine Emails.",RESET_PASSWORD_REQUESTED:"Eine Email wurde an dich versendet. Bitte folge den darin beschriebenen Instruktionen um ein neues Passwort zu setzen.",REGISTERED:"Die Registrierung war erfolgreich.",DISTANCE:"Distanz",TT_DB_TRACKS:"Anzahl deiner gefahrenen Fahrten",TT_DB_DURATION:"Deine zurückgelegte Gesamtfahrtdauer",TT_DB_DISTANCE:"Deine zurückgelegte Gesamtdistanz",TT_DB_TOTAL_USERS:"Anzahl an enviroCar Mitgliedern",TT_DB_TOTAL_TRACKS:"Anzahl an enviroCar Fahrten",TT_DB_TOTAL_DISTANCE:"Gesamtdistanz, die von allen enviroCar Mitgliedern gefahren wurde.",TOTAL_USERS:"Mitglieder",TOTAL_TRACKS:"Fahrten",TOTAL_DISTANCE:"Distanz",ENGINE_LOAD:"Motorauslastung",SPEED:"Geschwindigkeit",RPM:"Umdrehungen",CO2:"CO2 Emissionen",CONSUMPTION:"Treibstoffverbrauch",CO2_EMISSION:"CO2 Emissionen",GPS_SPEED:"GPS Geschwindigkeit",COMPARISON_CHART_TITLE:"Ich im Vergleich zur enviroCar Gemeinschaft",LABEL_USER:"Ich",LABEL_PUBLIC:"enviroCar Ø",TT_LABEL_USER:"Mein Durchschnittswert",TT_LABEL_PUBLIC:"enviroCar Durchschnittswert",COMPARISON_CHART_DESCRIPTION:"Deine Durchschnittswerte im Vergleich mit den Durchschnittswerten, die die enviroCar Gemeinschaft gesammelt hat.",TITLE_TRACKS:"Neuste Fahrten",LATEST_TRACKS_CHART_DESCRIPTION:"Deine neusten sechs Fahrten werden hier angezeigt. Dir werden das Datum, deine zurückgelegte Distanz, dein Fahrzeug sowie die Fahrtdauer angezeigt. Bewege den Mauszeiger über die Fahrt um eine Kartenvorschau zu sehen. Klicke auf die Fahrt um zur Einzelfahrtanalyseseite weitergeleitet zu werden.",TITLE_HEATMAP:"Mein Einflussbereich",HEATMAP_DESCRIPTION:"Diese Karte zeigt dir die Start- und Endpunkte deiner gefahrenen Strecken.",SPEED_ZONES:"Geschwindigkeitszonen",SPEEDZONES_CHART_TITLE:"Meine Geschwindigkeitszonen",SPEEDZONES_CHART_DESCRIPTION:'Es sind drei Geschwindigkeitszonen definiert als "langsamer als 60km/h", "zwischen 60 und 130km/h", und "schneller als 130km/h". Wie viel Zeit hast du beim Fahren in jeder Geschwindigkeitzone verbracht und welche Distanzen hast du in ihnen zurückgelegt?',SPEEDZONES_DESC_SHORT:"Deine Zeit und Distanz über 130km/h, unter 60km/h und dazwischen.",HIGH_SPEED_ZONE:"schneller als 130km/h",MID_SPEED_ZONE:"zwischen 60 und 130km/h",LOW_SPEED_ZONE:"langsamer als 60km/h",HOURS:"Stunden",NAN_SPEED_ZONE:"unbekannt",HIGH_SPEED_ZONE_TT:"deine Gesamtfahrtdauer und -distanz über 130km/h",MID_SPEED_ZONE_TT:"deine Gesamtfahrtdauer und -distanz zwischen 60 und 130km/h",LOW_SPEED_ZONE_TT:"deine Gesamtfahrtdauer und -distanz unter 60km/h",NAN_SPEED_ZONE_TT:"deine Gesamtfahrtdauer und -distanz mit fehlerhaften Messungen",WEEKDAYS_CHART_TITLE:"Meine Wochentagsverteilung",WEEKDAYS_CHART_DESCRIPTION:"Meine zurückgelegte Distanz verteilt auf Wochentage",WEEKDAYS:"Wochentage",MONDAY:"Montag",TUESDAY:"Dienstag",WEDNESDAY:"Mittwoch",THURSDAY:"Donnerstag",FRIDAY:"Freitag",SATURDAY:"Samstag",SUNDAY:"Sonntag",TRACK_ID:"Fahrt ID",NAME:"Name",CREATED:"erstellt am",DOWNLOAD_TRACK:"Track herunterladen",DOWNLOAD_TRACK_TOOLTIP:"Lade die Fahrt als *.csv Datei herunter",DELETE_TRACK:"Track löschen",DELETE_TRACK_TOOLTIP:"Lösche den Track aus dem enviroCar server",DIALOG_DELETE_TRACK_TITLE:"Diese Fahrt löschen?",DIALOG_DELETE_TRACK_TEXT:"Sind Sie sicher, dass Sie diese Fahrt unwiderruflich löschen möchten?",DIALOG_DELETE_TRACK_CONFIRM:"unwiderruflich löschen",DIALOG_DELETE_TRACK_CANCEL:"abbrechen",SEGMENT_ANALYSIS:"Segmentanalyse",TRACK_MAP_TITLE:"Fahrtkarte",TRACK_MAP_DESCRIPTION:"Diese Karte zeigt deine gewählte Strecke. Wähle ein anderes Phänomen aus oder betrachte einen Teil der Strecke in der obigen Werkzeugleiste.",TRACK_CHART_TITLE:"Zeitreihendiagramm",TRACK_CHART_DESCRIPTION:"Dieses Diagramm zeigt das ausgewählte Phänomen deiner Fahrt über eine Zeitachse an. Wähle ein anderes Phänomen aus oder betrachte einen Teil der Strecke in der obigen Werkzeugleiste.",COMPARISON_TRACK_CHART_TITLE:"Vergleich mit enviroCar",COMPARISON_TRACK_CHART_DESCRIPTION:"Durchschnittswerte dieser Fahrt im Vergleich mit den Durschschnittwerten, die die enviroCar-Gemeinschaft gesammelt hat.",TRACK_LABEL_USER:"Meine Fahrt",TRACK_LABEL_PUBLIC:"enviroCar Ø",TT_TRACK_LABEL_USER:"Fahrtdurchschnittswert",TT_TRACK_LABEL_PUBLIC:"enviroCar Durchschnittswert",TRACK_SUMMARY_TITLE:"Fahrtüberblick",TRACK_SUMMARY_DESCRIPTION:"Zusammenfassung der Daten deiner Fahrt",VEHICLE_TYPE:"Fahrzeugtyp",START_TIME:"Startzeit",END_TIME:"Endzeit",CO2EMISSION:"CO2 Emissionen",DURATION:"Fahrtdauer",PER_HOUR:"pro Stunde",PER_100_KM:"pro 100km",ON_SEGMENT:"auf Segment",STOPS:"Stop-and-go's",SPEED_RANGES_CHART_TITLE:"In Intervallen",SPEED_RANGES_CHART_DESCRIPTION:"In welche Intervallen hast du welchen Anteil deiner Fahrt verbracht? Klick auf eines der Intervalle um alle Messungen innerhalb des Intervals auf der Karte hervorzuheben. Klick erneut auf das Interval um die Hervorhebung wieder zu entfernen.",CALENDAR_OF_TRACKS_TAB:"Kalenderübersicht",ALL_TRACKS_TAB:"Alle Fahrten",DAILY_OVERVIEW:"Tagesübersicht",MONTHLY_OVERVIEW:"Monatsübersicht",SELECTION_OVERVIEW:"Übersicht ausgewählter Tage",CALENDAR_TITLE:"Kalender deiner Fahrten",CALENDAR_DESCRIPTION:"Dieser Kalender zeigt dir zu jedem Tag die Anzahl der Fahrten an. Unten siehst du eine Übersicht der Fahrten im Monat. Du kannst einen einzelnen Tag durch Klicken auswählen, oder ein Interval von Tagen durch Klicken auf dem Start- und End-tag auswählen. Die unten aufgeführte Statistik passt sich der Selektion an. Die Seitenliste rechts passt sich ebenfalls deiner Tagesauswahl an.",CALENDAR_OVERVIEW_DESCRIPTION:"Diese Seitenansicht zeigt dir alle Fahrten aus dem ausgewählten Zeitraum an. Die Fahrten sind nach dem Datum des Uploads sortiert. Du kannst zwischen den Seiten navigieren. Wenn du auf eine der Fahrten klickst, gelangst du zur Einzelfahrtanalyseseite mit der ausgewählten Fahrt.",ALL_TRACKS_OVERVIEW_TITLE:"Liste aller Fahrten",ALL_TRACKS_OVERVIEW_DESCRIPTION:"Diese Seitenansicht zeigt dir alle gefilterten Fahrten an. Die Fahrten sind nach dem Datum des Uploads sortiert. Unten kannst du zwischen den Seiten navigieren. Wenn du auf eine der Fahrten klickst, gelangst du zur Einzelfahrtanalyseseite mit der ausgewählten Fahrt.",PAGE:"Seite",OF:"von",WITH_TRACKS:"mit Fahrten",FROM_TO:"bis",SHOWING:"Zeige",ALL_TRACKS_FILTER_TITLE:"Filteroptionen",ALL_TRACKS_FILTER_DESCRIPTION:"Hier kannst du filteroptionen für die aufgelisteten Fahrten einstellen. Du kannst Filter für die gefahrene Distanz, die Fahrtdauer, das Fahrtdatum, den Fahrzeugtyp und/oder den Ort erstellen, indem du auf den '+Filter'-Knopf drückst. Die Fahrten in der Seitenliste passen sich den Filtereinstellungen automatisch an.",TT_ADD_FILTER_BUTTON:"Klick um einen neuen Filter zu erstellen",CHANGE_FILTER_OPTION:"Bearbeiten",CLICK_TO_CHANGE_FILTER_OPTION:"Klick um die Filteroptionen zu bearbeiten",CLICK_TO_REMOVE:"Klick um diesen Filter zu entfernen",FILTER_OKAY:"Okay",CLOSE_DIALOG:"Klick um abzubrechen",ERROR_NEGATIVE:"Keine negativen Einträge erlaubt!",ERROR_NO_INPUT:"Du musst mindestens eine Eingabe machen. Klicke auf das Kreuz oben rechts um abzubrechen.",BTN_ADD_FILTER:"Filter hinzufügen",FILTER_DISTANCE_TITLE:"Distanzfilter",FILTER_DISTANCE_DESCRIPTION:"Der Distanzfilter filtert die Fahrten nach ihrer Länge. Du kannst eine Minimallänge und/oder eine Maximallänge angeben.",FILTER_DISTANCE_HEADING:"Distanzfilteroptionen",FILTER_DISTANCE:"Distanz",DISTANCE_LONGER_THAN:"Mindestdistanz (km)",DISTANCE_SHORTER_THAN:"Höchstldistanz (km)",DISTANCE_OVERLAP_ERROR:"Das 'größer als'-Feld muss mindestens so groß sein, wie das 'kleiner als'-Feld",DISTANCE_ERROR_NOINPUT:"Du must mindestens eine Eingabe machen. Klicke auf das Kreuz oben rechts um abzubrechen.",DISTANCE_CARD_MIN:"Mindestdistanz",DISTANCE_CARD_MAX:"Höchstdistanz",FILTER_DATE_TITLE:"Datumsfilter",FILTER_DATE_DESCRIPTION:"Der Datumsfilter filtert die Fahrten nach ihrem Datum. Du kannst ein Minimumdatum und/oder ein Maximumdatum angeben.",FILTER_DATE_HEADING:"Datumsfilteroptionen",FILTER_DATE:"Datum",DATE_MIN_DATE:"Mindestdatum",DATE_MAX_DATE:"Höchstdatum",DATE_OVERLAP_ERROR:"Das zweite Datum muss zeitlich nach dem ersten Datum kommen. Klicke auf das Kreuz oben rechts um abzubrechen.",FILTER_DURATION_TITLE:"Fahrtdauerfilter",FILTER_DURATION_DESCRIPTION:"Der Fahrtdauerfilter filtert die Fahrten nach ihrem Fahrtdauer. Du kannst eine Minimumdauer und/oder eine Maximumdauer angeben.",FILTER_DURATION_HEADING:"Fahrtdauerfilteroptionen",FILTER_DURATION:"Fahrtdauer",DURATION_MIN:"Mindestfahrtdauer (in Minuten)",DURATION_MAX:"Höchstfahrtdauer (in Minuten)",DURATION_OVERLAP_ERROR:"Die Höchstfahrtdauert muss größer als oder mindestens genauso groß sein wie die Mindestfahrtdauert.",DURATION_CARD_MIN:"Mindestfahrtdauer",DURATION_CARD_MAX:"Höchstfahrtdauer",MINUTES:"Minuten",FILTER_VEHICLE_TITLE:"Fahrzeugtypfilter",FILTER_VEHICLE_DESCRIPTION:"Der Fahrzeugtypfilter filtert die Fahrten nach ihrem Fahrzeugtyp. Du kannst für jeden deiner Fahrzeuge angeben, ob Fahrten mit diesem Fahrzeug angezeigt werden sollen.",FILTER_VEHICLE_HEADING:"Fahrzeugtypfilteroptionen",FILTER_VEHICLE:"Fahrzeugtyp",SELECT_VEHICLES:"Wähle Fahrzeugtypen",VEHICLES:"Fahrzeuge",ERROR_NOSELECTION:"Du musst mindestens ein Fahrzeugtyp auswählen. Klicke auf das Kreuz oben rechts um diesen Filter zu entfernen.",FILTER_SPATIAL_TITLE:"Ortsfilter",FILTER_SPATIAL_DESCRIPTION:"Mit dem Ortsfilter kannst du auf einer Karte ein Begrenzungsrechteck ziehen. Der Ortsfilter filtert die Fahrten danach, ob sie Messungen innerhalb deines gezogenen Begrenzungsrechtsecks enthalten.",FILTER_SPATIAL_HEADING:"Ortsfilteroptionen",FILTER_SPATIAL:"Ort",FILTER_SPATIAL_DESCRIPTION_SHORT_1:"Klicke auf den ",FILTER_SPATIAL_DESCRIPTION_SHORT_2:"-Knopf um ein Rechteck zu zeichnen.",SPATIAL_INPUT_MISSING_ERROR:"Du musst ein Begrenzungsrechteck eingeben bevor du diesen Filter nutzen kannst. Klicke auf das X oben rechts, um diesen Filter abzubrechen.",SPATIAL_SERVER_REQUEST_ERROR:"Der Server konnte die Anfrage nicht verarbeiten. Versuche es bitte mit einem anderen Begrenzungsrechteck erneut.",JAN:"JANUAR",FEB:"FEBRUAR",MAR:"MÄRZ",APR:"APRIL",MAY:"MAI",JUN:"JUNI",JUL:"JULI",AUG:"AUGUST",SEP:"SEPTEMBER",OCT:"OKTOBER",NOV:"NOVEMBER",DEZ:"DEZEMBER",BIO:"Profil",EMAIL:"E-mail",COUNTRY:"Land",GENDER:"Geschlecht",MODIFIED:"geändert am",TERMS_OF_USE:"Version der Nutzungsregeln",FIRST_NAME:"Vorname",LAST_NAME:"Nachname",ENTER_DATE:"Wähle ein Datum",HINT_EDIT_PASSWORD:"Lasse diese Felder frei, wenn du dein Passwort nicht ändern willst.",OLD_PASSWORD:"Altes Passwort",NEW_PASSWORD:"Neues Passwort",NEW_PASSWORD_REPEAT:"Neues Passwort (wiederhole)",INFO_UPDATE_SUCCESS:"Deine Profilinformationen wurden aktualisiert.",DATE_OF_BIRTH:"Geburtsdatum",EDIT_PERSONAL_INFO:"Ändere deine persönlichen Informationen",MALE:"Männlich",FEMALE:"Weiblich",BUTTON_UPDATE_PROFILE:"Aktualisiere Profil",BUTTON_DELETE_PROFILE:"Profil löschen",GERMAN:"Deutsch",ENGLISH:"Englisch",DIALOG_DELETE_TITLE:"Wirklich löschen?",DIALOG_DELETE_TEXT:"Sind Sie sicher, dass Sie Ihren enviroCar-Nutzeraccount wirklich unwiderruflich löschen möchten?",DIALOG_DELETE_CONFIRM:"unwiderruflich löschen",DIALOG_DELETE_CANCEL:"abbrechen",DELETE_ALL_TRACKS_TOO_1:"Alle meine aufgenommenen ",DELETE_ALL_TRACKS_TOO_2:" enviroCar Fahrten ebenfalls löschen.",WRONG_PASSWORD_ENTERED:"Sie haben ein falsches Passwort eingegeben. Bitte korrigieren Sie ihr Passwort und versuchen Sie es erneut.",CONFIRM_DELETE_PASSWORD_LABEL:"Bestätigen Sie den Löschvorgang mit ihrem Passwort.",CONFIRM_DELETE_PASSWORD:"Ihr Passwort",COMMUNITY_MAP_TITLE:"Abschnitt Analyse Karte",COMMUNITY_MAP_DESCRIPTION_1:"Klicke auf den ",COMMUNITY_MAP_DESCRIPTION_2:"-Knopf um eine Polylinie von Segmenten zu erstellen. Nachdem die Polylinie erstellt ist, werden Statistiken zu den erstellten Segmenten rechts angezeigt.",COMMUNITY_MAP_DESCRIPTION:"Statistiken für ausgewählte Streckensegmente durch anonyme enviroCar Communitydaten."}),e.preferredLanguage("en")}]),function(){"use strict";function e(e,t,a,n){"ngInject";console.log("run config"),e.state("login",{url:"/login",templateUrl:"app/components/login/login.html",controller:"LoginCtrl",authenticate:!1}).state("dashboard",{url:"/dashboard",templateUrl:"app/components/dashboard/dashboard.html",controller:"DashboardCtrl",authenticate:!0}).state("chart",{url:"/dashboard/track/:trackid",controller:"ChartCtrl",templateUrl:function(e){return"app/components/track_analysis/chart/chart.html?path="+e.trackid},authenticate:!0,data:{title:"Chart"}}).state("tracks",{url:"/tracks",controller:"TrackListCtrl",templateUrl:"app/components/tracks/tracks.html",authenticate:!0}).state("profile",{url:"/profile",controller:"ProfileCtrl",templateUrl:"app/components/profile/profile.html",authenticate:!0}).state("community",{url:"/community",controller:"CommunityCtrl",templateUrl:"app/components/communitypage/community.html",authenticate:!1}),t.otherwise("/dashboard"),a.definePalette("envirocar-blue",{50:"1A80C1",100:"1A80C1",200:"1A80C1",300:"1A80C1",400:"1A80C1",500:"1A80C1",600:"1A80C1",700:"1A80C1",800:"1A80C1",900:"1A80C1",A100:"1A80C1",A200:"1A80C1",A400:"1A80C1",A700:"1A80C1",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}).definePalette("envirocar-green",{50:"8cbf3f",100:"8cbf3f",200:"8cbf3f",300:"8cbf3f",400:"8cbf3f",500:"8cbf3f",600:"8cbf3f",700:"8cbf3f",
800:"8cbf3f",900:"8cbf3f",A100:"8cbf3f",A200:"8cbf3f",A400:"8cbf3f",A700:"8cbf3f",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}).theme("default").primaryPalette("envirocar-blue",{default:"500"}).accentPalette("envirocar-green",{default:"500"}).warnPalette("pink"),n.defaults.headers.common={},n.defaults.headers.post={},n.defaults.headers.put={},n.defaults.headers.patch={},n.defaults.useXDomain=!0,delete n.defaults.headers.common["X-Requested-With"],n.defaults.withCredentials=!0}e.$inject=["$stateProvider","$urlRouterProvider","$mdThemingProvider","$httpProvider"],angular.module("enviroCar").config(e)}(),function(){function e(e,t){"ngInject";this.getPhenomenonStatistics=function(a){return e({method:"GET",url:t+"/statistics/"+a,cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/statistics/"+a),e})},this.getStatistics=function(a){return e({method:"GET",url:t+"/tracks/"+a+"/statistics",cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/tracks/"+a+"/statistics"),e})},this.getTrackPhenomenonStatistics=function(a,n){return e({method:"GET",url:t+"/tracks/"+a+"/statistics/"+n,cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/tracks/"+a+"/statistics/"+n),e})},this.getTrackStatistics=function(a){return e({method:"GET",url:t+"/tracks/"+a+"/statistics",cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/tracks/"+a+"/statistics"),e})},this.getUserPhenomenonStatistics=function(a,n){return e({method:"GET",url:t+"/users/"+a+"/statistics/"+n,cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/users/"+a+"/statistics/"+n),e})},this.getUserStatistics=function(a){return e({method:"GET",url:t+"/users/"+a+"/statistics",cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/users/"+a+"/statistics"),e})},this.getSegmentAnalysis=function(t){return e({method:"POST",url:"https://envirocar.org/envirocar-rest-analyzer/dev/rest/route/statistics",data:t}).then(function(e){return e},function(e){return console.log("ResponseError @GEThttps://envirocar.org/envirocar-rest-analyzer/dev/rest/route/statistics"),e})}}e.$inject=["$http","ecBaseUrl"],angular.module("enviroCar.api").service("StatisticsService",e)}(),function(){function e(e,t){"ngInject";this.getTrackPhenomenonStatistics=function(a,n){return e({method:"GET",url:t+"/tracks/"+a+"/statistics/"+n,cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/tracks/"+a+"/statistics/"+n),e})},this.getTrackStatistics=function(a){return e({method:"GET",url:t+"/tracks/"+a+"/statistics",cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/tracks/"+a+"/statistics"),e})},this.getTrack=function(a){return e({method:"GET",url:t+"/tracks/"+a,cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/tracks/"+a),e})},this.postNewTrack=function(a,n){return e({method:"POST",url:t+"/users/"+a+"/tracks",withCredentials:!0,data:n}).then(function(e){return e},function(e){return console.log("ResponseError @POST: "+t+"/tracks"),e})},this.deleteTrack=function(a,n){return e({method:"DELETE",url:t+"/users/"+a+"/tracks/"+n,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @DELETE: "+t+"/users/"+a+"/tracks/"+n),e})},this.getUserTracks=function(a){return e({method:"GET",url:t+"/users/"+a+"/tracks?page=1&limit=10000",cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/users/"+a+"/tracks?page=1&limit=10000"),e})},this.getTracks=function(){return e({method:"GET",url:t+"/tracks?limit=10000",cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/tracks"),e})}}e.$inject=["$http","ecBaseUrl"],angular.module("enviroCar.api").service("TrackService",e)}(),function(){function e(e,t){"ngInject";this.getUserTracksBBox=function(a,n,r,o,s){return e({method:"GET",url:t+"/users/"+a+"/tracks?limit=10000&bbox="+n+","+r+","+o+","+s,cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/users/"+a+"/tracks?bbox="+n+","+r+","+o+","+s),e})},this.getUserPhenomenonStatistics=function(a,n){return e({method:"GET",url:t+"/users/"+a+"/statistics/"+n,cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/users/"+a+"/statistics/"+n),e})},this.getUserStatistics=function(a){return e({method:"GET",url:t+"/users/"+a+"/statistics",withCredentials:!0,cache:!1}).then(function(e){return e},function(e){return console.log(e),e})},this.getUserStatistic=function(a){return e({method:"GET",url:t+"/users/"+a+"/userStatistic",cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @GET"+t+"/users/"+a+"/statistics"),e})},this.getTotalUsers=function(){return e({method:"GET",url:t+"/users?page=1&limit=10000",cache:!0,withCredentials:!0}).then(function(e){return e.data.users.length},function(e){return console.log("ResponseError @"+t+"/users?page=1&limit=10000"),e})},this.putUserDetails=function(a,n){return e({method:"PUT",url:t+"/users/"+a,withCredentials:!0,data:n}).then(function(e){return e},function(e){return console.log("ResponseError @"+t+"/users/"),e})},this.getUsers=function(){return e({method:"GET",url:t+"/users?limit=1",cache:!0,withCredentials:!0}).then(function(e){return e.headers("content-range").split("/")[1]}).error(function(e){return console.log("ResponseError @"+t+"/users/"),e})},this.getUserFriend=function(a,n){return e({method:"GET",url:t+"/users/"+a+"/friends/"+n,cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @"+t+"/users/"+a+"/friends"+n),e})},this.postUserFriends=function(a,n){return e({method:"POST",url:t+"/users/"+a+"/friends",withCredentials:!0,data:n}).then(function(e){return e},function(e){return console.log("ResponseError @POST: "+t+"/users/"+a+"/friends"),e})},this.postUser=function(a){return e({method:"POST",url:t+"/users/",withCredentials:!0,data:a}).then(function(e){return e},function(e){return console.log("ResponseError @POST: "+t+"/users/"),e})},this.getTotalUserTracks=function(a){return e({method:"GET",url:t+"/users/"+a+"/tracks?limit=1",cache:!0,withCredentials:!0}).then(function(e){return e.headers("content-range").split("/")[1]},function(e){return console.log("ResponseError @"+t+"/users/"+a+"/tracks?limit=1"),e})},this.getUserGroups=function(a){return e({method:"GET",url:t+"/users/"+a+"/groups",withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @"+t+"/users/"+a+"/statistics"),e})},this.getUserFriends=function(a){return e({method:"GET",url:t+"/users/"+a+"/friends",cache:!0,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @"+t+"/users/"+a+"/groups"),e})},this.getUserWithAuth=function(a,n){return e({method:"GET",url:t+"/users/"+a,headers:{"X-user":a,"X-token":n}}).then(function(e){return e},function(e){return console.log("ResponseError @"+t+"/users/"+a),e})},this.getUser=function(a){return e({method:"GET",url:t+"/users/"+a,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @"+t+"/users/"+a),e})},this.postPasswordReset=function(a){return e({method:"POST",url:t+"/resetPassword",withCredentials:!0,data:a}).then(function(e){return e},function(e){return console.log("ResponseError @POST"+t+"/resetPassword"),e})},this.deleteUser=function(a){return e({method:"DELETE",url:t+"/users/"+a,withCredentials:!0}).then(function(e){return e},function(e){return console.log("ResponseError @DELETE"+t+"/users/"+a),e})}}e.$inject=["$http","ecBaseUrl"],angular.module("enviroCar.api").service("UserService",e)}(),function(){"use strict";function e(e,t,a,n,r,o){"ngInject";function s(a){console.log(a),e.center_community={lat:a.coords.latitude,lng:a.coords.longitude,zoom:13},e.onload_community_map=!0,t(function(){window.dispatchEvent(new Event("resize")),t(function(){window.dispatchEvent(new Event("resize"))},200)},100)}e.onload_community_map=!1,e.onload_community_data=!0,e.onload_data=!1,e.numberSegments=2,e.currentPhenomIndex=0;var i=new L.FeatureGroup;e.segmentColors=[{0:"#550000",1:"#005500",2:"#000055",3:"#555500",4:"#550055",5:"#005555",6:"#552200",7:"#550022",8:"#005522",9:"#225500",10:"#220055",11:"#002255"},{0:"#aa0000",1:"#00aa00",2:"#0000aa",3:"#aaaa00",4:"#aa00aa",5:"#00aaaa",6:"#aa5500",7:"#aa0055",8:"#00aa55",9:"#55aa00",10:"#5500aa",11:"#0055aa"},{0:"#ff0000",1:"#00ff00",2:"#0000ff",3:"#ffff00",4:"#ff00ff",5:"#00ffff",6:"#ffaa00",7:"#ff00aa",8:"#00ffaa",9:"#aaff00",10:"#aa00ff",11:"#00aaff"}],angular.extend(e,{center_community:{},drawOptions_community:{position:"bottomright",draw:{polyline:{allowIntersection:!0,shapeOptions:{color:"#1A80C1"},metric:!0,zIndexOffset:2e3},polygon:!1,circle:!1,rectangle:!1,marker:!1},edit:{featureGroup:i,remove:!1}},layers_community:{baselayers:{osm:{name:"OpenStreetMap",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz"}}},paths_community:{},events_community:{paths:{enable:["click","mouseover"],logic:"emit"}}}),e.$on("leafletDirectivePath.mouseover",function(e,t){var a=parseInt(t.modelName.substring(1));console.log("segment "+a+" hovered.")}),e.dataCharts=[],e.options_community={chart:{type:"multiBarHorizontalChart",height:600/e.numberSegments,y:function(e){return e.value},showControls:!1,showValues:!0,duration:500,stacked:!1,forceY:[0,200],showLegend:!1,showMinMax:!1,margin:{left:16,top:8,right:8,bottom:24},color:function(e,t){return e.values[0].color}}},e.showAlert=function(e,t,r){var o=n.instant(t),s=n.instant(r);a.show(a.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title(o).textContent(s).ariaLabel("Popover").ok("Okay!").targetEvent(e).fullscreen(!0))},function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(s):console.log("Geolocation is not supported by this browser.")}(),e.onload_community_map=!0,t(function(){window.dispatchEvent(new Event("resize")),t(function(){window.dispatchEvent(new Event("resize"))},200)},100),e.data={type:"Feature",geometry:{type:"LineString",coordinates:[[7.604778,51.950531],[7.604778,51.950531]]},timeInterval:{dateStart:"2010-06-08T11:29:10Z",dateEnd:"2026-09-08T11:29:10Z",daytimeStart:"1:30",daytimeEnd:"15:30"},tolerance:25};var l=function(e,t){for(var a={min:0,avg:0,max:0,count:0},n=0;n<e.length;n++)e[n]&&e[n].name&&e[n].name===t&&(a.min=e[n].min,a.avg=e[n].avg,a.max=e[n].max,a.count=e[n].count);return a},c=function(e,t){console.log(e);for(var a=0,n=0;n<e.length;n++){var r=l(e[n].properties,t).max;console.log(r),r>a&&(a=r)}return a};e.onPhenomenonChange=function(t){e.dataCharts=[],e.currentPhenomIndex=t,console.log(t),console.log(e.dataAll);for(var a=0;a<e.numberSegments;a++){var n=e.dataAll[3*a+t];e.dataCharts.push(n),console.log("Label: "+n[0].values[0].label),e.options_community.chart.forceY=[0,e.max[t]]}},e.dataAll=[],e.max=[0,0,0];var d=function(a){e.max=[0,0,0],e.max[0]=c(a,"Speed"),e.max[1]=c(a,"Consumption"),e.max[2]=c(a,"CO2"),e.options_community.chart.forceY=[0,e.max[0]],e.numberSegments=a.length,e.dataCharts=[],e.dataAll=[];for(var n=0;n<e.numberSegments;n++){var r=a[n].properties,o={speed:l(r,"Speed"),consumption:l(r,"Consumption"),co2:l(r,"CO2")},s=[{key:"Minimum",values:[{color:e.segmentColors[0][n],label:n+1+"Speed",value:o.speed.min}]},{key:"Average",values:[{color:e.segmentColors[1][n],label:n+1+"",value:o.speed.avg}]},{key:"Maximum",values:[{color:e.segmentColors[2][n],label:n+1+"",value:o.speed.max}]}];e.dataAll.push(s),e.dataCharts.push(s);var s=[{key:"Minimum",values:[{color:e.segmentColors[0][n],label:n+1+"Consumption",value:o.consumption.min}]},{key:"Average",values:[{color:e.segmentColors[1][n],label:n+1+"",value:o.consumption.avg}]},{key:"Maximum",values:[{color:e.segmentColors[2][n],label:n+1+"",value:o.consumption.max}]}];e.dataAll.push(s);var s=[{key:"Minimum",values:[{color:e.segmentColors[0][n],label:n+1+"CO2",value:o.co2.min}]},{key:"Average",values:[{color:e.segmentColors[1][n],label:n+1+"",value:o.co2.avg}]},{key:"Maximum",values:[{color:e.segmentColors[2][n],label:n+1+"",value:o.co2.max}]}];e.dataAll.push(s)}e.options_community.chart.height=600/e.numberSegments,e.onload_community_data=!0,e.onload_data=!0,t(function(){window.dispatchEvent(new Event("resize")),t(function(){window.dispatchEvent(new Event("resize"))},200)},100)},u={created:function(t,a,n,o,s){for(var i=a.layer,l=[],c=i._latlngs,u=0;u<c.length;u++)l.push([c[u].lng,c[u].lat]);e.data.geometry.coordinates=l,e.onload_community_data=!1,r.getSegmentAnalysis(e.data).then(function(e){d(e.data.features)},function(e){console.log("Error: "+e)}),e.paths_community=[];for(var u=0;u<l.length-1;u++){var m={},h=l[u][0],g=l[u][1],p=l[u+1][0],_=l[u+1][1];m.weight=8,m.opacity=.75,m.latlngs=[{lat:g,lng:h},{lat:_,lng:p}],m.color=e.segmentColors[2][u],e.paths_community["p"+u]=m}},edited:function(e){console.log("edited")},deleted:function(e){var t;t=e.layers,i.removeLayer(t)},drawstart:function(e){console.log("drawstart")},drawstop:function(e){console.log("drawstop")},editstart:function(e){console.log("editstart")},editstop:function(e){console.log("editstop")},deletestart:function(e){console.log("deletestart")},deletestop:function(e){console.log("deletestop")}};o.getAvailableEvents().forEach(function(t){e.$on("leafletDirectiveDraw."+t,function(e,a){var n,r,o,s;n=a.leafletEvent,r=a.leafletObject,o=a.model,s=a.modelName,u[t.replace("draw:","")](e,n,r,o,s)})})}e.$inject=["$scope","$timeout","$mdDialog","$translate","StatisticsService","leafletDrawEvents"],angular.module("enviroCar.community").controller("CommunityCtrl",e)}(),function(){"use strict";function e(e,t,a,n,r){"ngInject";var o,s=a.getCredentials();s&&(o=s.username,s.password),e.name_of_user=o,e.track_number=0,e.distance_driven=0,e.duration_driven=0,e.emailId="",e.total_users=0,e.total_tracks=0,e.total_distance=0,e.tracksAvailable=!0;var i=function(e){var t=parseFloat(e+"");t*=60;var a=Math.floor(t/60);t-=60*a;var n=Math.floor(t);return a<10&&(a="0"+a),n<10&&(n="0"+n),a+":"+n};n.getUser(o).then(function(t){e.emailId=t.mail},function(e){console.log("Error: "+e),console.log(e)}),n.getUserStatistic(o).then(function(t){var a=t.data;e.distance_driven=a.distance.toFixed(1)+"km",e.duration_driven=i(a.duration)+"h",e.track_number=a.trackSummaries.length,0===e.track_number&&(e.tracksAvailable=!1)},function(e){console.log(e)})}e.$inject=["$scope","$timeout","UserCredentialsService","UserService","TrackService"],angular.module("enviroCar").controller("DashboardCtrl",e)}(),function(){function e(e,t,a,n,r,o){"ngInject";console.log("LoginCtrl started."),e.username="",e.password="",e.error=!1,e.login_active=!0,e.reset_password=!1,e.register_success=!1,e.username_register="",e.email_register="",e.password_register="",e.password_repeat="",e.error_pw_not_match=!1,e.error_pw_empty=!1,e.error_pw_repeat_empty=!1,e.error_mail=!1,e.error_name=!1,e.error_name_too_short=!1,e.error_name_in_use=!1,e.name_in_use_alrdy="",e.reset_success=!1,e.reset_name="",e.reset_mail="",e.error_username_empty=!1,e.error_username_too_short=!1,e.error_mail=!1,e.error_usermail_not_exist=!1,e.error_request_sent_alrdy=!1,e.login_request_running=!1,e.register_request_running=!1,e.passwordreset_request_running=!1,e.resetPassword=function(){if(e.error_username_empty=!1,e.error_username_too_short=!1,e.error_mail=!1,e.error_usermail_not_exist=!1,e.error_request_sent_alrdy=!1,e.reset_success=!1,""===e.reset_name&&(e.error_username_empty=!0),!e.error_username_empty&&e.reset_name.length<4&&(e.error_username_too_short=!0),""===e.reset_mail&&(e.error_mail=!0),!e.error_username_empty&&!e.error_username_too_short&&!e.error_mail){e.passwordreset_request_running=!0;var t={user:{name:e.reset_name,mail:e.reset_mail}};r.postPasswordReset(t).then(function(t){console.log(t),e.reset_success=!0,e.error_username_empty=!1,e.error_username_too_short=!1,e.error_mail=!1,e.error_usermail_not_exist=!1,e.error_request_sent_alrdy=!1,e.passwordreset_request_running=!1},function(t){e.reset_success=!1,console.log(t),400===t.status&&t.data.errors[0]&&("string"==typeof t.data.errors[0]||t.data.errors[0]instanceof String?(t.data.errors[0].startsWith("The given combination")&&(e.error_usermail_not_exist=!0),t.data.errors[0].startsWith("The given user already")&&(e.error_request_sent_alrdy=!0),t.data.errors[0].startsWith("instance failed")&&(e.error_mail=!0)):("string"==typeof t.data.errors[0].message||t.data.errors[0].message instanceof String)&&(t.data.errors[0].message.startsWith("The given combination")&&(e.error_usermail_not_exist=!0),t.data.errors[0].message.startsWith("The given user already")&&(e.error_request_sent_alrdy=!0),t.data.errors[0].message.startsWith("instance failed")&&(e.error_mail=!0))),e.passwordreset_request_running=!1})}},e.register=function(){if(e.error_pw_not_match=!1,e.error_pw_empty=!1,e.error_pw_repeat_empty=!1,e.error_mail=!1,e.error_name=!1,e.error_name_too_short=!1,e.error_name_in_use=!1,e.name_in_use_alrdy="",e.register_success=!1,""===e.username_register&&(e.error_name=!0),!e.error_name&&e.username_register.length<4&&(e.error_name_too_short=!0),""===e.email_register&&(e.error_mail=!0),""===e.password_register&&(e.error_pw_empty=!0),""===e.password_repeat&&(e.error_pw_repeat_empty=!0),e.password_register===e.password_repeat||e.error_pw_empty||e.error_pw_repeat_empty||(e.error_pw_not_match=!0),e.error_pw_empty||e.error_pw_repeat_empty||e.error_pw_not_match||e.error_mail||e.error_name||e.error_name_too_short)console.log("error in registration.");else{e.register_request_running=!0;var t={name:e.username_register,mail:e.email_register,token:e.password_register};r.postUser(e.username_register,t).then(function(t){e.username=e.username_register,e.password=e.password_register,e.register_success=!0,e.error=!1,e.error_name_in_use=!1,e.error_name_too_short=!1,e.error_pw_not_match=!1,e.error_pw_repeat_empty=!1,e.error_pw_empty=!1,e.error_mail=!1,e.error_name=!1,e.name_in_use_alrdy="",e.register_request_running=!1},function(t){console.log(t),409===t.status&&(e.error_name_in_use=!0,e.name_in_use_alrdy=e.username_register),400===t.status&&(e.error_mail=!0),e.register_success=!1,e.register_request_running=!1})}},e.login=function(){e.dataLoading=!0,e.login_request_running=!0,r.getUserWithAuth(e.username,e.password).then(function(r,o,s){console.log(r),e.username===r.data.name?(e.error=!1,n.setCredentials(e.username),void 0!==t.url_redirect_on_login||a.path("/dashboard")):e.error=!0,e.login_request_running=!1},function(e){console.log(e)})},e.logout=function(){e.error=!1,n.clearCredentials(),n.clearCookies(),e.username="",e.password="",o.resetFilterStates()}}e.$inject=["$scope","$rootScope","$location","UserCredentialsService","UserService","FilterStateService"],angular.module("enviroCar.auth").controller("LoginCtrl",e)}(),function(){"use strict";function e(e){"ngInject";console.log("UserCredentialsService started.");var t={username:""};this.setCredentials=function(e){t.username=e},this.getCredentials=function(){return t},this.clearCredentials=function(){t.username=""},this.deleteCookies=function(){e.put("language",""),e.put("JSESSIONID",""),e.remove("JSESSIONID"),e.remove("language")}}e.$inject=["$cookieStore"],angular.module("enviroCar.auth").service("UserCredentialsService",e)}(),function(){"use strict";function e(e,t,a,n,r,o,s,i){"ngInject";e.username="";var l=o.getCredentials();l&&(e.username=l.username),e.name=e.username,e.firstName,e.lastName,e.email,e.country,e.countrytext,e.birthday,e.gender=void 0,e.gendertext,e.language=void 0,e.langfull,e.langtext,e.oldpassword,e.newpassword,e.newpasswordrepeat,e.created,e.modified,e.termsOfUseVersion,e.dateBirthdayPicker=void 0,s.getUser(e.username).then(function(t){console.log(t);var t=t.data;if(e.created=new Date(t.created).toLocaleString().split(",")[0],e.modified=new Date(t.modified).toLocaleString().split(",")[0],e.termsOfUseVersion=new Date(t.acceptedTermsOfUseVersion).toLocaleString().split(",")[0],void 0!==t.firstName&&(e.firstName=t.firstName),void 0!==t.lastName&&(e.lastName=t.lastName),void 0!==t.gender?(e.gender=t.gender,"m"===e.gender?e.gendertext=a.instant("MALE"):e.gendertext=a.instant("FEMALE")):e.gendertext="NA",void 0!==t.country?(e.country=t.country,e.countrytext=t.country):e.countrytext="NA",void 0!==t.language?(e.languagetext=t.language,e.language=t.language.split("-")[0],"en"===e.language?(e.languagetext=a.instant("ENGLISH"),e.lang="en"):"de"===e.language&&(e.languagetext=a.instant("GERMAN"),e.lang="de")):e.languagetext="NA",void 0!==t.mail&&(e.email=t.mail,e.emailId=t.mail),void 0!==t.dayOfBirth){e.birthday=t.dayOfBirth;var n=t.dayOfBirth.split("-");e.dateBirthdayPicker=new Date(n[0],n[1]-1,n[2])}},function(e){console.log("error "+e)});var c=function(){console.log("updating userdata on webapp.."),void 0!==e.emailId&&""!==e.emailId&&(e.email=e.emailId),void 0!==e.gender?(e.gendertext=e.gender,"m"===e.gender?e.gendertext=a.instant("MALE"):e.gendertext=a.instant("FEMALE")):e.gendertext="NA",void 0!==e.country&&""!==e.country&&(e.countrytext=e.country),void 0!==e.lang&&""!==e.lang&&("en"===e.lang?e.languagetext=a.instant("ENGLISH"):"de"===e.lang?e.languagetext=a.instant("GERMAN"):e.languagetext=e.lang)};e.deleteUserDialog=function(){var t={},a=(r("sm")||r("xs"))&&e.customFullscreen;t={controller:"DeleteUserCtrl",templateUrl:"app/components/profile/delete/delete_confirm_dialog.html",parent:angular.element(document.body),scope:e.$new(),clickOutsideToClose:!1,fullscreen:a},n.show(t).then(function(t){t&&i.getUserTracks(e.username).then(function(t){var a,n=t.data.tracks;for(a in n)i.deleteTrack(e.username,n[a].id).then(function(e){console.log("Track '"+e+"' has been deleted.")},function(e){console.log("Error deleting track '"+e+"'.")})},function(e){console.log("Error getting user tracks -> unsecure user profile deletion. Aborting mission...  Please try again later.")}),s.deleteUser(e.username).then(function(e){console.log(e),o.clearCredentials(),o.clearCookies()},function(a){console.log(a),console.log("dialog confirmed with answer: "+t),e.status='You said the information was "'+t+'".'},function(){console.log("dialog canceled without answer"),e.status="You cancelled the dialog."}),e.$watch(function(){return r("xs")||r("sm")},function(t){e.customFullscreen=!0===t})})},e.showConfirm=function(t){e.deleteUserDialog()};var d;e.submissionSuccess=!1,e.submissionErrorMessage="",e.submissionFailure=!1,e.updateUserDetails=function(){e.submissionSuccess=!1,e.submissionErrorMessage="",e.submissionFailure=!1;var a=!0;void 0!==e.oldpassword&&""!==e.oldpassword&&(console.log("old pw is typed."),void 0!==e.newpassword&&""!==e.newpassword||(console.log("new password(1) is wrong."),a=!1)),void 0!==e.newpassword&&""!==e.newpassword&&(console.log("old pw: "+e.oldpassword),void 0!==e.oldpassword&&""!==e.oldpassword||(a=!1),e.newpassword!==e.newpasswordrepeat&&(a=!1));var n={};if(void 0!==e.firstName&&(n.firstName=e.firstName),void 0!==e.emailId&&(n.mail=e.emailId),void 0!==e.lastName&&(n.lastName=e.lastName),void 0!==e.country&&(n.country=e.country),void 0!==e.dateBirthdayPicker){var r=e.dateBirthdayPicker.getFullYear().toString()+"-"+(e.dateBirthdayPicker.getMonth()+1).toString()+"-"+e.dateBirthdayPicker.getDate().toString();console.log(r),n.dayOfBirth=r}void 0!==e.gender&&(n.gender=e.gender),void 0!==e.newpassword&&""!==e.newpassword&&(n.token=e.newpassword),void 0!==e.oldpassword&&(d=e.oldpassword),void 0!==e.lang&&("en"===e.lang?n.language="en-EN":"de"===e.lang?n.language="de-DE":n.language=e.lang),console.log(n),void 0!==e.newpassword&&""!==e.newpassword&&e.newpassword===e.newpasswordrepeat?s.putUserDetails(e.username,e.oldpassword,n).then(function(n){!0===a?(e.submissionSuccess=!0,t(function(){e.submissionSuccess=!1},5e3),void 0!==e.newpassword&&""!==e.newpassword&&(o.setCredentials(e.username,e.newpassword),e.token=e.newpassword),c()):e.submissionErrorMessage="Could not update profile"},function(t){console.log(t),e.submissionErrorMessage="Please enter the correct existing password",e.submissionFailure=!0}):void 0===e.newpassword||""===e.newpassword?s.putUserDetails(e.username,n).then(function(a){console.log("no new password, but updates on profile."),e.submissionSuccess=!0,t(function(){e.submissionSuccess=!1},5e3),c()},function(e){console.log(e)}):(console.log("updates with new password, but password error."),e.submissionErrorMessage="new password and re-entered password do not match",e.submissionFailure=!0)},e.$on("toolbar:language-changed",function(n,r){void 0!==e.lang&&""!==e.lang?"en"===e.lang?e.languagetext=a.instant("ENGLISH"):"de"===e.lang?e.languagetext=a.instant("GERMAN"):e.languagetext=e.lang:e.languagetext="NA",void 0!==e.gender&&""!==e.gender?"m"===e.gender?e.gendertext=a.instant("MALE"):e.gendertext=a.instant("FEMALE"):e.gendertext="NA",t(function(){window.dispatchEvent(new Event("resize"))},500)})}e.$inject=["$scope","$timeout","$translate","$mdDialog","$mdMedia","UserCredentialsService","UserService","TrackService"],angular.module("enviroCar.profile").controller("ProfileCtrl",e)}(),function(){"use strict";function e(e,t,a,n,r,o,s,i,l){"ngInject";function c(a){t.title=a.name,t.collapse(),i(function(){window.dispatchEvent(new Event("resize")),e.$broadcast("sidenav:item-selected",t.language)},1e3)}function d(){s.when(!0).then(function(){r("left").toggle(),t.collapse()})}t.menuItems=[{name:"DASHBOARD",icon:"dashboard",sref:".dashboard",tooltip:"TT_SN_DASHBOARD_OPEN",commingSoon:!1},{name:"TRACKS",icon:"directions_car",sref:".tracks",tooltip:"TT_SN_TRACKS_OPEN",commingSoon:!1},{name:"TABLE",icon:"person",sref:".profile",tooltip:"TT_SN_PROFILE_OPEN",commingSoon:!1},{name:"COMMUNITY",icon:"pie_chart",sref:".community",tooltip:"TT_SN_SEGMENT_OPEN",commingSoon:!0}],t.selectItem=c,t.toggleItemsList=d,t.menuItems[0].name="DASHBOARD",t.menuItems[1].name="TRACKS",t.menuItems[2].name="TABLE",t.menuItems[3].name="COMMUNITY",t.menuItems[0].tooltip="TT_SN_DASHBOARD_OPEN",t.menuItems[1].tooltip="TT_SN_TRACKS_OPEN",t.menuItems[2].tooltip="TT_SN_PROFILE_OPEN",t.menuItems[3].tooltip="TT_SN_SEGMENT_OPEN",t.menuItems[0].commingSoon=!1,t.menuItems[1].commingSoon=!1,t.menuItems[2].commingSoon=!1,t.menuItems[3].commingSoon=!0,t.navExpanded=!0,t.toggleLeft=function(e){return function(){r(e).toggle().then(function(){o.debug("toggle "+e+" is done")})}}("left");var u=angular.element(a[0].querySelector("#leftSideNav")),m=angular.element(a[0].querySelector("#sidenav-title"));o.debug("sideNav: "+u),t.close=function(){r("left").close().then(function(){o.debug("close LEFT is done")})},t.open=function(){r("left").open().then(function(){o.debug("open LEFT is done")})},t.collapse=function(){n("gt-xs")?(u.css("min-width","60px"),u.css("width","60px"),u.css("max-width","60px"),m.css("padding-left","0em"),t.sideNavTitle="  "):(u.css("min-width","0px"),u.css("width","0px"),u.css("max-width","0px"),m.css("padding-left","0em"),t.sideNavTitle="  "),t.navExpanded=!1},t.collapse(),t.toggleExpand=function(){t.navExpanded?(n("gt-xs")?(u.css("min-width","60px"),u.css("width","60px"),u.css("max-width","60px"),m.css("padding-left","0em"),t.sideNavTitle="  "):(u.css("min-width","0px"),u.css("width","0px"),u.css("max-width","0px"),m.css("padding-left","0em"),t.sideNavTitle="  "),t.navExpanded=!1,o.debug("sidenav collapsed")):(u.css("min-width","280px"),u.css("width","280px"),u.css("max-width","280px"),m.css("padding-left","1.8em"),t.sideNavTitle=l.instant("WEBSITE-TITLE"),t.navExpanded=!0),t.navExpanded&&o.debug("expanded.")},t.openFeedback=function(){"de"===l.use()?window.open("https://docs.google.com/forms/d/e/1FAIpQLSdHX4CPrqYwh27HjWYV8ZsblvqVwGVC2B-7ZxWovVOCpGKuJQ/viewform","_blank"):window.open("https://docs.google.com/forms/d/e/1FAIpQLSdfanFDFmIEgD9p6GWyC9oEDXLhiMdE3hptZVCdV8WsG4Ik1g/viewform","_blank")}}e.$inject=["$rootScope","$scope","$element","$mdMedia","$mdSidenav","$log","$q","$timeout","$translate"],angular.module("enviroCar").controller("SidenavCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/sidenav/sidenav.directive.html",controller:"SidenavCtrl",controllerAs:"vm"}}angular.module("enviroCar").directive("envirocarSidenav",e)}(),function(){"use strict";function e(e,t,a){"ngInject";console.log("ToolbarCtrl started."+a),t.title="enviroCar Webapp"}e.$inject=["$rootScope","$scope","ecBaseUrl"],angular.module("enviroCar").controller("ToolbarCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/toolbar/toolbar.directive.html",controller:"ToolbarCtrl",controllerAs:"vm"}}angular.module("enviroCar").directive("envirocarToolbar",e)}(),function(){"use strict";var e={yellow_break:[60,6,15,2e3,44,60],red_break:[130,12,30,3500,80,130],max_values:[255,25,45,5e3,110,310],opacity:.35,errorColorTransparent:"rgba(0,0,255,0.35)",errorColor:"rgb(0,0,255)"};angular.module("enviroCar.track").value("trackAnalysisSettings",e)}(),function(){"use strict";function e(e,t,a,n,r,o,s,i){"ngInject";e.onload_all_tracks_page=!1,e.tracksAvailable=!1;var l=!0,c=!1,d=!1,u=s.getCredentials();u&&(u.username,u.password),e.tracksAvailable=!0,e.showAlert=function(e,t,a){var n=o.instant(t),s=o.instant(a);r.show(r.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title(n).textContent(s).ariaLabel("Popover").ok("Okay!").targetEvent(e).fullscreen(!0))},e.goToActivity=function(e){t.go("chart",{trackid:e})},e.$on("trackspage:all_tracks_tab-loaded",function(t,a){(l=!0)&&c&&d&&(e.onload_all_tracks_page=!0,n(function(){window.dispatchEvent(new Event("resize")),n(function(){window.dispatchEvent(new Event("resize"))},600)},400))}),e.$on("trackspage:pagination_tab-loaded",function(t,a){c=!0,l&&c&&d&&(e.onload_all_tracks_page=!0,n(function(){window.dispatchEvent(new Event("resize")),n(function(){window.dispatchEvent(new Event("resize"))},600)},400))}),e.$on("trackspage:calendar_tab-loaded",function(t,a){d=!0,l&&c&&d&&(e.onload_all_tracks_page=!0,n(function(){window.dispatchEvent(new Event("resize")),n(function(){window.dispatchEvent(new Event("resize"))},600)},400))})}e.$inject=["$scope","$state","$stateParams","$timeout","$mdDialog","$translate","UserCredentialsService","UserService"],angular.module("enviroCar.tracks").controller("TrackListCtrl",e)}(),function(){DeleteUserCtrl=["$scope","$mdDialog","UserCredentialsService","TrackService",function(e,t,a,n){"ngInject";e.username="";var r=a.getCredentials();r&&(e.username=r.username),e.cb_delete_alltracks=!0,e.total_user_tracks=0,e.confirmPassword="",e.errorWrongPassword=!1,n.getUserTracks(e.username).then(function(t){console.log(t),e.total_user_tracks=t.data.tracks.length},function(e){}),e.deleteUser=function(){t.hide(e.cb_delete_alltracks)},e.cancel=function(){t.cancel()}}],angular.module("enviroCar.tracks").controller("DeleteUserCtrl",DeleteUserCtrl)}(),function(){"use strict";function e(e,t,a,n,r,o,s){"ngInject";e.onload_all=!1,e.onload_speed=!1,e.onload_consumption=!1,e.onload_CO2=!1,e.onload_engine=!1,e.onload_RPM=!1,e.onload_GPSSpeed=!1,e.loading=!0,e.selectedPhenom="Speed",e.trackid=t.trackid,e.optionsSpeed={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:15,left:50},x:function(e){return n.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.1f")(e)},duration:300,yAxis:{axisLabel:n.instant("SPEED")+" (km/h)",axisLabelDistance:-10},tooltip:{contentGenerator:function(e){
return"<h3><b>"+n.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(1)+"km/h </h3>"}}}},e.changeComparingRange=function(t,a){var n={Speed:0,Consumption:0,CO2:0,Rpm:0,"Engine Load":0,"GPS Speed":0},r={Speed:0,Consumption:0,CO2:0,Rpm:0,"Engine Load":0,"GPS Speed":0},o={Speed:!1,Consumption:!1,CO2:!1,Rpm:!1,"Engine Load":!1,"GPS Speed":!1};void 0!==e.data_all[0].values[0]&&(o.Speed=!0),void 0!==e.data_all[1].values[0]&&(o.Consumption=!0),void 0!==e.data_all[2].values[0]&&(o.CO2=!0),void 0!==e.data_all[3].values[0]&&(o.Rpm=!0),void 0!==e.data_all[4].values[0]&&(o["Engine Load"]=!0),void 0!==e.data_all[5].values[0]&&(o["GPS Speed"]=!0);for(var s=t;s<a;s++)o.Speed&void 0!==e.data_all[0].values[s].y&&(r.Speed+=e.data_all[0].values[s].y,n.Speed+=1),o.Consumption&void 0!==e.data_all[1].values[s].y&&(r.Consumption+=e.data_all[1].values[s].y,n.Consumption+=1),o.CO2&void 0!==e.data_all[2].values[s].y&&(r.CO2+=e.data_all[2].values[s].y,n.CO2+=1),o.Rpm&void 0!==e.data_all[3].values[s].y&&(r.Rpm+=e.data_all[3].values[s].y,n.Rpm+=1),o["Engine Load"]&void 0!==e.data_all[4].values[s].y&&(r["Engine Load"]+=e.data_all[4].values[s].y,n["Engine Load"]+=1),o["GPS Speed"]&void 0!==e.data_all[5].values[s].y&&(r["GPS Speed"]+=e.data_all[5].values[s].y,n["GPS Speed"]+=1);var i={};void 0!==r.Speed&&(i.Speed=r.Speed/n.Speed),void 0!==r.Consumption&&(i.Consumption=r.Consumption/n.Consumption),void 0!==r.CO2&&(i.CO2=r.CO2/n.CO2),void 0!==r.Rpm&&(i.Rpm=r.Rpm/n.Rpm),void 0!==r["Engine Load"]&&(i["Engine Load"]=r["Engine Load"]/n["Engine Load"]),void 0!==r["GPS Speed"]&&(i["GPS Speed"]=r["GPS Speed"]/n["GPS Speed"]),e.dataSpeed[0].values[0].value=i.Speed,e.dataConsumption[0].values[0].value=i.Consumption,e.dataCO2[0].values[0].value=i.CO2,e.dataRPM[0].values[0].value=i.Rpm,e.dataEngineLoad[0].values[0].value=i["Engine Load"],e.dataGPSSpeed[0].values[0].value=i["GPS Speed"],e.dataSpeed[0].values[0].color=e.percentToRGB(e.yellow_break[0],e.red_break[0],e.max_values[0],i.Speed,1),e.dataConsumption[0].values[0].color=e.percentToRGB(e.yellow_break[1],e.red_break[1],e.max_values[1],i.Consumption,1),e.dataCO2[0].values[0].color=e.percentToRGB(e.yellow_break[2],e.red_break[2],e.max_values[2],i.CO2,1),e.dataRPM[0].values[0].color=e.percentToRGB(e.yellow_break[3],e.red_break[3],e.max_values[3],i.Rpm,1),e.dataEngineLoad[0].values[0].color=e.percentToRGB(e.yellow_break[4],e.red_break[4],e.max_values[4],i["Engine Load"],1),e.dataGPSSpeed[0].values[0].color=e.percentToRGB(e.yellow_break[5],e.red_break[5],e.max_values[5],i["GPS Speed"],1)},e.$on("single_track_page:segment-changed",function(t,a){e.min=a.min,e.max=a.max,e.changeComparingRange(e.min,e.max)}),e.$on("toolbar:language-changed",function(t,a){var r=n.instant("SPEED")+" (km/h)";e.optionsSpeed.chart.yAxis={axisLabel:r,axisLabelDistance:-10};var o=n.instant("CONSUMPTION")+" (l/h)";e.optionsConsumption.chart.yAxis={axisLabel:o,axisLabelDistance:-10};var s=n.instant("CO2")+" (kg/h)";e.optionsCO2.chart.yAxis={axisLabel:s,axisLabelDistance:-10};var i=n.instant("ENGINE_LOAD")+" (%)";e.optionsEngine.chart.yAxis={axisLabel:i,axisLabelDistance:-10};var l=n.instant("RPM")+" (r/min)";e.optionsRPM.chart.yAxis={axisLabel:l,axisLabelDistance:-10};var c=n.instant("GPS_SPEED")+" km/h";e.optionsGPSSpeed.chart.yAxis={axisLabel:c,axisLabelDistance:-10}}),e.$on("single_track_page:segment-activated",function(t,a){a?(e.min||(e.min=0),e.max||(e.max=e.track_length),e.changeComparingRange(e.min,e.max)):e.changeComparingRange(0,e.track_length)}),e.$on("track-toolbar:phenomenon-changed",function(t,a){e.selectedPhenom=a,e.segmentActivated&&void 0!==e.min?e.changeComparingRange(e.min,e.max):e.changeComparingRange(0,e.track_length)}),e.optionsConsumption={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:15,left:50},x:function(e){return n.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.2f")(e)},duration:300,yAxis:{axisLabel:n.instant("CONSUMPTION")+" (l/h)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){return"<h3><b>"+n.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(2)+"l/h </h3>"}}}},e.optionsCO2={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:15,left:50},x:function(e){return n.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:300,yAxis:{axisLabel:"CO2 (kg/h)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){return"<h3><b>"+n.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(4)+"kg/h </h3>"}}}},e.optionsEngine={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:15,left:50},x:function(e){return n.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.1f")(e)},duration:300,yAxis:{axisLabel:n.instant("ENGINE_LOAD")+" (%)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){return"<h3><b>"+n.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(1)+"% </h3>"}}}},e.optionsRPM={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:15,left:50},x:function(e){return n.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.0f")(e)},duration:300,yAxis:{axisLabel:n.instant("RPM")+" (r/min)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){return"<h3><b>"+n.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(0)+"r/min </h3>"}}}},e.optionsGPSSpeed={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:15,left:50},x:function(e){return n.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.1f")(e)},duration:300,yAxis:{axisLabel:n.instant("GPS Speed")+" (km/h)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){return"<h3><b>"+n.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(1)+"km/h </h3>"}}}},e.data_all=[{key:"Speed",values:[]},{key:"Consumption",values:[]},{key:"CO2",values:[]},{key:"Rpm",values:[]},{key:"Engine Load",values:[]},{key:"GPS Speed",values:[]}];var i={};r.getTrack(e.trackid).then(function(t){i=t;var n=i.data.features.length;e.track_length=n;for(var r,s,l,c,d,u,m,h,g,p,_,v,f={Speed:0,Consumption:0,CO2:0,Rpm:0,"Engine Load":0,"GPS Speed":0},k=1;k<n;k++)i.data.features[k].properties.phenomenons.Speed?(r=i.data.features[k].properties.phenomenons.Speed.value,f.Speed+=r,m={x:k,y:i.data.features[k].properties.phenomenons.Speed.value}):(r=0,m={x:k,y:void 0}),i.data.features[k].properties.phenomenons.Consumption?(s=i.data.features[k].properties.phenomenons.Consumption.value,f.Consumption+=s,h={x:k,y:i.data.features[k].properties.phenomenons.Consumption.value}):(s=0,h={x:k,y:void 0}),i.data.features[k].properties.phenomenons.CO2?(l=i.data.features[k].properties.phenomenons.CO2.value,f.CO2+=l,g={x:k,y:i.data.features[k].properties.phenomenons.CO2.value}):(l=0,g={x:k,y:void 0}),i.data.features[k].properties.phenomenons.Rpm?(c=i.data.features[k].properties.phenomenons.Rpm.value,f.Rpm+=c,p={x:k,y:i.data.features[k].properties.phenomenons.Rpm.value}):(c=0,p={x:k,y:void 0}),i.data.features[k].properties.phenomenons["Engine Load"]?(d=i.data.features[k].properties.phenomenons["Engine Load"].value,f["Engine Load"]+=d,_={x:k,y:i.data.features[k].properties.phenomenons["Engine Load"].value}):(d=0,_={x:k,y:void 0}),i.data.features[k].properties.phenomenons["GPS Speed"]?(u=i.data.features[k].properties.phenomenons["GPS Speed"].value,f["GPS Speed"]+=u,v={x:k,y:i.data.features[k].properties.phenomenons["GPS Speed"].value}):(u=0,v={x:k,y:void 0}),e.data_all[0].values.push(m),e.data_all[1].values.push(h),e.data_all[2].values.push(g),e.data_all[3].values.push(p),e.data_all[4].values.push(_),e.data_all[5].values.push(v);var E={};f.Speed&&(E.Speed=f.Speed/n),f.Consumption&&(E.Consumption=f.Consumption/n),f.CO2&&(E.CO2=f.CO2/n),f.Rpm&&(E.Rpm=f.Rpm/n),f["Engine Load"]&&(E["Engine Load"]=f["Engine Load"]/n),f["GPS Speed"]&&(E["GPS Speed"]=f["GPS Speed"]/n),o.getPhenomenonStatistics("Speed").then(function(t){var n=t.data,r=n.avg;e.dataSpeed=[{key:"Cumulative Return",values:[{label:"TRACK_LABEL_USER",value:E.Speed,color:e.percentToRGB(e.yellow_break[0],e.red_break[0],e.max_values[0],E.Speed,1)},{label:"TRACK_LABEL_PUBLIC",value:r,color:e.percentToRGB(e.yellow_break[0],e.red_break[0],e.max_values[0],r,1)}]}],e.onload_Speed=!0,a(function(){window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log("error "+e)}),o.getPhenomenonStatistics("Consumption").then(function(t){var n=t.data,r=n.avg;e.dataConsumption=[{key:"Cumulative Return",values:[{label:"TRACK_LABEL_USER",value:E.Consumption,color:e.percentToRGB(e.yellow_break[1],e.red_break[1],e.max_values[1],E.Consumption,1)},{label:"TRACK_LABEL_PUBLIC",value:r,color:e.percentToRGB(e.yellow_break[1],e.red_break[1],e.max_values[1],r,1)}]}],e.onload_Consumption=!0,a(function(){window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log("error "+e)}),o.getPhenomenonStatistics("CO2").then(function(t){var n=t.data,r=n.avg;e.dataCO2=[{key:"Cumulative Return",values:[{label:"TRACK_LABEL_USER",value:E.CO2,color:e.percentToRGB(e.yellow_break[2],e.red_break[2],e.max_values[2],E.CO2,1)},{label:"TRACK_LABEL_PUBLIC",value:r,color:e.percentToRGB(e.yellow_break[2],e.red_break[2],e.max_values[2],r,1)}]}],e.onload_CO2=!0,a(function(){window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log("error "+e)}),o.getPhenomenonStatistics("Rpm").then(function(t){var n=t.data,r=n.avg;e.dataRPM=[{key:"Cumulative Return",values:[{label:"TRACK_LABEL_USER",value:E.Rpm,color:e.percentToRGB(e.yellow_break[3],e.red_break[3],e.max_values[3],E.Rpm,1)},{label:"TRACK_LABEL_PUBLIC",value:r,color:e.percentToRGB(e.yellow_break[3],e.red_break[3],e.max_values[3],r,1)}]}],e.onload_RPM=!0,a(function(){window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log("error "+e)}),o.getPhenomenonStatistics("Engine Load").then(function(t){var n=t.data,r=n.avg;e.dataEngineLoad=[{key:"Cumulative Return",values:[{label:"TRACK_LABEL_USER",value:E["Engine Load"],color:e.percentToRGB(e.yellow_break[4],e.red_break[4],e.max_values[4],E["Engine Load"],1)},{label:"TRACK_LABEL_PUBLIC",value:r,color:e.percentToRGB(e.yellow_break[4],e.red_break[4],e.max_values[4],r,1)}]}],e.onload_EngineLoad=!0,a(function(){window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log("error "+e)}),o.getPhenomenonStatistics("GPS Speed").then(function(t){var n=t.data,r=n.avg;e.dataGPSSpeed=[{key:"Cumulative Return",values:[{label:"TRACK_LABEL_USER",value:E["GPS Speed"],color:e.percentToRGB(e.yellow_break[5],e.red_break[5],e.max_values[5],E["GPS Speed"],1)},{label:"TRACK_LABEL_PUBLIC",value:r,color:e.percentToRGB(e.yellow_break[5],e.red_break[5],e.max_values[5],r,1)}]}],e.onload_GPSSpeed=!0,a(function(){window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log("error "+e)}),a(function(){window.dispatchEvent(new Event("resize"))},200),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log(e)}),a(function(){window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)}e.$inject=["$scope","$stateParams","$timeout","$translate","TrackService","StatisticsService","UserCredentialsService"],angular.module("enviroCar").controller("ComparisonTrackChartCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/track_analysis/comparison_track_chart/comparison_chart.directive.html",controller:"ComparisonTrackChartCtrl"}}angular.module("enviroCar").directive("comparisonTrackChart",e)}(),function(){function e(e,t,a,n,r,o,s,i,l,c,d,u,m){"ngInject";t.downloadTrack=function(){window.location.href="http://envirocar.org/api/stable/tracks/"+t.trackid},t.goToDashboard=function(){a.go("dashboard",{})},t.$mdMedia=i,t.markerBlue={iconUrl:"app/components/assets/marker-icon.png",shadowUrl:"app/components/assets/marker-shadow.png",iconSize:[30,40],shadowSize:[50,64],iconAnchor:[15,39],shadowAnchor:[20,62]},t.markerGreen={iconUrl:"app/components/assets/marker-icon-green.png",shadowUrl:"app/components/assets/marker-shadow.png",iconSize:[30,40],shadowSize:[50,64],iconAnchor:[15,39],shadowAnchor:[20,62]};var h="#737373";e.track_toolbar_fixed=!1,t.timestamps=[],t.slider={minValue:0,maxValue:100,options:{floor:0,ceil:100,step:1,draggableRange:!0,getSelectionBarColor:function(e){return"#8cbf3f"},getPointerColor:function(e){return"#8cbf3f"},translate:function(e){return'<font color="white">'+t.timestamps[e]+"</font>"},id:"slider1",onChange:function(e){t.changeSelectionRange(t.slider.minValue,t.slider.maxValue)},onEnd:function(a){t.changeChartRange(t.slider.minValue,t.slider.maxValue),e.$broadcast("single_track_page:segment-changed",{min:t.slider.minValue,max:t.slider.maxValue})}}},t.yellow_break=m.yellow_break,t.red_break=m.red_break,t.max_values=m.max_values,t.errorColor=m.errorColor,t.errorColorTrans=m.errorColorTransparent,t.opacity=m.opacity,t.highlightedInterval=!1,t.intervalStart,t.intervalEnd,t.changeSelectionRange=function(e,a){0===e&&(e=1);for(var n=1;n<=e;n++)t.paths_all[t.currentPhenomenonIndex]["p"+n].color=h,t.paths_all[t.currentPhenomenonIndex]["p"+n].weight=4;for(var n=e+1;n<=a;n++)if(void 0!==p.data.features[n].properties.phenomenons[t.currentPhenomenon]){var r=p.data.features[n].properties.phenomenons[t.currentPhenomenon].value;r<t.intervalStart||r>t.intervalEnd?(t.paths_all[t.currentPhenomenonIndex]["p"+n].color=t.percentToRGB(t.yellow_break[t.currentPhenomenonIndex],t.red_break[t.currentPhenomenonIndex],t.max_values[t.currentPhenomenonIndex],r,t.opacity),t.paths_all[t.currentPhenomenonIndex]["p"+n].weight=5):(t.paths_all[t.currentPhenomenonIndex]["p"+n].color=t.percentToRGB(t.yellow_break[t.currentPhenomenonIndex],t.red_break[t.currentPhenomenonIndex],t.max_values[t.currentPhenomenonIndex],r,1),t.paths_all[t.currentPhenomenonIndex]["p"+n].weight=8)}else t.highlightedInterval?(t.paths_all[t.currentPhenomenonIndex]["p"+n].color=t.errorColorTrans,t.paths_all[t.currentPhenomenonIndex]["p"+n].weight=5):(t.paths_all[t.currentPhenomenonIndex]["p"+n].color=t.errorColor,t.paths_all[t.currentPhenomenonIndex]["p"+n].weight=8);for(var o=p.data.features.length-1,n=a+1;n<=o;n++)t.paths_all[t.currentPhenomenonIndex]["p"+n].color=h,t.paths_all[t.currentPhenomenonIndex]["p"+n].weight=4},t.changeChartRange=function(e,a){for(var n=[{key:o.instant("SPEED"),values:[]},{key:o.instant("CONSUMPTION"),values:[]},{key:o.instant("CO2"),values:[]},{key:o.instant("RPM"),values:[]},{key:o.instant("ENGINE_LOAD"),values:[]},{key:o.instant("GPS_SPEED"),values:[]}],r=0;r<6;r++)for(var s=0;s<t.data_all[r].values.length;s++)n[r].values[s]=t.data_all[r].values[s];for(var s=0;s<6;s++)n[s].values=n[s].values.slice(e,e+(a-e)+1);t.dataTrackChart[0]=n[t.currentPhenomenonIndex],e+=1;for(var i={lat:t.paths_all[t.currentPhenomenonIndex]["p"+e].latlngs[0].lat,lng:t.paths_all[t.currentPhenomenonIndex]["p"+e].latlngs[0].lng},l={lat:t.paths_all[t.currentPhenomenonIndex]["p"+e].latlngs[0].lat,lng:t.paths_all[t.currentPhenomenonIndex]["p"+e].latlngs[0].lng},s=e+1;s<=a;s++){var c=t.paths_all[t.currentPhenomenonIndex]["p"+s].latlngs[0].lat;c>i.lat&&(i.lat=c),c<l.lat&&(l.lat=c);var d=t.paths_all[t.currentPhenomenonIndex]["p"+s].latlngs[0].lng;d>i.lng&&(i.lng=d),d<l.lng&&(l.lng=d)}var c=t.paths_all[t.currentPhenomenonIndex]["p"+a].latlngs[1].lat;c>i.lat&&(i.lat=c),c<l.lat&&(l.lat=c);var d=t.paths_all[t.currentPhenomenonIndex]["p"+a].latlngs[1].lng;d>i.lng&&(i.lng=d),d<l.lng&&(l.lng=d);var m=(i.lat-l.lat)/10,h=(i.lng-l.lng)/10;t.bounds=u.createBoundsFromArray([[i.lat+m,i.lng+h],[l.lat-m,l.lng-h]])},t.showAlert=function(e,t,a){var n=o.instant(t),r=o.instant(a);s.show(s.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title(n).textContent(r).ariaLabel("Popover").ok("Okay!").targetEvent(e).fullscreen(!0))},$(window).scroll(function(){if($(window).scrollTop()>300){if(!e.track_toolbar_fixed){$("#track_toolbar").addClass("stuck_top"),$("#placeholder-toolbar-stp").css("min-height","70px"),$("#placeholder-toolbar-stp").css("height","70px"),$("#placeholder-toolbar-stp").css("max-height","70px"),e.track_toolbar_fixed=!0;var a=document.getElementById("placeholder-left").offsetWidth,n=0;0===a&&(n=120,$("#toolbar-ctrl-placeholder").css("min-width","0px"),$("#toolbar-ctrl-placeholder").css("width","0px"),$("#toolbar-ctrl-placeholder").css("max-width","0px")),t.screenIsXS&&(n-=60);var o=window.innerWidth,s=o-2*a-n-76;$("#track_toolbar").css("width",s+"px"),r(function(){window.dispatchEvent(new Event("resize"))},1)}}else if(e.track_toolbar_fixed){$("#track_toolbar").removeClass("stuck_top"),$("#placeholder-toolbar-stp").css("min-height","1px"),$("#placeholder-toolbar-stp").css("height","1px"),$("#placeholder-toolbar-stp").css("max-height","1px"),e.track_toolbar_fixed=!1;var a=document.getElementById("placeholder-left").offsetWidth;0===a&&($("#toolbar-ctrl-placeholder").css("max-width","120px"),$("#toolbar-ctrl-placeholder").css("width","120px"),$("#toolbar-ctrl-placeholder").css("min-width","120px")),$("#track_toolbar").css("width","100%"),r(function(){window.dispatchEvent(new Event("resize"))},1)}}),t.trackid=n.trackid,t.created="",t.onload_track_map=!1,t.onload_track_chart=!1,t.segmentActivated=!1,t.currentPhenomenon="Speed",t.currentPhenomenonIndex=0,t.intervalStart=0,t.intervalEnd=t.max_values[t.currentPhenomenonIndex],t.percentToRGB=function(e,t,a,n,r){var o,s;return n<=e?(o=Math.floor(n/e*255),s=255):n<=t?(o=255,s=Math.floor((t-n)/(t-e)*255)):n<=a&&(o=Math.floor((a-n)/(a-t)*255),s=0),"rgba("+o+","+s+",0,"+r+")"},legend_all=[{position:"bottomright",colors:["#00ff00",t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.yellow_break[0]/2,1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.yellow_break[0],1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],(t.yellow_break[0]+t.red_break[0])/2,1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.red_break[0],1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],(t.red_break[0]+t.max_values[0])/2,1)],labels:["  0 km/h"," "+t.yellow_break[0]/2+" km/h"," "+t.yellow_break[0]+" km/h"," "+(t.yellow_break[0]+t.red_break[0])/2+" km/h"," "+t.red_break[0]+" km/h"," "+(t.red_break[0]+t.max_values[0])/2+" km/h"]},{position:"bottomright",colors:["#00ff00",t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],t.yellow_break[1]/2,1),t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],t.yellow_break[1],1),t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],(t.yellow_break[1]+t.red_break[1])/2,1),t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],t.red_break[1],1),t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],(t.red_break[1]+t.max_values[1])/2,1)],labels:[" 0 l/h"," "+t.yellow_break[1]/2+" l/h"," "+t.yellow_break[1]+" l/h"," "+(t.yellow_break[1]+t.red_break[1])/2+" l/h"," "+t.red_break[1]+" l/h"," "+(t.red_break[1]+t.max_values[1])/2+" l/h"]},{position:"bottomright",colors:["#00ff00",t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],t.yellow_break[2]/2,1),t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],t.yellow_break[2],1),t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],(t.yellow_break[2]+t.red_break[2])/2,1),t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],t.red_break[2],1),t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],(t.red_break[2]+t.max_values[2])/2,1)],labels:[" 0 kg/h"," "+t.yellow_break[2]/2+" kg/h"," "+t.yellow_break[2]+" kg/h"," "+(t.yellow_break[2]+t.red_break[2])/2+" kg/h"," "+t.red_break[2]+" kg/h"," "+(t.red_break[2]+t.max_values[2])/2+" kg/h"]},{position:"bottomright",colors:["#00ff00",t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],t.yellow_break[3]/2,1),t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],t.yellow_break[3],1),t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],(t.yellow_break[3]+t.red_break[3])/2,1),t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],t.red_break[3],1),t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],(t.red_break[3]+t.max_values[3])/2,1)],labels:["   0 r/min"," "+t.yellow_break[3]/2+" r/min"," "+t.yellow_break[3]+" r/min"," "+(t.yellow_break[3]+t.red_break[3])/2+" r/min"," "+t.red_break[3]+" r/min"," "+(t.red_break[3]+t.max_values[3])/2+" r/min"]},{position:"bottomright",colors:["#00ff00",t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],t.yellow_break[4]/2,1),t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],t.yellow_break[4],1),t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],(t.yellow_break[4]+t.red_break[4])/2,1),t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],t.red_break[4],1),t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],(t.red_break[4]+t.max_values[4])/2,1)],labels:["  0 %"," "+t.yellow_break[4]/2+" %"," "+t.yellow_break[4]+" %"," "+(t.yellow_break[4]+t.red_break[4])/2+" %"," "+t.red_break[4]+" %"," "+(t.red_break[4]+t.max_values[4])/2+" %"]},{position:"bottomright",colors:["#00ff00",t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],t.yellow_break[5]/2,1),t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],t.yellow_break[5],1),t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],(t.yellow_break[5]+t.red_break[5])/2,1),t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],t.red_break[5],1),t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],(t.red_break[5]+t.max_values[5])/2,1)],labels:["  0 km/h"," "+t.yellow_break[5]/2+" km/h"," "+t.yellow_break[5]+" km/h"," "+(t.yellow_break[5]+t.red_break[5])/2+" km/h"," "+t.red_break[5]+" km/h"," "+(t.red_break[5]+t.max_values[5])/2+" km/h"]}],angular.extend(t,{paths:{},bounds:{},maxbounds:{},markers:{ClickedPosition:{lat:-1e3,lng:-1e3,focus:!1,icon:t.markerGreen},HoveredPosition:{lat:-1e3,lng:-1e3,focus:!1,icon:t.markerBlue}},layers:{baselayers:{osm:{name:"OpenStreetMap",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz",layerParams:{minZoom:5}}}},legend:{legendClass:"info legend",position:"bottomright",colors:["#00ff00",t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.yellow_break[0]/2,1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.yellow_break[0],1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],(t.yellow_break[0]+t.red_break[0])/2,1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.red_break[0],1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],(t.red_break[0]+t.max_values[0])/2,1)],labels:["  0 km/h"," "+t.yellow_break[0]/2+" km/h"," "+t.yellow_break[0]+" km/h"," "+(t.yellow_break[0]+t.red_break[0])/2+" km/h"," "+t.red_break[0]+" km/h"," "+(t.red_break[0]+t.max_values[0])/2+" km/h"]},events:{paths:{enable:["click","mouseover"],logic:"emit"}}}),t.$on("toolbar:language-changed",function(e,a){t.data_all[0].key=o.instant("SPEED"),t.data_all[1].key=o.instant("CONSUMPTION"),t.data_all[2].key=o.instant("CO2"),t.data_all[3].key=o.instant("RPM"),t.data_all[4].key=o.instant("ENGINE_LOAD"),t.data_all[5].key=o.instant("GPS_SPEED"),t.dataTrackChart[0]=t.data_all[t.currentPhenomenonIndex],t.segmentActivated?(t.changeSelectionRange(t.slider.minValue,t.slider.maxValue),t.changeChartRange(t.slider.minValue,t.slider.maxValue)):(t.changeSelectionRange(0,t.slider.options.ceil),t.changeChartRange(0,t.slider.options.ceil))}),t.highlightInterval=function(e,a){var n,r;t.segmentActivated?(n=t.slider.minValue,r=t.slider.maxValue):(n=1,r=t.slider.options.ceil),0===n&&(n=1);for(var o=1;o<n;o++)t.paths_all[t.currentPhenomenonIndex]["p"+o].color=h,t.paths_all[t.currentPhenomenonIndex]["p"+o].weight=4;for(var o=n;o<r;o++)if(void 0!==p.data.features[o].properties.phenomenons[t.currentPhenomenon]){var s=p.data.features[o].properties.phenomenons[t.currentPhenomenon].value;s<e||s>a?(t.paths_all[t.currentPhenomenonIndex]["p"+o].color=t.percentToRGB(t.yellow_break[t.currentPhenomenonIndex],t.red_break[t.currentPhenomenonIndex],t.max_values[t.currentPhenomenonIndex],s,t.opacity),t.paths_all[t.currentPhenomenonIndex]["p"+o].weight=5):(t.paths_all[t.currentPhenomenonIndex]["p"+o].color=t.percentToRGB(t.yellow_break[t.currentPhenomenonIndex],t.red_break[t.currentPhenomenonIndex],t.max_values[t.currentPhenomenonIndex],s,1),t.paths_all[t.currentPhenomenonIndex]["p"+o].weight=8)}else t.highlightedInterval?(t.paths_all[t.currentPhenomenonIndex]["p"+o].color=t.errorColorTrans,t.paths_all[t.currentPhenomenonIndex]["p"+o].weight=5):(t.paths_all[t.currentPhenomenonIndex]["p"+o].color=t.errorColor,t.paths_all[t.currentPhenomenonIndex]["p"+o].weight=8);for(var i=p.data.features.length-1,o=r;o<=i;o++)t.paths_all[t.currentPhenomenonIndex]["p"+o].color=h,t.paths_all[t.currentPhenomenonIndex]["p"+o].weight=4};var g=5;t.$on("single_track_page:interval-clicked",function(e,a){var n,o;switch(a){case 0:n=0,o=0;break;case 1:n=0,o=t.yellow_break[t.currentPhenomenonIndex]/2;break;case 2:n=t.yellow_break[t.currentPhenomenonIndex]/2,o=t.yellow_break[t.currentPhenomenonIndex];break;case 3:n=t.yellow_break[t.currentPhenomenonIndex],o=(t.yellow_break[t.currentPhenomenonIndex]+t.red_break[t.currentPhenomenonIndex])/2;break;case 4:n=(t.yellow_break[t.currentPhenomenonIndex]+t.red_break[t.currentPhenomenonIndex])/2,o=t.red_break[t.currentPhenomenonIndex];break;case 5:n=t.red_break[t.currentPhenomenonIndex],o=t.max_values[t.currentPhenomenonIndex]}g===a?(t.highlightedInterval=!t.highlightedInterval,t.highlightedInterval?(t.highlightInterval(n,o),t.intervalStart=n,t.intervalEnd=o):(t.highlightInterval(0,t.max_values[t.currentPhenomenonIndex]),t.intervalStart=0,t.intervalEnd=t.max_values[t.currentPhenomenonIndex])):(t.highlightedInterval=!0,t.highlightInterval(n,o),t.intervalStart=n,t.intervalEnd=o),g=a,r(function(){window.dispatchEvent(new Event("resize"))},1)}),t.$on("leafletDirectivePath.click",function(e,a){t.clickedXPoint=parseInt(a.modelName.substring(1)),t.showMeasurementXInChart(),t.showMeasurementX()}),t.$on("leafletDirectivePath.mouseover",function(e,a){t.hoveredXPoint=parseInt(a.modelName.substring(1)),t.segmentActivated&&(t.hoveredXPoint=t.hoveredXPoint-t.slider.minValue),t.showHoveredPointInChart()}),t.$on("track-toolbar:phenomenon-changed",function(e,a){switch(console.log(a),t.currentPhenomenon=a,t.currentPhenomenon){case"Speed":t.dataTrackChart[0]=t.data_all[0],t.paths=t.paths_all[0],t.legend=legend_all[0],t.currentPhenomenonIndex=0,d.setPhenomenon("Speed",0);break;case"Consumption":t.dataTrackChart[0]=t.data_all[1],t.paths=t.paths_all[1],t.legend=legend_all[1],t.currentPhenomenonIndex=1,d.setPhenomenon("Consumption",1);break;case"CO2":t.paths=t.paths_all[2],t.dataTrackChart[0]=t.data_all[2],t.legend=legend_all[2],t.currentPhenomenonIndex=2,d.setPhenomenon("CO2",2);break;case"Rpm":t.dataTrackChart[0]=t.data_all[3],t.paths=t.paths_all[3],t.legend=legend_all[3],t.currentPhenomenonIndex=3,d.setPhenomenon("Rpm",3);break;case"Engine Load":t.dataTrackChart[0]=t.data_all[4],t.paths=t.paths_all[4],t.legend=legend_all[4],t.currentPhenomenonIndex=4,d.setPhenomenon("Engine Load",4);break;case"GPS Speed":t.dataTrackChart[0]=t.data_all[5],t.paths=t.paths_all[5],t.legend=legend_all[5],t.currentPhenomenonIndex=5,d.setPhenomenon("GPS Speed",5)}g=5,t.highlightedInterval=!1,t.intervalStart=0,t.intervalEnd=t.max_values[t.currentPhenomenonIndex],t.segmentActivated?(t.changeSelectionRange(t.slider.minValue,t.slider.maxValue),t.changeChartRange(t.slider.minValue,t.slider.maxValue)):(t.changeSelectionRange(0,t.slider.options.ceil),t.changeChartRange(0,t.slider.options.ceil)),console.log(t.legend)}),t.clickedXPoint=0,t.hoveredXPoint=0,t.optionsTrackChart={chart:{type:"lineWithFocusChart",height:480,margin:{top:20,right:20,bottom:20,left:40},useInteractiveGuideline:!0,duration:50,xAxis:{axisLabel:"",tickFormat:function(e){return t.timestamps[e]},staggerLabels:!0,showMaxMin:!1},x2Axis:{tickFormat:function(e){return t.timestamps[e]}},yAxis:{axisLabel:"Y Axis",tickFormat:function(e){return 3===t.currentPhenomenonIndex?e.toFixed(0):d3.format(",.2f")(e)},rotateYLabel:!1},y2Axis:{tickFormat:function(e){return 3===t.currentPhenomenonIndex?e.toFixed(0):d3.format(",.2f")(e)}},interactiveLayer:{dispatch:{elementClick:function(e){t.clickedXPoint=Math.round(e.pointXValue),t.showMeasurementX(),t.removeHoveredPointInChart(),t.showMeasurementXInChart()},elementMousemove:function(e){t.hoveredXPoint!==Math.round(e.pointXValue)&&(t.removeHoveredPointInChart(),t.hoveredXPoint=Math.round(e.pointXValue),t.showHoveredX())},elementMouseout:function(e){t.removeHoveredPointInChart(),t.hoveredXPoint=0,t.removeHoverMarker()},onBrush:function(e){console.log(e)}}}}},t.toggleSegmentAnalysis=function(a){t.segmentActivated=!t.segmentActivated,t.segmentActivated?(t.changeSelectionRange(t.slider.minValue,t.slider.maxValue),t.changeChartRange(t.slider.minValue,t.slider.maxValue)):(t.changeSelectionRange(0,t.slider.options.ceil),t.changeChartRange(0,t.slider.options.ceil)),e.$broadcast("single_track_page:segment-activated",t.segmentActivated),r(function(){window.dispatchEvent(new Event("resize"))},50),r(function(){window.dispatchEvent(new Event("resize"))},100)},t.data_all=[{key:o.instant("SPEED"),values:[]},{key:o.instant("CONSUMPTION"),values:[]},{key:o.instant("CO2"),values:[]},{key:o.instant("RPM"),values:[]},{key:o.instant("ENGINE_LOAD"),values:[]},{key:o.instant("GPS_SPEED"),values:[]}],t.paths_all=[{p1:0},{p1:0},{p1:0},{p1:0},{p1:0},{p1:0}],t.dataTrackChart=[{key:"Speed",values:[]}],t.removeCurrentPositionMarker=function(){t.markers.ClickedPosition={lat:-1e3,lng:-1e3,focus:!1,icon:t.markerGreen}},t.removeHoverMarker=function(){t.markers.HoveredPosition={lat:-1e3,lng:-1e3,focus:!1,icon:t.markerBlue},r(function(){window.dispatchEvent(new Event("resize"))},1)},t.lastHoveredXPoint=void 0,t.removeHoveredPointInChart=function(){var e="nv-point-"+t.lastHoveredXPoint,a=document.getElementsByClassName(e);a[0]&&(a[0].style.fillOpacity="0",a[0].style.strokeOpacity="0",a[0].style.stroke="#1A80C1")},t.showHoveredPointInChart=function(){if(t.hoveredXPoint!==t.lastClickedXPoint){if(t.lastHoveredXPoint!==t.lastClickedXPoint){var e="nv-point-"+t.lastHoveredXPoint,a=document.getElementsByClassName(e);a[0]&&(a[0].style.fillOpacity="0",a[0].style.strokeOpacity="0",a[0].style.stroke="#1A80C1")}var e="nv-point-"+t.hoveredXPoint,a=document.getElementsByClassName(e);a[0]&&(a[0].style.fillOpacity="1",a[0].style.strokeWidth="7px",a[0].style.strokeOpacity="1",a[0].style.stroke="#1A80C1"),t.lastHoveredXPoint=t.hoveredXPoint}},t.showHoveredX=function(){if(t.hoveredXPoint>0){var e=p.data.features[t.hoveredXPoint].geometry.coordinates[1],a=p.data.features[t.hoveredXPoint].geometry.coordinates[0];t.markers.HoveredPosition={lat:e,lng:a,focus:!1,icon:t.markerBlue}}r(function(){window.dispatchEvent(new Event("resize"))},1)},t.lastClickedXPoint=void 0,t.showMeasurementXInChart=function(){if(t.lastClickedXPoint){var e="nv-point-"+t.lastClickedXPoint,a=document.getElementsByClassName(e);a[0]&&(a[0].style.fillOpacity="0",a[0].style.strokeOpacity="0",a[0].style.stroke="#1A80C1")}var e="nv-point-"+t.clickedXPoint;t.segmentActivated&&(e="nv-point-"+(t.clickedXPoint-t.slider.minValue));var a=document.getElementsByClassName(e);a[0]&&(a[0].style.fillOpacity="1",a[0].style.strokeWidth="7px",a[0].style.strokeOpacity="1",a[0].style.stroke="#8CBF3F"),
t.lastClickedXPoint=t.clickedXPoint-t.slider.minValue},t.showMeasurementX=function(){t.clickedXPoint>0&&(t.markers.ClickedPosition.lat=p.data.features[t.clickedXPoint].geometry.coordinates[1],t.markers.ClickedPosition.lng=p.data.features[t.clickedXPoint].geometry.coordinates[0]),r(function(){window.dispatchEvent(new Event("resize"))},1)};var p={};t.username=c.getCredentials().username,l.getTrack(t.trackid).then(function(a){p=a,t.slider.maxValue=p.data.features.length-1,t.slider.options.ceil=p.data.features.length-1;var n={};p.data.features[0].properties.phenomenons.Speed&&(n.Speed=!0),p.data.features[0].properties.phenomenons.Consumption&&(n.Consumption=!0),p.data.features[0].properties.phenomenons.CO2&&(n.CO2=!0),p.data.features[0].properties.phenomenons.Rpm&&(n.Rpm=!0),p.data.features[0].properties.phenomenons["Engine Load"]&&(n["Engine Load"]=!0),p.data.features[0].properties.phenomenons["GPS Speed"]&&(n["GPS Speed"]=!0),t.name=a.data.properties.name,t.created=a.data.properties.created;var o,s,i,l,c,d,m={lat:-1e3,lng:1e3},h={lat:1e3,lng:-1e3};t.timestamps=[];for(var g=0;g<p.data.features.length;g++){var _={},v={},f={},k={},E={},b={},T=p.data.features[g].geometry.coordinates[1],y=p.data.features[g].geometry.coordinates[0];m.lat<T&&(m.lat=T),m.lng>y&&(m.lng=y),h.lat>T&&(h.lat=T),h.lng<y&&(h.lng=y),_.weight=8,v.weight=8,f.weight=8,k.weight=8,E.weight=8,b.weight=8,g>0&&(_.latlngs=[{lat:p.data.features[g-1].geometry.coordinates[1],lng:p.data.features[g-1].geometry.coordinates[0]},{lat:T,lng:y}]),v.latlngs=_.latlngs,f.latlngs=_.latlngs,k.latlngs=_.latlngs,E.latlngs=_.latlngs,b.latlngs=_.latlngs;var w=p.data.features[g].properties.time,S=new Date(w).toLocaleTimeString();if(t.timestamps.push(S),p.data.features[g].properties.phenomenons.Speed){var C=p.data.features[g].properties.phenomenons.Speed.value;n.Speed=!0,_.color=t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],C,1),o={x:g,y:p.data.features[g].properties.phenomenons.Speed.value}}else _.color=t.errorColor,o={x:g,y:void 0};if(p.data.features[g].properties.phenomenons.Consumption){var R=p.data.features[g].properties.phenomenons.Consumption.value;n.Consumption=!0,v.color=t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],R,1),s={x:g,y:p.data.features[g].properties.phenomenons.Consumption.value,z:g}}else v.color=t.errorColor,s={x:g,y:void 0,z:g};if(p.data.features[g].properties.phenomenons.CO2){var D=p.data.features[g].properties.phenomenons.CO2.value;n.CO2=!0,f.color=t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],D,1),i={x:g,y:p.data.features[g].properties.phenomenons.CO2.value,z:g}}else f.color=t.errorColor,i={x:g,y:void 0,z:g};if(p.data.features[g].properties.phenomenons.Rpm){var A=p.data.features[g].properties.phenomenons.Rpm.value;n.Rpm=!0,k.color=t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],A,1),l={x:g,y:p.data.features[g].properties.phenomenons.Rpm.value,z:g}}else l={x:g,y:void 0,z:g},k.color=t.errorColor;if(p.data.features[g].properties.phenomenons["Engine Load"]){var I=p.data.features[g].properties.phenomenons["Engine Load"].value;n["Engine Load"]=!0,E.color=t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],I,1),c={x:g,y:p.data.features[g].properties.phenomenons["Engine Load"].value,z:g}}else E.color=t.errorColor,c={x:g,y:void 0,z:g};if(p.data.features[g].properties.phenomenons["GPS Speed"]){var P=p.data.features[g].properties.phenomenons["GPS Speed"].value;n["GPS Speed"]=!0,b.color=t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],P,1),d={x:g,y:p.data.features[g].properties.phenomenons["GPS Speed"].value,z:g}}else b.color=t.errorColor,d={x:g,y:void 0,z:g};g>0&&(t.paths_all[0]["p"+g]=_,t.paths_all[1]["p"+g]=v,t.paths_all[2]["p"+g]=f,t.paths_all[3]["p"+g]=k,t.paths_all[4]["p"+g]=E,t.paths_all[5]["p"+g]=b,t.paths["p"+g]=_),t.data_all[0].values.push(o),t.data_all[1].values.push(s),t.data_all[2].values.push(i),t.data_all[3].values.push(l),t.data_all[4].values.push(c),t.data_all[5].values.push(d)}e.$broadcast("single_track_page:phenomenons-available",n),t.dataTrackChart[0]=t.data_all[0];var O=(m.lat-h.lat)/10,L=(m.lng-h.lng)/10;t.bounds=u.createBoundsFromArray([[m.lat+O,m.lng+L],[h.lat-O,h.lng-L]]);var x=Math.abs(m.lat-h.lat)/2,N=Math.abs(m.lng-h.lng)/2;t.maxBounds=u.createBoundsFromArray([[m.lat+x,m.lng-N],[h.lat-x,h.lng+N]]),t.onload_track_map=!0,t.onload_track_chart=!0,r(function(){window.dispatchEvent(new Event("resize"))},200),r(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log(e)}),t.deleteTrack=function(e){var a=s.confirm().title(o.instant("DIALOG_DELETE_TRACK_TITLE")).textContent(o.instant("DIALOG_DELETE_TRACK_TEXT")).ariaLabel("delete user profile dialog").targetEvent(e).ok(o.instant("DIALOG_DELETE_TRACK_CONFIRM")).cancel(o.instant("DIALOG_DELETE_TRACK_CANCEL"));s.show(a).then(function(){l.deleteTrack(t.username,t.trackid).then(function(e){console.log(e),t.goToDashboard()},function(e){console.log(e)})},function(){})},r(function(){window.dispatchEvent(new Event("resize"))},200),r(function(){window.dispatchEvent(new Event("resize"))},500)}e.$inject=["$rootScope","$scope","$state","$stateParams","$timeout","$translate","$mdDialog","$mdMedia","TrackService","UserCredentialsService","PhenomenonService","leafletBoundsHelpers","trackAnalysisSettings"],angular.module("enviroCar.track").controller("ChartCtrl",e)}(),function(){"use strict";function e(e,t,a,n,r,o,s){"ngInject";e.trackid=t.trackid,e.onload_track_chart=!1,e.currentPhenomenon="Speed",e.currentPhenomenonIndex=0;var i=s.getPhenomenon();e.currentPhenomenon=i.name,e.currentPhenomenonIndex=i.index,e.$on("leafletDirectivePath.click",function(t,a){e.clickedXPoint=parseInt(a.modelName.substring(1)),e.showMeasurementXInChart(),e.showMeasurementX()}),e.$on("leafletDirectivePath.mouseover",function(t,a){e.hoveredXPoint=parseInt(a.modelName.substring(1)),e.showHoveredPointInChart()}),e.$on("track-toolbar:phenomenon-changed",function(t,a){switch(e.currentPhenomenon=a,e.currentPhenomenon){case"Speed":e.dataTrackChart[0]=e.data_all[0],e.paths=e.paths_all[0],e.currentPhenomenonIndex=0;break;case"Consumption":e.dataTrackChart[0]=e.data_all[1],e.paths=e.paths_all[1],e.currentPhenomenonIndex=1;break;case"CO2":e.paths=e.paths_all[2],e.dataTrackChart[0]=e.data_all[2],e.currentPhenomenonIndex=2;break;case"Rpm":e.dataTrackChart[0]=e.data_all[3],e.paths=e.paths_all[3],e.currentPhenomenonIndex=3;break;case"Engine Load":e.dataTrackChart[0]=e.data_all[4],e.paths=e.paths_all[4],e.currentPhenomenonIndex=4;break;case"GPS Speed":e.dataTrackChart[0]=e.data_all[5],e.paths=e.paths_all[5],e.currentPhenomenonIndex=5}}),e.clickedXPoint=0,e.hoveredXPoint=0,e.optionsTrackChart={chart:{type:"lineChart",height:450,margin:{top:20,right:20,bottom:60,left:40},useInteractiveGuideline:!0,duration:50,xAxis:{axisLabel:"",tickFormat:function(t){return e.timestamps[t]}},yAxis:{axisLabel:"Y Axis",tickFormat:function(t){return 3===e.currentPhenomenonIndex?t.toFixed(0):d3.format(",.2f")(t)},rotateYLabel:!1},interactiveLayer:{dispatch:{elementClick:function(t){e.clickedXPoint=Math.round(t.pointXValue),e.showMeasurementX(),e.removeHoveredPointInChart(),e.showMeasurementXInChart()},elementMousemove:function(t){e.hoveredXPoint!==Math.round(t.pointXValue)&&(e.removeHoveredPointInChart(),e.hoveredXPoint=Math.round(t.pointXValue),e.showHoveredX())},elementMouseout:function(t){e.removeHoveredPointInChart(),e.hoveredXPoint=0,e.removeHoverMarker()},onBrush:function(e){console.log(e)}}}}},e.data_all=[{key:n.instant("SPEED"),values:[]},{key:n.instant("CONSUMPTION"),values:[]},{key:n.instant("CO2"),values:[]},{key:n.instant("RPM"),values:[]},{key:n.instant("ENGINE_LOAD"),values:[]},{key:n.instant("GPS_SPEED"),values:[]}];var l;switch(e.currentPhenomenonIndex){case 0:l=n.instant("SPEED");break;case 1:l=n.instant("CONSUMPTION");break;case 2:l=n.instant("CO2");break;case 3:l=n.instant("RPM");break;case 4:l=n.instant("ENGINE_LOAD");break;case 5:l=n.instant("GPS_SPEED")}e.dataTrackChart=[{key:l,values:[]}],e.$on("toolbar:language-changed",function(t,a){e.data_all[0].key=n.instant("SPEED"),e.data_all[1].key=n.instant("CONSUMPTION"),e.data_all[2].key=n.instant("CO2"),e.data_all[3].key=n.instant("RPM"),e.data_all[4].key=n.instant("ENGINE_LOAD"),e.data_all[5].key=n.instant("GPS_SPEED");var r=s.getPhenomenon();e.currentPhenomenon=r.name,e.currentPhenomenonIndex=r.index,e.dataTrackChart[0]=e.data_all[e.currentPhenomenonIndex],e.segmentActivated?(e.changeSelectionRange(e.slider.minValue,e.slider.maxValue),e.changeChartRange(e.slider.minValue,e.slider.maxValue)):(e.changeSelectionRange(0,e.slider.options.ceil),e.changeChartRange(0,e.slider.options.ceil))}),e.removeCurrentPositionMarker=function(){e.markers.ClickedPosition={lat:-1e3,lng:-1e3,focus:!1,icon:e.markerGreen}},e.removeHoverMarker=function(){e.markers.HoveredPosition={lat:-1e3,lng:-1e3,focus:!1,icon:e.markerBlue},a(function(){window.dispatchEvent(new Event("resize"))},1)},e.showHoveredPointInChart=function(){if(e.hoveredXPoint!==e.lastClickedXPoint){if(e.lastHoveredXPoint!==e.lastClickedXPoint){var t="nv-point-"+e.lastHoveredXPoint,a=document.getElementsByClassName(t);a[0]&&(a[0].style.fillOpacity="0",a[0].style.strokeOpacity="0",a[0].style.stroke="#1A80C1")}var t="nv-point-"+e.hoveredXPoint,a=document.getElementsByClassName(t);a[0]&&(a[0].style.fillOpacity="1",a[0].style.strokeWidth="7px",a[0].style.strokeOpacity="1",a[0].style.stroke="#1A80C1"),e.lastHoveredXPoint=e.hoveredXPoint}},e.showHoveredX=function(){if(e.hoveredXPoint>0){var t=c.data.features[e.hoveredXPoint].geometry.coordinates[1],n=c.data.features[e.hoveredXPoint].geometry.coordinates[0];e.markers.HoveredPosition={lat:t,lng:n,focus:!1,icon:e.markerBlue}}a(function(){window.dispatchEvent(new Event("resize"))},1)},e.showMeasurementXInChart=function(){if(e.lastClickedXPoint){var t="nv-point-"+e.lastClickedXPoint,a=document.getElementsByClassName(t);a[0]&&(a[0].style.fillOpacity="0",a[0].style.strokeOpacity="0",a[0].style.stroke="#1A80C1")}var t="nv-point-"+e.clickedXPoint;e.segmentActivated&&(t="nv-point-"+e.clickedXPoint);var a=document.getElementsByClassName(t);a[0]&&(a[0].style.fillOpacity="1",a[0].style.strokeWidth="7px",a[0].style.strokeOpacity="1",a[0].style.stroke="#8CBF3F"),e.lastClickedXPoint=e.clickedXPoint},e.lastHoveredXPoint=void 0,e.removeHoveredPointInChart=function(){var t="nv-point-"+e.lastHoveredXPoint,a=document.getElementsByClassName(t);a[0]&&(a[0].style.fillOpacity="0",a[0].style.strokeOpacity="0",a[0].style.stroke="#1A80C1")},e.showMeasurementX=function(){e.clickedXPoint>0&&(e.markers.ClickedPosition.lat=c.data.features[e.clickedXPoint].geometry.coordinates[1],e.markers.ClickedPosition.lng=c.data.features[e.clickedXPoint].geometry.coordinates[0]),a(function(){window.dispatchEvent(new Event("resize"))},1)};var c={};r.getTrack(e.trackid).then(function(t){c=t,e.name=t.data.properties.name,e.created=t.data.properties.created;for(var n,r,o,i,l,d,u=0;u<c.data.features.length;u++)n=c.data.features[u].properties.phenomenons.Speed?{x:u,y:c.data.features[u].properties.phenomenons.Speed.value}:{x:u,y:void 0},r=c.data.features[u].properties.phenomenons.Consumption?{x:u,y:c.data.features[u].properties.phenomenons.Consumption.value}:{x:u,y:void 0},o=c.data.features[u].properties.phenomenons.CO2?{x:u,y:c.data.features[u].properties.phenomenons.CO2.value}:{x:u,y:void 0},i=c.data.features[u].properties.phenomenons.Rpm?{x:u,y:c.data.features[u].properties.phenomenons.Rpm.value}:{x:u,y:void 0},l=c.data.features[u].properties.phenomenons["Engine Load"]?{x:u,y:c.data.features[u].properties.phenomenons["Engine Load"].value}:{x:u,y:void 0},d=c.data.features[u].properties.phenomenons["GPS Speed"]?{x:u,y:c.data.features[u].properties.phenomenons["GPS Speed"].value}:{x:u,y:void 0},e.data_all[0].values.push(n),e.data_all[1].values.push(r),e.data_all[2].values.push(o),e.data_all[3].values.push(i),e.data_all[4].values.push(l),e.data_all[5].values.push(d);var m=s.getPhenomenon();e.currentPhenomenon=m.name,e.currentPhenomenonIndex=m.index,e.dataTrackChart[0]=e.data_all[e.currentPhenomenonIndex],e.onload_track_map=!0,e.onload_track_chart=!0,a(function(){window.dispatchEvent(new Event("resize"))},200),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log(e)}),a(function(){window.dispatchEvent(new Event("resize"))},200),a(function(){window.dispatchEvent(new Event("resize"))},500)}e.$inject=["$scope","$stateParams","$timeout","$translate","TrackService","UserCredentialsService","PhenomenonService"],angular.module("enviroCar").controller("LineChartWithoutFocusCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/track_analysis/line_chart/line_chart_without_focus.directive.html",controller:"LineChartWithoutFocusCtrl",controllerAs:"vm"}}angular.module("enviroCar").directive("lineChartWithoutFocus",e)}(),function(){"use strict";function e(e,t,a,n,r,o){"ngInject";t.onload_all=!1,t.onload_speed_Range=!1,t.onload_consumption_Range=!1,t.onload_CO2_Range=!1,t.onload_EngineLoad_Range=!1,t.onload_RPM_Range=!1,t.onload_GPSSpeed_Range=!1,t.loading=!0,t.selectedPhenom="Speed",t.trackid=a.trackid,t.mouseEntered=!1,t.optionsSpeedRange={chart:{type:"pieChart",height:370,donut:!1,growOnHover:!0,x:function(e){return e.key},y:function(e){return e.y},color:["#00ff00",t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.yellow_break[0]/2,1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.yellow_break[0],1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],(t.yellow_break[0]+t.red_break[0])/2,1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],t.red_break[0],1),t.percentToRGB(t.yellow_break[0],t.red_break[0],t.max_values[0],(t.red_break[0]+t.max_values[0])/2,1)],showLabels:!0,labelsOutside:!0,pie:{startAngle:function(e){return e.startAngle/2-Math.PI/2},endAngle:function(e){return e.endAngle/2-Math.PI/2},dispatch:{elementClick:function(t){e.$broadcast("single_track_page:interval-clicked",t.index)}}},duration:300,legendPosition:"bottom",valueFormat:function(e){return d3.format(",.2f")(e)+"%"}}},t.changeRangeRanges=function(e,a){t.onload_speed_Range=!1,t.onload_consumption_Range=!1,t.onload_CO2_Range=!1,t.onload_EngineLoad_Range=!1,t.onload_RPM_Range=!1,t.onload_GPSSpeed_Range=!1,t.dataSpeedRange=[{key:"  0 km/h",y:0},{key:"0-"+t.yellow_break[0]/2+" km/h",y:0},{key:t.yellow_break[0]/2+"-"+t.yellow_break[0]+" km/h",y:0},{key:t.yellow_break[0]+"-"+(t.yellow_break[0]+t.red_break[0])/2+" km/h",y:0},{key:(t.yellow_break[0]+t.red_break[0])/2+"-"+t.red_break[0]+" km/h",y:0},{key:"> "+t.red_break[0]+" km/h",y:0}],t.dataConsumptionRange=[{key:"  0 l/h",y:0},{key:"0-"+t.yellow_break[1]/2+" l/h",y:0},{key:t.yellow_break[1]/2+"-"+t.yellow_break[1]+" l/h",y:0},{key:t.yellow_break[1]+"-"+(t.yellow_break[1]+t.red_break[1])/2+" l/h",y:0},{key:(t.yellow_break[1]+t.red_break[1])/2+"-"+t.red_break[1]+" l/h",y:0},{key:"> "+t.red_break[1]+" l/h",y:0}],t.dataCO2Range=[{key:"  0 kg/h",y:0},{key:"0-"+t.yellow_break[2]/2+" kg/h",y:0},{key:t.yellow_break[2]/2+"-"+t.yellow_break[2]+" kg/h",y:0},{key:t.yellow_break[2]+"-"+(t.yellow_break[2]+t.red_break[2])/2+" kg/h",y:0},{key:(t.yellow_break[2]+t.red_break[2])/2+"-"+t.red_break[2]+" kg/h",y:0},{key:"> "+t.red_break[2]+" kg/h",y:0}],t.dataRPMRange=[{key:"  0 r/min",y:0},{key:"0-"+t.yellow_break[3]/2+" r/min",y:0},{key:t.yellow_break[3]/2+"-"+t.yellow_break[3]+" r/min",y:0},{key:t.yellow_break[3]+"-"+(t.yellow_break[3]+t.red_break[3])/2+" r/min",y:0},{key:(t.yellow_break[3]+t.red_break[3])/2+"-"+t.red_break[3]+" r/min",y:0},{key:"> "+t.red_break[3]+" r/min",y:0}],t.dataEngineLoadRange=[{key:"  0 %",y:0},{key:"0-"+t.yellow_break[4]/2+" %",y:0},{key:t.yellow_break[4]/2+"-"+t.yellow_break[4]+" %",y:0},{key:t.yellow_break[4]+"-"+(t.yellow_break[4]+t.red_break[4])/2+" %",y:0},{key:(t.yellow_break[4]+t.red_break[4])/2+"-"+t.red_break[4]+" %",y:0},{key:"> "+t.red_break[4]+" %",y:0}],t.dataGPSSpeedRange=[{key:"  0 km/h",y:0},{key:"0-"+t.yellow_break[5]/2+" km/h",y:0},{key:t.yellow_break[5]/2+"-"+t.yellow_break[5]+" km/h",y:0},{key:t.yellow_break[5]+"-"+(t.yellow_break[5]+t.red_break[5])/2+" km/h",y:0},{key:(t.yellow_break[5]+t.red_break[5])/2+"-"+t.red_break[5]+" km/h",y:0},{key:"> "+t.red_break[5]+" km/h",y:0}];for(var n=0,r=e;r<a+1;r++)void 0!==t.data_all_ranges[0].values[r]&&n++;for(var o=100/n,r=e;r<a+1;r++){var s=t.data_all_ranges[0].values[r];switch(!0){case 0===s:t.dataSpeedRange[0].y+=o;break;case s<t.yellow_break[0]/2:t.dataSpeedRange[1].y+=o;break;case s<t.yellow_break[0]:t.dataSpeedRange[2].y+=o;break;case s<(t.yellow_break[0]+t.red_break[0])/2:t.dataSpeedRange[3].y+=o;break;case s<t.red_break[0]:t.dataSpeedRange[4].y+=o;break;case s>=t.red_break[0]:t.dataSpeedRange[5].y+=o}}t.onload_speed_Range=!0;for(var r=e;r<a+1;r++){var s=t.data_all_ranges[1].values[r];switch(!0){case 0===s:t.dataConsumptionRange[0].y+=o;break;case s<t.yellow_break[1]/2:t.dataConsumptionRange[1].y+=o;break;case s<t.yellow_break[1]:t.dataConsumptionRange[2].y+=o;break;case s<(t.yellow_break[1]+t.red_break[1])/2:t.dataConsumptionRange[3].y+=o;break;case s<t.red_break[1]:t.dataConsumptionRange[4].y+=o;break;case s>=t.red_break[1]:t.dataConsumptionRange[5].y+=o}}t.onload_consumption_Range=!0;for(var r=e;r<a+1;r++){var s=t.data_all_ranges[2].values[r];switch(!0){case 0===s:t.dataCO2Range[0].y+=o;break;case s<t.yellow_break[2]/2:t.dataCO2Range[1].y+=o;break;case s<t.yellow_break[2]:t.dataCO2Range[2].y+=o;break;case s<(t.yellow_break[2]+t.red_break[2])/2:t.dataCO2Range[3].y+=o;break;case s<t.red_break[2]:t.dataCO2Range[4].y+=o;break;case s>=t.red_break[2]:t.dataCO2Range[5].y+=o}}t.onload_CO2_Range=!0;for(var r=e;r<a+1;r++){var s=t.data_all_ranges[3].values[r];switch(!0){case 0===s:t.dataRPMRange[0].y+=o;break;case s<t.yellow_break[3]/2:t.dataRPMRange[1].y+=o;break;case s<t.yellow_break[3]:t.dataRPMRange[2].y+=o;break;case s<(t.yellow_break[3]+t.red_break[3])/2:t.dataRPMRange[3].y+=o;break;case s<t.red_break[3]:t.dataRPMRange[4].y+=o;break;case s>=t.red_break[3]:t.dataRPMRange[5].y+=o}}t.onload_RPM_Range=!0;for(var r=e;r<a+1;r++){var s=t.data_all_ranges[4].values[r];switch(!0){case 0===s:t.dataEngineLoadRange[0].y+=o;break;case s<t.yellow_break[4]/2:t.dataEngineLoadRange[1].y+=o;break;case s<t.yellow_break[4]:t.dataEngineLoadRange[2].y+=o;break;case s<(t.yellow_break[4]+t.red_break[4])/2:t.dataEngineLoadRange[3].y+=o;break;case s<t.red_break[4]:t.dataEngineLoadRange[4].y+=o;break;case s>=t.red_break[4]:t.dataEngineLoadRange[5].y+=o}}t.onload_EngineLoad_Range=!0;for(var r=e;r<a+1;r++){var s=t.data_all_ranges[5].values[r];switch(!0){case 0===s:t.dataGPSSpeedRange[0].y+=o;break;case s<t.yellow_break[5]/2:t.dataGPSSpeedRange[1].y+=o;break;case s<t.yellow_break[5]:t.dataGPSSpeedRange[2].y+=o;break;case s<(t.yellow_break[5]+t.red_break[5])/2:t.dataGPSSpeedRange[3].y+=o;break;case s<t.red_break[5]:t.dataGPSSpeedRange[4].y+=o;break;case s>=t.red_break[5]:t.dataGPSSpeedRange[5].y+=o}}t.onload_GPSSpeed_Range=!0},t.$on("single_track_page:segment-changed",function(e,a){t.min=a.min,t.max=a.max,t.changeRangeRanges(t.min,t.max)}),t.$on("toolbar:language-changed",function(e,t){}),t.$on("single_track_page:segment-activated",function(e,a){a?(t.min||(t.min=0),t.max||(t.max=t.track_length),t.changeRangeRanges(t.min,t.max)):t.changeRangeRanges(0,t.track_length)}),t.$on("track-toolbar:phenomenon-changed",function(e,a){t.selectedPhenom=a,t.segmentActivated&&void 0!==t.min?t.changeRangeRanges(t.min,t.max):t.changeRangeRanges(0,t.track_length)}),t.optionsConsumptionRange={chart:{type:"pieChart",height:370,donut:!1,x:function(e){return e.key},color:["#00ff00",t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],t.yellow_break[1]/2,1),t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],t.yellow_break[1],1),t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],(t.yellow_break[1]+t.red_break[1])/2,1),t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],t.red_break[1],1),t.percentToRGB(t.yellow_break[1],t.red_break[1],t.max_values[1],(t.red_break[1]+t.max_values[1])/2,1)],showLabels:!0,labelsOutside:!0,pie:{startAngle:function(e){return e.startAngle/2-Math.PI/2},endAngle:function(e){return e.endAngle/2-Math.PI/2},dispatch:{elementClick:function(t){e.$broadcast("single_track_page:interval-clicked",t.index),console.log(t)}}},duration:300,legendPosition:"bottom",valueFormat:function(e){return d3.format(",.2f")(e)+"%"}}},t.optionsCO2Range={chart:{type:"pieChart",height:370,donut:!1,x:function(e){return e.key},color:["#00ff00",t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],t.yellow_break[2]/2,1),t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],t.yellow_break[2],1),t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],(t.yellow_break[2]+t.red_break[2])/2,1),t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],t.red_break[2],1),t.percentToRGB(t.yellow_break[2],t.red_break[2],t.max_values[2],(t.red_break[2]+t.max_values[2])/2,1)],showLabels:!0,labelsOutside:!0,pie:{startAngle:function(e){return e.startAngle/2-Math.PI/2},endAngle:function(e){return e.endAngle/2-Math.PI/2},dispatch:{elementClick:function(t){e.$broadcast("single_track_page:interval-clicked",t.index),console.log(t)}}},duration:300,legendPosition:"bottom",valueFormat:function(e){return d3.format(",.2f")(e)+"%"}}},t.optionsEngineRange={chart:{type:"pieChart",height:370,donut:!1,x:function(e){return e.key},color:["#00ff00",t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],t.yellow_break[4]/2,1),t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],t.yellow_break[4],1),t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],(t.yellow_break[4]+t.red_break[4])/2,1),t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],t.red_break[4],1),t.percentToRGB(t.yellow_break[4],t.red_break[4],t.max_values[4],(t.red_break[4]+t.max_values[4])/2,1)],showLabels:!0,labelsOutside:!0,pie:{startAngle:function(e){return e.startAngle/2-Math.PI/2},endAngle:function(e){return e.endAngle/2-Math.PI/2},dispatch:{elementClick:function(t){e.$broadcast("single_track_page:interval-clicked",t.index),console.log(t)}}},duration:300,legendPosition:"bottom",valueFormat:function(e){return d3.format(",.2f")(e)+"%"}}},t.optionsRPMRange={chart:{type:"pieChart",height:370,donut:!1,x:function(e){return e.key},color:["#00ff00",t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],t.yellow_break[3]/2,1),t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],t.yellow_break[3],1),t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],(t.yellow_break[3]+t.red_break[3])/2,1),t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],t.red_break[3],1),t.percentToRGB(t.yellow_break[3],t.red_break[3],t.max_values[3],(t.red_break[3]+t.max_values[3])/2,1)],showLabels:!0,labelsOutside:!0,pie:{startAngle:function(e){return e.startAngle/2-Math.PI/2},endAngle:function(e){return e.endAngle/2-Math.PI/2},dispatch:{elementClick:function(t){e.$broadcast("single_track_page:interval-clicked",t.index),console.log(t)}}},duration:300,legendPosition:"bottom",valueFormat:function(e){return d3.format(",.2f")(e)+"%"}}},t.optionsGPSSpeedRange={chart:{type:"pieChart",height:370,donut:!1,x:function(e){return e.key},color:["#00ff00",t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],t.yellow_break[5]/2,1),t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],t.yellow_break[5],1),t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],(t.yellow_break[5]+t.red_break[5])/2,1),t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],t.red_break[5],1),t.percentToRGB(t.yellow_break[5],t.red_break[5],t.max_values[5],(t.red_break[5]+t.max_values[5])/2,1)],showLabels:!0,labelsOutside:!0,pie:{startAngle:function(e){return e.startAngle/2-Math.PI/2},endAngle:function(e){return e.endAngle/2-Math.PI/2},dispatch:{elementClick:function(t){e.$broadcast("single_track_page:interval-clicked",t.index),console.log(t)}}},duration:300,legendPosition:"bottom",valueFormat:function(e){return d3.format(",.2f")(e)+"%"}}},t.dataSpeedRange=[{key:"  0 km/h",y:0},{key:"0-"+t.yellow_break[0]/2+" km/h",y:0},{key:t.yellow_break[0]/2+"-"+t.yellow_break[0]+" km/h",y:0},{key:t.yellow_break[0]+"-"+(t.yellow_break[0]+t.red_break[0])/2+" km/h",y:0},{key:(t.yellow_break[0]+t.red_break[0])/2+"-"+t.red_break[0]+" km/h",y:0},{key:"> "+t.red_break[0]+" km/h",y:0}],t.dataConsumptionRange=[{key:"  0 l/h",y:0},{key:"0-"+t.yellow_break[1]/2+" l/h",y:0},{key:t.yellow_break[1]/2+"-"+t.yellow_break[1]+" l/h",y:0},{key:t.yellow_break[1]+"-"+(t.yellow_break[1]+t.red_break[1])/2+" l/h",y:0},{key:(t.yellow_break[1]+t.red_break[1])/2+"-"+t.red_break[1]+" l/h",y:0},{key:"> "+t.red_break[1]+" l/h",y:0}],t.dataCO2Range=[{key:"  0 kg/h",y:0},{key:"0-"+t.yellow_break[2]/2+" kg/h",y:0},{key:t.yellow_break[2]/2+"-"+t.yellow_break[2]+" kg/h",y:0},{key:t.yellow_break[2]+"-"+(t.yellow_break[2]+t.red_break[2])/2+" kg/h",y:0},{key:(t.yellow_break[2]+t.red_break[2])/2+"-"+t.red_break[2]+" kg/h",y:0},{key:"> "+t.red_break[2]+" kg/h",y:0}],t.dataRPMRange=[{key:"  0 r/min",y:0},{key:"0-"+t.yellow_break[3]/2+" r/min",y:0},{key:t.yellow_break[3]/2+"-"+t.yellow_break[3]+" r/min",y:0},{key:t.yellow_break[3]+"-"+(t.yellow_break[3]+t.red_break[3])/2+" r/min",y:0},{key:(t.yellow_break[3]+t.red_break[3])/2+"-"+t.red_break[3]+" r/min",y:0},{key:"> "+t.red_break[3]+" r/min",y:0}],t.dataEngineLoadRange=[{key:"  0 %",y:0},{key:"0-"+t.yellow_break[4]/2+" %",y:0},{key:t.yellow_break[4]/2+"-"+t.yellow_break[4]+" %",y:0},{key:t.yellow_break[4]+"-"+(t.yellow_break[4]+t.red_break[4])/2+" %",y:0},{key:(t.yellow_break[4]+t.red_break[4])/2+"-"+t.red_break[4]+" %",y:0},{key:"> "+t.red_break[4]+" %",y:0}],t.dataGPSSpeedRange=[{key:"  0 %",y:0},{key:"0-"+t.yellow_break[5]/2+" %",y:0},{key:t.yellow_break[5]/2+"-"+t.yellow_break[5]+" %",y:0},{key:t.yellow_break[5]+"-"+(t.yellow_break[5]+t.red_break[5])/2+" %",y:0},{key:(t.yellow_break[5]+t.red_break[5])/2+"-"+t.red_break[5]+" %",y:0},{key:"> "+t.red_break[5]+" %",y:0}],t.data_all_ranges=[{key:"Speed",values:[]},{key:"Consumption",values:[]},{key:"CO2",values:[]},{key:"Rpm",values:[]},{key:"Engine Load",values:[]},{key:"GPS Speed",values:[]}];var s={};r.getTrack(t.trackid).then(function(e){s=e;var a=s.data.features.length;t.track_length=a;for(var r=0;r<a;r++){if(s.data.features[r].properties.phenomenons.Speed)var o=s.data.features[r].properties.phenomenons.Speed.value;if(s.data.features[r].properties.phenomenons.Consumption)var i=s.data.features[r].properties.phenomenons.Consumption.value;if(s.data.features[r].properties.phenomenons.CO2)var l=s.data.features[r].properties.phenomenons.CO2.value;if(s.data.features[r].properties.phenomenons.Rpm)var c=s.data.features[r].properties.phenomenons.Rpm.value;if(s.data.features[r].properties.phenomenons["Engine Load"])var d=s.data.features[r].properties.phenomenons["Engine Load"].value;if(s.data.features[r].properties.phenomenons["GPS Speed"])var u=s.data.features[r].properties.phenomenons["GPS Speed"].value;t.data_all_ranges[0].values.push(o),t.data_all_ranges[1].values.push(i),t.data_all_ranges[2].values.push(l),t.data_all_ranges[3].values.push(c),t.data_all_ranges[4].values.push(d),t.data_all_ranges[5].values.push(u)}for(var m=100/t.track_length,h=0;h<t.track_length;h++){var g=t.data_all_ranges[0].values[h];switch(!0){case 0===g:t.dataSpeedRange[0].y+=m;break;case g<t.yellow_break[0]/2:t.dataSpeedRange[1].y+=m;break;case g<t.yellow_break[0]:t.dataSpeedRange[2].y+=m;break;case g<(t.yellow_break[0]+t.red_break[0])/2:t.dataSpeedRange[3].y+=m;break;case g<t.red_break[0]:t.dataSpeedRange[4].y+=m;break;case g>=t.red_break[0]:t.dataSpeedRange[5].y+=m}}t.onload_speed_Range=!0;for(var h=0;h<t.track_length;h++){var g=t.data_all_ranges[1].values[h];switch(!0){case 0===g:t.dataConsumptionRange[0].y+=m;break;case g<t.yellow_break[1]/2:t.dataConsumptionRange[1].y+=m;break;case g<t.yellow_break[1]:t.dataConsumptionRange[2].y+=m;break;case g<(t.yellow_break[1]+t.red_break[1])/2:t.dataConsumptionRange[3].y+=m;break;case g<t.red_break[1]:t.dataConsumptionRange[4].y+=m;break;case g>=t.red_break[1]:t.dataConsumptionRange[5].y+=m}}t.onload_consumption_Range=!0;for(var h=0;h<t.track_length;h++){var g=t.data_all_ranges[2].values[h];switch(!0){case 0===g:t.dataCO2Range[0].y+=m;break;case g<t.yellow_break[2]/2:t.dataCO2Range[1].y+=m;break;case g<t.yellow_break[2]:t.dataCO2Range[2].y+=m;break;case g<(t.yellow_break[2]+t.red_break[2])/2:t.dataCO2Range[3].y+=m;break;case g<t.red_break[2]:t.dataCO2Range[4].y+=m;break;case g>=t.red_break[2]:t.dataCO2Range[5].y+=m}}t.onload_CO2_Range=!0;for(var h=0;h<t.track_length;h++){var g=t.data_all_ranges[3].values[h];switch(!0){case 0===g:t.dataRPMRange[0].y+=m;break;case g<t.yellow_break[3]/2:t.dataRPMRange[1].y+=m;break;case g<t.yellow_break[3]:t.dataRPMRange[2].y+=m;break;case g<(t.yellow_break[3]+t.red_break[3])/2:t.dataRPMRange[3].y+=m;break;case g<t.red_break[3]:t.dataRPMRange[4].y+=m;break;case g>=t.red_break[3]:t.dataRPMRange[5].y+=m}}t.onload_RPM_Range=!0;for(var h=0;h<t.track_length;h++){var g=t.data_all_ranges[4].values[h];switch(!0){case 0===g:t.dataEngineLoadRange[0].y+=m;break;case g<t.yellow_break[4]/2:t.dataEngineLoadRange[1].y+=m;break;case g<t.yellow_break[4]:t.dataEngineLoadRange[2].y+=m;break;case g<(t.yellow_break[4]+t.red_break[4])/2:t.dataEngineLoadRange[3].y+=m;break;case g<t.red_break[4]:t.dataEngineLoadRange[4].y+=m;break;case g>=t.red_break[4]:t.dataEngineLoadRange[5].y+=m}}t.onload_EngineLoad_Range=!0;for(var h=0;h<t.track_length;h++){var g=t.data_all_ranges[5].values[h];switch(!0){case 0===g:t.dataGPSSpeedRange[0].y+=m;break;case g<t.yellow_break[5]/2:t.dataGPSSpeedRange[1].y+=m;break;case g<t.yellow_break[5]:t.dataGPSSpeedRange[2].y+=m;break;case g<(t.yellow_break[5]+t.red_break[5])/2:t.dataGPSSpeedRange[3].y+=m;break;case g<t.red_break[5]:t.dataGPSSpeedRange[4].y+=m;break;case g>=t.red_break[5]:t.dataGPSSpeedRange[5].y+=m}}t.onload_GPSSpeed_Range=!0,n(function(){window.dispatchEvent(new Event("resize"))},200),n(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log(e)}),n(function(){window.dispatchEvent(new Event("resize"))},300),n(function(){window.dispatchEvent(new Event("resize"))},500)}e.$inject=["$rootScope","$scope","$stateParams","$timeout","TrackService","UserCredentialsService"],angular.module("enviroCar").controller("SpeedRangesChartCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/track_analysis/speed_ranges_chart/speed_ranges_chart.directive.html",controller:"SpeedRangesChartCtrl"}}angular.module("enviroCar").directive("speedRangesChart",e)}(),function(){"use strict";function e(){"ngInject";console.log("PhenomenonService started.");var e={name:"Speed",index:0};this.setPhenomenon=function(t,a){e.name=t,e.index=a},this.getPhenomenon=function(){return e},this.resetPhenomenon=function(){e.name="",e.index=0}}angular.module("enviroCar.track").service("PhenomenonService",e)}(),function(){"use strict";function e(e,t,a){"ngInject";e.onload_summary=!1,e.consumption_available=!1,e.co2_available=!1,e.trackid=t.trackid;var n,r,o,s,i,l,c=0,d=0;e.track_summary_track_length=0,e.data_track=[{key:"Consumption",values:[]},{key:"CO2",values:[]},{key:"Timestamp",values:[]},{key:"Lat",values:[]},{key:"Lng",values:[]},{key:"Speed",values:[]}],e.distancecalculator=function(e,t,a,n){var r=.017453292519943295,o=Math.cos,s=.5-o((a-e)*r)/2+o(e*r)*o(a*r)*(1-o((n-t)*r))/2;return 12742*Math.asin(Math.sqrt(s))},e.changeSummaryRange=function(t,a){for(var u={distance:0,fuel:0,co2:0,speed:0},m=t+1;m<=a+1;m++){var h=e.data_track[3].values[m],g=e.data_track[4].values[m],p=e.data_track[3].values[m-1],_=e.data_track[4].values[m-1],v=e.distancecalculator(g,h,_,p);u.distance+=v;var f=e.data_track[0].values[m-1];u.fuel+=f;var k=e.data_track[1].values[m-1];u.co2+=k;var E=e.data_track[5].values[m-1];u.speed+=E
}var f=e.data_track[0].values[a-1];u.fuel+=f;var k=e.data_track[1].values[a-1];u.co2+=k;var E=e.data_track[5].values[a-1];u.speed+=E,c=u.distance;var b=e.data_track[2].values[t],T=e.data_track[2].values[a+1],y=new Date(T).getTime()-new Date(b).getTime(),w=y/1e3,S=new Date(null);S.setSeconds(w),l=S.toISOString().substr(11,8),s=b,i=T;var C=u.fuel/(a-t),R=C*(y/36e5),D=100*R/c,A=u.co2/(a-t),I=A*(y/36e5),P=100*I/c,O=D*c/100,L=P*c/100;d=0;for(var x=!1,N=t;N<a;N++){var M=e.data_track[5].values[N];x?M>0&&(x=!1,d++):0===M&&(x=!0)}for(var F=0,U=0,N=t;N<a;N++){var M=e.data_track[5].values[N];U>0?M>5?U=0:3===++U&&F++:M<=5&&U++}e.tracksummary={distance:c.toFixed(2),vehiclemodel:n,vehicletype:r,vehiclemanufacturer:o,unitsspeed:"km/h",timeoftravel:l,unitsofdistance:"km",unitsoftime:"Minutes",fuel:D.toFixed(2),fuelConsumed:O.toFixed(2),co2emissionperhour:P.toFixed(2),co2emissionperhourConsumed:L.toFixed(2),starttime:new Date(s).toLocaleString(),endtime:new Date(i).toLocaleString(),stops:d},isNaN(D)?e.consumption_available=!1:e.consumption_available=!0,isNaN(P)?e.co2_available=!1:e.co2_available=!0},e.$on("single_track_page:segment-changed",function(t,a){e.track_summary_startIndex=a.min,e.track_summary_endIndex=a.max,e.changeSummaryRange(e.track_summary_startIndex,e.track_summary_endIndex-1)}),e.$on("single_track_page:segment-activated",function(t,a){a?(e.track_summary_startIndex||(e.track_summary_startIndex=0),e.track_summary_endIndex||(e.track_summary_endIndex=e.track_summary_track_length),e.changeSummaryRange(e.track_summary_startIndex,e.track_summary_endIndex-1)):e.changeSummaryRange(0,e.track_summary_track_length-1)}),a.getTrack(e.trackid).then(function(t){var a=t,u=t.data,m=u.properties.sensor.properties;n=m.model,o=m.manufacturer,r=m.fuelType;var h={};a.data.features[0].properties.phenomenons.Consumption&&(h.Consumption=!0),a.data.features[0].properties.phenomenons.CO2&&(h.CO2=!0),e.track_summary_track_length=a.data.features.length-1;for(var g=0;g<=e.track_summary_track_length;g++){if(a.data.features[g].properties.phenomenons.Consumption){var p=a.data.features[g].properties.phenomenons.Consumption.value;e.data_track[0].values.push(p)}else e.data_track[0].values.push(void 0);if(a.data.features[g].properties.phenomenons.CO2){var _=a.data.features[g].properties.phenomenons.CO2.value;e.data_track[1].values.push(_)}else e.data_track[1].values.push(void 0);var v=a.data.features[g].geometry.coordinates[0],f=a.data.features[g].geometry.coordinates[1],k=a.data.features[g].properties.time;e.data_track[2].values.push(k),e.data_track[3].values.push(v),e.data_track[4].values.push(f)}for(var E={distance:0,fuel:0,co2:0},g=1;g<e.track_summary_track_length;g++){var b=e.data_track[3].values[g],T=e.data_track[4].values[g],y=e.data_track[3].values[g-1],w=e.data_track[4].values[g-1],S=e.distancecalculator(T,b,w,y);if(E.distance+=S,void 0!==e.data_track[0].values[g-1]){var C=e.data_track[0].values[g-1];E.fuel+=C}if(void 0!==e.data_track[1].values[g-1]){var R=e.data_track[1].values[g-1];E.co2+=R}}var C=e.data_track[0].values[e.track_summary_track_length-1];E.fuel+=C;var R=e.data_track[1].values[e.track_summary_track_length-1];E.co2+=R,c=E.distance;var D=e.data_track[2].values[0],A=e.data_track[2].values[e.track_summary_track_length-1],I=new Date(A).getTime()-new Date(D).getTime(),P=I/1e3,O=new Date(null);O.setSeconds(P),l=O.toISOString().substr(11,8),s=D,i=A;var L=E.fuel/(e.track_summary_track_length-0),x=L*(I/36e5),N=100*x/c,M=N*c/100,F=E.co2/(e.track_summary_track_length-0),U=F*(I/36e5),G=100*U/c,B=G*c/100;d=0;for(var z=!1,$=0;$<e.track_summary_track_length;$++)if(void 0!==a.data.features[$].properties.phenomenons.Speed){var H=a.data.features[$].properties.phenomenons.Speed.value;z?H>0&&(z=!1,d++):0===H&&(z=!0),e.data_track[5].values.push(H)}else e.data_track[5].values.push(void 0);for(var Y=0,V=0,$=0;$<e.track_summary_track_length;$++)if(void 0!==a.data.features[$].properties.phenomenons.Speed){var H=a.data.features[$].properties.phenomenons.Speed.value;V>0?H>5?V=0:3===++V&&Y++:H<=5&&V++}e.tracksummary={distance:c.toFixed(2),vehiclemodel:n,vehicletype:r,vehiclemanufacturer:o,unitsspeed:"km/h",timeoftravel:l,unitsofdistance:"km",unitsoftime:"Minutes",fuel:N.toFixed(2),fuelConsumed:M.toFixed(2),co2emissionperhour:G.toFixed(2),co2emissionperhourConsumed:B.toFixed(2),starttime:new Date(s).toLocaleString(),endtime:new Date(i).toLocaleString(),stops:d},isNaN(N)?e.consumption_available=!1:e.consumption_available=!0,isNaN(G)?e.co2_available=!1:e.co2_available=!0,e.onload_summary=!0},function(e){console.log(e)})}e.$inject=["$scope","$stateParams","TrackService"],angular.module("enviroCar").controller("TrackSummaryCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",templateUrl:"./app/components/track_analysis/track_summary/tracksummary.directive.html",controller:"TrackSummaryCtrl"}}angular.module("enviroCar").directive("trackSummary",e)}(),function(){"use strict";function e(e,t,a,n,r,o,s,i,l){"ngInject"}e.$inject=["$rootScope","$scope","$state","$translate","$timeout","$element","TrackService","UserCredentialsService","ecBaseUrl"],angular.module("enviroCar.tracks").controller("AllTracksTabCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/tracks/all_tracks_tab/all_tracks_tab.directive.html",controller:"AllTracksTabCtrl",controllerAs:"vm"}}angular.module("enviroCar").directive("allTracksTab",e)}(),function(){"use strict";function e(e,t,a,n,r,o,s,i,l){"ngInject";function c(){t.currentPageTab=t.pagingTab.current,t.currentPaginationTracks.currentMonthTracks=[];for(var e=t.currentPaginationTracks.currentSelectedTracks.length,a=t.itemsPerPage*(t.currentPageTab-1);a<t.itemsPerPage*t.currentPageTab&&a<e;a++)t.currentPaginationTracks.currentMonthTracks.push(t.currentPaginationTracks.currentSelectedTracks[a])}t.okay_pressed=!1,t.onload_pagination_tab=!1,t.Math=window.Math,t.filterOrder=l.getFilterStateOrder(),console.log(t.filterOrder),t.itemsPerPage=t.screenIsXS?5:10,t.itemsPerPage=window.innerHeight<1e3?5:10,$(window).resize(function(){}),t.username=s.getCredentials().username;var d=l.getFilterState();t.filters={distance:{name:"distance",label:a.instant("FILTER_DISTANCE"),params:{min:d.distance.min,max:d.distance.max},inUse:d.distance.inUse},date:{name:"date",label:a.instant("FILTER_DATE"),params:{min:d.date.min,max:d.date.max},inUse:d.date.inUse},duration:{name:"duration",label:a.instant("FILTER_DURATION"),params:{min:d.duration.min,max:d.duration.max},inUse:d.duration.inUse},vehicle:{name:"vehicle",label:a.instant("FILTER_VEHICLE"),params:{cars_all:d.vehicle.all,cars_set:d.vehicle.set},inUse:d.vehicle.inUse},spatial:{name:"spatial",label:a.instant("FILTER_SPATIAL"),params:{southwest:{lat:d.spatial.southwest.lat,lng:d.spatial.southwest.lng},northeast:{lat:d.spatial.northeast.lat,lng:d.spatial.northeast.lng},track_ids:d.spatial.track_ids},inUse:d.spatial.inUse,layer:0}},t.filtered_tracks=0,t.addFilter=function(e){e.inUse||(e.inUse=!0,"spatial"===e.name?(e.inUse=!1,t.commonDialog(e)):l.setFilterInUse(e.name,!0),t.filterOrder.push(e),l.setFilterStateOrder(t.filterOrder)),console.log(t.filters);var a=l.getFilterState();console.log(a)},t.removeFilter=function(e){for(var a=t.filterOrder.length-1;a>=0;)t.filterOrder[a].name===e.name&&t.filterOrder.splice(a,1),a--;var n=l.getFilterState();console.log(n.filterOrder);for(var a=n.filterOrder.length-1;a>=0;){if(n.filterOrder[a].name===e.name){switch(e.name){case"distance":n.distance.inUse=!1,n.distance.min=void 0,n.distance.max=void 0,l.setDistanceFilterState(!1,n.distance.min,n.distance.max);break;case"date":console.log("removing date filter."),n.date.inUse=!1,n.date.min=void 0,n.date.max=void 0,l.setDateFilterState(!1,n.date.min,n.date.max);break;case"duration":n.duration.inUse=!1,n.duration.min=void 0,n.duration.max=void 0,l.setDurationFilterState(!1,n.duration.min,n.duration.max);break;case"vehicle":n.vehicle.inUse=!1,n.vehicle.all=[],n.vehicle.set=[],l.setVehicleFilterState(!1,n.vehicle.all,n.vehicle.set);break;case"spatial":n.spatial.inUse=!1,n.spatial.southwest.lat=void 0,n.spatial.southwest.lng=void 0,n.spatial.northeast.lat=void 0,n.spatial.northeast.lng=void 0,n.spatial.track_ids=[],l.setSpatialFilterState(!1,n.spatial.southwest.lat,n.spatial.southwest.lng,n.spatial.northeast.lat,n.spatial.northeast.lng,n.spatial.track_ids)}n.filterOrder.splice(a,1)}a--}console.log(t.filters);var r=l.getFilterState();console.log(r)},l.setFilterStateOrder(t.filterOrder),t.commonDialog=function(e){var a={},o=(n("sm")||n("xs"))&&t.customFullscreen;"spatial"===e.name&&(a={controller:"SpatialDialogCtrl",templateUrl:"app/components/tracks/all_tracks_pagination_tab/filter_dialogs/spatial/spatial_filter_dialog.html",parent:angular.element(document.body),scope:t.$new(),clickOutsideToClose:!1,fullscreen:o}),r.show(a).then(function(e){t.status='You said the information was "'+e+'".'},function(){t.status="You cancelled the dialog."}),t.$watch(function(){return n("xs")||n("sm")},function(e){t.customFullscreen=!0===e})};var u;if(t.openMenu=function(e,t){u=t,e(t)},t.filtersChanged=function(){var a=t.currentPaginationTracks.tracks.length;t.amount_of_user_tracks=a;var n=t.filters.distance.inUse,r=t.filters.duration.inUse,o=t.filters.date.inUse,s=t.filters.vehicle.inUse,i=t.filters.spatial.inUse;t.filtered_tracks=0;for(var l=[],d=0;d<a;d++){var u=t.currentPaginationTracks.tracks[d];if(n){var m=u.length;if(void 0===t.filters.distance.params.max){if(!(m>=t.filters.distance.params.min))continue}else if(!(m>=t.filters.distance.params.min&&m<=t.filters.distance.params.max))continue}if(o){var h=u.begin;if(void 0===t.filters.date.params.min&&void 0!==t.filters.date.params.max){if(!(h<=t.filters.date.params.max))continue}else if(void 0===t.filters.date.params.max&&void 0!==t.filters.date.params.min){if(!(h>=t.filters.date.params.min))continue}else if(!(h<=t.filters.date.params.max&&h>=t.filters.date.params.min))continue}if(r){var g=new Date(u.end).getTime()-new Date(u.begin).getTime(),p=g/1e3,_=p/60;if(void 0===t.filters.duration.params.min&&void 0!==t.filters.duration.params.max){if(!(_<t.filters.duration.params.max))continue}else if(void 0===t.filters.duration.params.max&&void 0!==t.filters.duration.params.min){if(!(_>=t.filters.duration.params.min))continue}else if(!(_<t.filters.duration.params.max&&_>=t.filters.duration.params.min))continue}if(s){var v=u.car,f=u.manufacturer,k=f+"-"+v;if(!t.containsVehicle(t.filters.vehicle.params.cars_set,k))continue}if(i){var E=u.id;if(!t.filters.spatial.params.track_ids.filter(function(e){return E===e})[0])continue}l.push(u),t.filtered_tracks++}t.currentPaginationTracks.currentSelectedTracks=l;var b=t.currentPaginationTracks.currentSelectedTracks.length;t.currentPaginationTracks.currentMonthTracks=[],t.pagingTab.total=Math.ceil(b/t.itemsPerPage);for(var d=0;d<t.itemsPerPage&&d<b;d++)t.currentPaginationTracks.currentMonthTracks.push(t.currentPaginationTracks.currentSelectedTracks[d]);t.pagingTab.current=1,c(),e.$broadcast("filter:spatial-filter-changed")},t.$on("toolbar:language-changed",function(e,n){a(["FILTER_DISTANCE","FILTER_DATE","FILTER_DURATION","FILTER_VEHICLE","FILTER_SPATIAL"]).then(function(e){t.filters.distance.label=e.FILTER_DISTANCE,t.filters.date.label=e.FILTER_DATE,t.filters.duration.label=e.FILTER_DURATION,t.filters.vehicle.label=e.FILTER_VEHICLE,t.filters.spatial.label=e.FILTER_SPATIAL})}),t.currentPaginationTracks={currentMonthTracks:[],currentSelectedTracks:[],tracks:[]},t.currentPageTab=0,t.pagingTab={total:5,current:1,align:"center start",onPageChanged:c},t.tracksPagination=[],window.innerHeight>0){var m=t.currentPaginationTracks.currentSelectedTracks.length;t.currentPaginationTracks.currentMonthTracks=[],t.pagingTab.total=Math.ceil(m/t.itemsPerPage);for(var h=0;h<t.itemsPerPage&&h<m;h++)t.currentPaginationTracks.currentMonthTracks.push(t.currentPaginationTracks.currentSelectedTracks[h]);t.pagingTab.current=1,c()}t.containsVehicle=function(e,t){for(var a=e.length;a--;)if(e[a]===t)return!0;return!1},o.getUserTracks(t.username).then(function(a){var n=[],r=a.data.tracks;t.date_min=new Date(r[0].begin),t.date_max=new Date(r[0].begin),t.distance_min=parseFloat(r[0].length.toFixed(2)),t.distance_max=parseFloat(r[0].length.toFixed(2));var o=new Date(r[0].end).getTime()-new Date(r[0].begin).getTime(),s=o/6e4;t.duration_min=Math.floor(s),t.duration_max=Math.ceil(s);t.filtered_tracks=r.length,t.tracksPagination=[];for(var i=0;i<r.length;i++){var l=r[i],c=l.begin,d=new Date(c),u=d.toString(),m=u.split(" "),h=m[1]+m[2]+m[3];void 0!==n[h]?n[h]++:n[h]=1;var g=new Date(l.begin);g<t.date_min&&(t.date_min=new Date(g.getTime())),g>t.date_max&&(t.date_max=new Date(g.getTime()));var p=g.getUTCMonth(),_=g.getUTCFullYear(),v=g.getDate(),o=new Date(l.end).getTime()-new Date(l.begin).getTime(),f=o/1e3,k=new Date(null);k.setSeconds(f);var E=k.toISOString().substr(11,8),b=E,T=new Date(l.begin),y=new Date(l.end),o=new Date(l.end).getTime()-new Date(l.begin).getTime(),s=o/6e4;s<t.duration_min&&(t.duration_min=Math.floor(s)),s>t.duration_max&&(t.duration_max=Math.ceil(s));var w=l.sensor.properties.model,S=l.sensor.properties.manufacturer,C=S+"-"+w;t.containsVehicle(t.filters.vehicle.params.cars_all,C)||t.filters.vehicle.params.cars_all.push(C);var R={year:_,month:p,day:v,car:w,manufacturer:S,id:l.id,url:"https://envirocar.org/api/stable/tracks/"+l.id+"/preview",travelTime:b,begin:T,end:y,length:0};if(l.length){var D=parseFloat(l.length.toFixed(2));D<t.distance_min&&(t.distance_min=D),D>t.distance_max&&(t.distance_max=D),R.length=D}t.tracksPagination.push(R)}t.distance_max=Math.ceil(t.distance_max),t.distance_min=Math.floor(t.distance_min),t.currentPaginationTracks={currentMonthTracks:[],currentSelectedTracks:[],tracks:[]};for(var i=0;i<t.tracksPagination.length;i++){var l=t.tracksPagination[i];t.currentPaginationTracks.tracks.push(l),t.currentPaginationTracks.currentSelectedTracks.push(l)}var A=t.currentPaginationTracks.tracks.length;t.pagingTab.total=Math.ceil(A/t.itemsPerPage);for(var i=0;i<t.itemsPerPage&&i<A;i++)t.currentPaginationTracks.currentMonthTracks.push(t.currentPaginationTracks.tracks[i]);t.onload_pagination_tab=!0,e.$broadcast("trackspage:pagination_tab-loaded"),t.filterOrder.length>0&&(t.filters.spatial.inUse&&t.filterOrder.length>1?t.filtersChanged():t.filters.spatial.inUse||t.filtersChanged()),window.dispatchEvent(new Event("resize"))},function(e){console.log("error "+e)})}e.$inject=["$rootScope","$scope","$translate","$mdMedia","$mdDialog","TrackService","UserCredentialsService","ecBaseUrl","FilterStateService"],angular.module("enviroCar.tracks").controller("AllTracksPaginationTabCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/tracks/all_tracks_pagination_tab/all_tracks_pagination_tab.directive.html",controller:"AllTracksPaginationTabCtrl",controllerAs:"vm"}}angular.module("enviroCar").directive("allTracksPaginationTab",e)}(),function(){"use strict";function e(){"ngInject";var e=1;this.getTrackTab=function(){return e},this.setTrackTab=function(t){e=t};var t={selectedTab:1,filterOrder:[],distance:{name:"distance",inUse:!1,min:void 0,max:void 0},date:{name:"date",inUse:!1,min:void 0,max:void 0},duration:{name:"duration",inUse:!1,min:void 0,max:void 0},vehicle:{name:"vehicle",inUse:!1,all:[],set:[]},spatial:{inUse:!1,name:"spatial",southwest:{lat:void 0,lng:void 0},northeast:{lat:void 0,lng:void 0},track_ids:[]}};this.getFilterStateOrder=function(){return t.filterOrder},this.getFilterState=function(){return t},this.getDistanceFilterState=function(){return t.distance},this.getDurationFilterState=function(){return t.duration},this.getDateFilterState=function(){return t.date},this.getVehicleFilterState=function(){return t.vehicle},this.getSpatialFilterState=function(){return t.spatial},this.setDistanceFilterState=function(e,a,n){t.distance.min=a,t.distance.max=n,t.distance.inUse=e},this.setDateFilterState=function(e,a,n){t.date.min=a,t.date.max=n,t.date.inUse=e},this.setDurationFilterState=function(e,a,n){t.duration.inUse=e,t.duration.min=a,t.duration.max=n},this.setVehicleFilterState=function(e,a,n){t.vehicle.inUse=e,t.vehicle.all=a,t.vehicle.set=n},this.setSpatialFilterState=function(e,a,n,r,o,s){t.spatial.southwest.lat=a,t.spatial.southwest.lng=n,t.spatial.northeast.lat=r,t.spatial.northeast.lng=o,t.spatial.inUse=e,t.spatial.track_ids=s},this.setFilterStateOrder=function(e){t.filterOrder=e},this.setFilterInUse=function(e,a){switch(e){case"distance":t.distance.inUse=a;break;case"date":t.date.inUse=a;break;case"duration":t.duration.inUse=a;break;case"vehicle":t.vehicle.inUse=a;break;case"spatial":t.spatial.inUse=a}},this.resetFilterStates=function(){t={selectedTab:1,filterOrder:[],distance:{name:"distance",inUse:!1,min:void 0,max:void 0},date:{name:"date",inUse:!1,min:void 0,max:void 0},duration:{name:"duration",inUse:!1,min:void 0,max:void 0},vehicle:{name:"vehicle",inUse:!1,all:[],set:[]},spatial:{inUse:!1,name:"spatial",southwest:{lat:void 0,lng:void 0},northeast:{lat:void 0,lng:void 0},track_ids:[]}}}}angular.module("enviroCar.tracks").service("FilterStateService",e)}(),function(){"use strict";function e(e,t,a,n,r,o,s){"ngInject";function i(){t.currentPage=t.paging.current,t.currentPageTracks.currentMonthTracks=[];for(var e=t.currentPageTracks.currentSelectedTracks.length,a=4*(t.currentPage-1);a<4*t.currentPage&&a<e;a++)t.currentPageTracks.currentMonthTracks.push(t.currentPageTracks.currentSelectedTracks[a])}function l(e,t){var a=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((n-a)/m)}function c(e){t.target=$(e.target);var a=t.target.attr("tabindex");void 0!==a&&(t.hoveredTabItem=a,t.updateHoverHighlight(t.rangeStartDate.getDate(),t.rangeEndDate.getDate(),a,!1))}function d(e){t.target=$(e.target);var a=t.target.attr("tabindex");void 0!==a&&(t.hoveredTabItem=a,t.updateHoverHighlight(t.rangeStartDate.getDate(),t.rangeEndDate.getDate(),t.rangeEndDate.getDate(),!0))}t.onload_calendar=!1,t.nostatistics=!0,t.Math=window.Math,t.username=o.getCredentials().username,t.currentPageTracks={currentMonthTracks:[],currentSelectedTracks:[],tracks:[]},t.currentPage=0,t.paging={total:5,current:1,align:"center start",onPageChanged:i};var u=function(){for(var e=0,a=0,n=0,r=0;r<t.currentPageTracks.currentSelectedTracks.length;r++){var o=t.currentPageTracks.currentSelectedTracks[r];e+=(new Date(o.end).getTime()-new Date(o.begin).getTime())/1e3,a+=o.length,n++}var s=new Date(null);s.setSeconds(e);var i=s.toISOString().substr(11,8),l=i;t.total_time=l,t.total_distance=a.toFixed(1),t.total_tracks=n,t.nostatistics=!1};t.monthDivs=[];var m=864e5;t.setDayContent=function(e){return"<p></p>"},t.rangeSelection=[],t.rangeStartDate,t.rangeEndDate;var h=function(e,a){var n="blue",o="blue";e&&(n="white",o="md-light");var s=new Date;s.setFullYear(t.selectedYear),s.setMonth(t.selectedMonth),s.setDate(a);var i=s.toString(),l=i.split(" "),c=l[1]+l[2]+l[3];t.date_count[c]&&(t.date_count[c]>1?r.setDayContent(s,'<i class="material-icons '+o+'">directions_car</i><span class="span'+n+'">+'+t.date_count[c]+"</span>"):r.setDayContent(s,'<i class="material-icons '+o+'">directions_car</i>'))},g=function(){for(var e=new Date(t.selectedYear,t.selectedMonth+1,0),a=e.getDate(),n=1;n<=a;n++){angular.element(document.querySelectorAll('[tabindex="'+n+'"]')).css("background-color","transparent"),h(!1,n)}},p=function(e,a){if(t.numberClickedDays>0)for(var n=e;n<=a;n++){var r=angular.element(document.querySelectorAll('[tabindex="'+n+'"]'));n===e||n===a?r.css("background-color",v):r.css("background-color",_),h(!0,n)}};t.numberClickedDays=0,t.dayClick=function(e){0===t.numberClickedDays?(t.rangeStartDate=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t.rangeEndDate=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t.numberClickedDays++):1===t.numberClickedDays?t.rangeStartDate.getDate()===e.getDate()&&t.rangeStartDate.getMonth()===e.getMonth()&&t.rangeStartDate.getFullYear()===e.getFullYear()?(t.rangeStartDate=new Date(t.selectedYear,t.selectedMonth,1),t.rangeEndDate=new Date(t.selectedYear,t.selectedMonth+1,0),t.numberClickedDays=0):l(e,t.rangeStartDate)>0?(t.rangeStartDate=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t.numberClickedDays=2):l(t.rangeEndDate,e)>0&&(t.rangeEndDate=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t.numberClickedDays=2):l(e,t.rangeStartDate)>0?t.rangeStartDate=new Date(e.getFullYear(),e.getMonth(),e.getDate()):l(t.rangeEndDate,e)>0?t.rangeEndDate=new Date(e.getFullYear(),e.getMonth(),e.getDate()):0===l(e,t.rangeStartDate)?(t.rangeEndDate=new Date(t.rangeStartDate.getFullYear(),t.rangeStartDate.getMonth(),t.rangeStartDate.getDate()),t.numberClickedDays=1):0===l(t.rangeEndDate,e)?(t.rangeEndDate=new Date(t.rangeStartDate.getFullYear(),t.rangeStartDate.getMonth(),t.rangeStartDate.getDate()),t.numberClickedDays=1):t.rangeEndDate=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t.rangeSelection=[];for(var n=new Date(t.rangeStartDate.getFullYear(),t.rangeStartDate.getMonth(),t.rangeStartDate.getDate());n<=t.rangeEndDate;n.setDate(n.getDate()+1))t.rangeSelection.push(new Date(n));g(),p(t.rangeStartDate.getDate(),t.rangeEndDate.getDate()),t.currentPageTracks.currentMonthTracks=[],t.currentPageTracks.currentSelectedTracks=[];for(var r=0;r<t.currentPageTracks.tracks.length;r++){var o=t.currentPageTracks.tracks[r],s=new Date(o.begin);l(t.rangeStartDate,s)>=0&&l(s,t.rangeEndDate)>=0&&t.currentPageTracks.currentSelectedTracks.push(o)}var c=t.currentPageTracks.currentSelectedTracks.length;t.paging.total=Math.ceil(c/4);for(var r=0;r<4&&r<c;r++)t.currentPageTracks.currentMonthTracks.push(t.currentPageTracks.tracks[r]);t.currentPage=1,t.paging.current=1,u(),i(),a(function(){window.dispatchEvent(new Event("resize")),a(function(){window.dispatchEvent(new Event("resize"))},600)},400)},t.prevMonth=function(e){t.selectedMonth=e.month-1,t.selectedYear=e.year,t.currentPageTracks={currentMonthTracks:[],currentSelectedTracks:[],tracks:[]};for(var n=0;n<t.tracksCalendar.length;n++){var r=t.tracksCalendar[n];r.year===t.selectedYear&&r.month===t.selectedMonth&&(t.currentPageTracks.tracks.push(r),t.currentPageTracks.currentSelectedTracks.push(r))}t.rangeStartDate=new Date(t.selectedYear,t.selectedMonth,1),t.rangeEndDate=new Date(t.selectedYear,t.selectedMonth+1,0),t.rangeSelection=[];for(var o=new Date(t.selectedYear,t.selectedMonth,1);o<=t.rangeEndDate;o.setDate(o.getDate()+1))t.rangeSelection.push(new Date(o));t.numberClickedDays=0;var s=t.currentPageTracks.tracks.length;t.paging.total=Math.ceil(s/4);for(var n=0;n<4&&n<s;n++)t.currentPageTracks.currentMonthTracks.push(t.currentPageTracks.tracks[n]);t.paging.current=1,g(),u(),a(function(){window.dispatchEvent(new Event("resize"));for(var e=new Date(t.selectedYear,t.selectedMonth+1,0),a=e.getDate(),n=1;n<=a;n++){var r=angular.element(document.querySelectorAll('[tabindex="'+n+'"]'));r.css("background-color","transparent"),$(r).mouseenter(c),$(r).mouseleave(d)}},500)},t.nextMonth=function(e){t.selectedMonth=e.month-1,t.selectedYear=e.year,t.currentPageTracks={currentMonthTracks:[],currentSelectedTracks:[],tracks:[]};for(var n=0;n<t.tracksCalendar.length;n++){var r=t.tracksCalendar[n];r.year===t.selectedYear&&r.month===t.selectedMonth&&(t.currentPageTracks.tracks.push(r),t.currentPageTracks.currentSelectedTracks.push(r))}t.rangeStartDate=new Date(t.selectedYear,t.selectedMonth,1),t.rangeEndDate=new Date(t.selectedYear,t.selectedMonth+1,0),t.rangeSelection=[];for(var o=new Date(t.selectedYear,t.selectedMonth,1);o<=t.rangeEndDate;o.setDate(o.getDate()+1))t.rangeSelection.push(new Date(o));t.numberClickedDays=0,t.paging.current=1;var s=t.currentPageTracks.tracks.length;t.paging.total=Math.ceil(s/4);for(var n=0;n<4&&n<s;n++)t.currentPageTracks.currentMonthTracks.push(t.currentPageTracks.tracks[n]);g(),u(),a(function(){window.dispatchEvent(new Event("resize"));for(var e=new Date(t.selectedYear,t.selectedMonth+1,0),a=e.getDate(),n=1;n<=a;n++){var r=angular.element(document.querySelectorAll('[tabindex="'+n+'"]'));r.css("background-color","transparent"),$(r).mouseenter(c),$(r).mouseleave(d)}},500)},t.hoveredTabItem=void 0;var _="#a3cce6",v="#8cbfe0";t.updateHoverHighlight=function(e,a,n,r){if(0===t.numberClickedDays){for(var o=new Date(t.selectedYear,t.selectedMonth+1,0),s=o.getDate(),i=1;i<=s;i++){var l=angular.element(document.querySelectorAll('[tabindex="'+i+'"]'));l.css("background-color","transparent")}if(!r){var l=angular.element(document.querySelectorAll('[tabindex="'+n+'"]'));l.css("background-color","#e8f2f8")}}else{for(var o=new Date(t.selectedYear,t.selectedMonth+1,0),s=o.getDate(),i=1;i<e;i++){var l=angular.element(document.querySelectorAll('[tabindex="'+i+'"]'));l.css("background-color","transparent")}for(var i=e;i<=a;i++){var l=angular.element(document.querySelectorAll('[tabindex="'+i+'"]'));i===e||i===a?l.css("background-color",v):l.css("background-color",_)}for(var i=a+1;i<=s;i++){var l=angular.element(document.querySelectorAll('[tabindex="'+i+'"]'));l.css("background-color","transparent")}for(var i=n;i<e;i++){var l=angular.element(document.querySelectorAll('[tabindex="'+i+'"]'));l.css("background-color","#e8f2f8")}for(var i=a+1;i<=n;i++){var l=angular.element(document.querySelectorAll('[tabindex="'+i+'"]'));l.css("background-color","#e8f2f8")}if(e<n&&n<a)for(var i=parseInt(n)+1;i<a;i++){var l=angular.element(document.querySelectorAll('[tabindex="'+i+'"]'));l.css("background-color","#e8f2f8")}if((parseInt(n)===a||e===parseInt(n))&&!r)for(var i=e+1;i<a;i++){var l=angular.element(document.querySelectorAll('[tabindex="'+i+'"]'));l.css("background-color","#e8f2f8")}var l=angular.element(document.querySelectorAll('[tabindex="'+e+'"]'));if(l.css("background-color",v),parseInt(n)>a){var l=angular.element(document.querySelectorAll('[tabindex="'+a+'"]'));l.css("background-color",v)}else if(parseInt(n)<=a&&parseInt(n)>=e&&!r){var l=angular.element(document.querySelectorAll('[tabindex="'+a+'"]'));l.css("background-color","#e8f2f8")}else{var l=angular.element(document.querySelectorAll('[tabindex="'+a+'"]'));l.css("background-color",v)}}},t.$on("toolbar:language-changed",function(e,t){}),t.tracksCalendar=[],n.getUserTracks(t.username).then(function(n){t.date_count=[];var o=n.data.tracks,s=new Date(o[0].begin),i=new Date(o[0].begin);t.monthsWithTracksCalendar=[];for(var l=o.length-1;l>=0;l--){var m=o[l],h=m.begin,g=new Date(h),p=g.toString(),_=p.split(" "),v=_[1]+_[2]+_[3];void 0!==t.date_count[v]?t.date_count[v]++:t.date_count[v]=1;var f=new Date(m.begin);f<s&&(s=new Date(f.getTime())),f>i&&(i=new Date(f.getTime()));var k=f.getUTCMonth(),E=f.getUTCFullYear(),b=f.getDate(),T={year:E,month:k,day:b};(function(e,t){for(var a=e.length;a--;)if(e[a].year===t.year&&e[a].month===t.month)return!0;return!1})(t.monthsWithTracksCalendar,T)||t.monthsWithTracksCalendar.push(T);var y=new Date(m.end).getTime()-new Date(m.begin).getTime(),w=y/1e3,S=new Date(null);S.setSeconds(w);var C=S.toISOString().substr(11,8),R=C,D=new Date(m.begin),A=new Date(m.end),I={year:E,month:k,day:b,car:m.sensor.properties.model,manufacturer:m.sensor.properties.manufacturer,id:m.id,url:"https://envirocar.org/api/stable/tracks/"+m.id+"/preview",travelTime:R,begin:D,end:A,length:0};if(m.length){var P=m.length.toFixed(1);I.length=parseFloat(P)}t.tracksCalendar.push(I),t.date_count[v]>1?r.setDayContent(g,'<i class="material-icons blue">directions_car</i><span class="spanblue">+'+t.date_count[v]+"</span>"):r.setDayContent(g,'<i class="material-icons blue">directions_car</i>')}t.start_month=i.getUTCMonth(),t.start_year=i.getUTCFullYear(),t.selectedMonth=t.start_month,t.selectedYear=t.start_year,t.currentPageTracks={currentMonthTracks:[],currentSelectedTracks:[],tracks:[]};for(var l=0;l<t.tracksCalendar.length;l++){var m=t.tracksCalendar[l];m.year===t.selectedYear&&m.month===t.selectedMonth&&(t.currentPageTracks.tracks.push(m),t.currentPageTracks.currentSelectedTracks.push(m))}t.rangeStartDate=new Date(t.start_year,t.start_month,1),t.rangeEndDate=new Date(t.start_year,t.start_month+1,0),t.rangeSelection=[];for(var O=new Date(t.start_year,t.start_month,1);O<=t.rangeEndDate;O.setDate(O.getDate()+1))t.rangeSelection.push(new Date(O));var L=t.currentPageTracks.tracks.length;t.paging.total=Math.ceil(L/4);for(var l=0;l<4&&l<L;l++)t.currentPageTracks.currentMonthTracks.push(t.currentPageTracks.tracks[l]);u(),t.onload_calendar=!0,e.$broadcast("trackspage:calendar_tab-loaded"),window.dispatchEvent(new Event("resize")),a(function(){window.dispatchEvent(new Event("resize"))},200),a(function(){window.dispatchEvent(new Event("resize"));for(var e=new Date(t.selectedYear,t.selectedMonth+1,0),a=e.getDate(),n=1;n<=a;n++){var r=angular.element(document.querySelectorAll('[tabindex="'+n+'"]'));r.css("background-color","transparent"),$(r).mouseenter(c),$(r).mouseleave(d)}},500)},function(e){console.log("error "+e)})}e.$inject=["$rootScope","$scope","$timeout","TrackService","MaterialCalendarData","UserCredentialsService","ecBaseUrl"],angular.module("enviroCar.tracks").controller("CalendarTabCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/tracks/calendar_tab/calendar_tab.directive.html",controller:"CalendarTabCtrl",controllerAs:"vm"}}angular.module("enviroCar").directive("calendarTab",e)}(),function(){"use strict";function e(e,t,a,n,r,o){"ngInject";e.onload_all=!1,e.onload_speed=!1,e.onload_consumption=!1,e.onload_CO2=!1,e.loading=!0,e.username=o.getCredentials().username,e.password=o.getCredentials().password,e.optionsSpeed={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:15,left:50},x:function(e){return a.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.1f")(e)},duration:200,yAxis:{axisLabel:a.instant("SPEED")+" (km/h)",axisLabelDistance:-10},tooltip:{contentGenerator:function(e){return"<h3><b>"+a.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(1)+"km/h </h3>"}}}},e.showAlert=function(e,t,r){var o=a.instant(t),s=a.instant(r);n.show(n.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title(o).textContent(s).ariaLabel("Popover").ok("Okay!").targetEvent(e).fullscreen(!0))},e.$on("sidenav:item-selected",function(n,r){console.log("sidenav item selected."),t(function(){var n="";e.optionsSpeed.chart.yAxis={axisLabel:n,axisLabelDistance:-10};var r="";e.optionsConsumption.chart.yAxis={axisLabel:r,axisLabelDistance:-10};var o="";e.optionsCO2.chart.yAxis={axisLabel:o,axisLabelDistance:-10},window.dispatchEvent(new Event("resize")),t(function(){n=a.instant("SPEED")+" (km/h)",e.optionsSpeed.chart.yAxis={axisLabel:n,axisLabelDistance:-10},r=a.instant("CONSUMPTION")+" (l/h)",e.optionsConsumption.chart.yAxis={axisLabel:r,axisLabelDistance:-10},o=a.instant("CO2")+" (kg/h)",e.optionsCO2.chart.yAxis={axisLabel:o,axisLabelDistance:-10},console.log("speedChart redrawn"),window.dispatchEvent(new Event("resize"))},400)},300),t(function(){window.dispatchEvent(new Event("resize"))},500)}),e.$on("toolbar:language-changed",function(n,r){var o=a.instant("SPEED")+" (km/h)";e.optionsSpeed.chart.yAxis={axisLabel:o,axisLabelDistance:-10};var s=a.instant("CONSUMPTION")+" (l/h)";e.optionsConsumption.chart.yAxis={axisLabel:s,axisLabelDistance:-10};var i=a.instant("CO2")+" (kg/h)";e.optionsCO2.chart.yAxis={axisLabel:i,axisLabelDistance:-10},t(function(){window.dispatchEvent(new Event("resize"))},1e3)}),e.optionsConsumption={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:15,left:50},x:function(e){return a.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.2f")(e)},duration:200,yAxis:{axisLabel:a.instant("CONSUMPTION")+" (l/h)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){return"<h3><b>"+a.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(2)+"l/h </h3>"}}}},e.optionsCO2={chart:{type:"discreteBarChart",height:200,margin:{top:10,
right:0,bottom:15,left:50},x:function(e){return a.instant(e.label)},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:200,yAxis:{axisLabel:"CO2 (kg/h)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){return"<h3><b>"+a.instant("TT_"+e.data.label)+"</b> = "+e.data.value.toFixed(4)+"kg/h </h3>"}}}};var s=[];r.getUserPhenomenonStatistics(e.username,"Speed").then(function(a){console.log(a);var n=a.data,o=n.avg;r.getPhenomenonStatistics("Speed").then(function(a){console.log(a),n=a.data;var r=n.avg;e.dataSpeed=[{key:"Cumulative Return",values:[{label:"LABEL_USER",value:o},{label:"LABEL_PUBLIC",value:r}]}],s.push(a),e.onload_speed=!0,e.onload_CO2&&e.onload_consumption&&(e.onload_all=!0,t(function(){window.dispatchEvent(new Event("resize"))},300),t(function(){window.dispatchEvent(new Event("resize"))},500))},function(e){console.log("error "+e)})},function(e){console.log("error "+e)}),r.getUserPhenomenonStatistics(e.username,"Consumption").then(function(a){var n=a.data,o=n.avg;r.getPhenomenonStatistics("Consumption").then(function(a){n=a.data;var r=n.avg;e.dataConsumption=[{key:"Cumulative Return",values:[{label:"LABEL_USER",value:o},{label:"LABEL_PUBLIC",value:r}]}],s.push(a),e.onload_consumption=!0,e.onload_CO2&&e.onload_speed&&(e.onload_all=!0,window.dispatchEvent(new Event("resize")),t(function(){window.dispatchEvent(new Event("resize"))},300),t(function(){window.dispatchEvent(new Event("resize"))},500))},function(e){console.log("error "+e)})},function(e){console.log("error "+e)}),r.getUserPhenomenonStatistics(e.username,"CO2").then(function(a){var n=a.data,o=n.avg;r.getPhenomenonStatistics("CO2").then(function(a){n=a.data;var r=n.avg;e.dataCO2=[{key:"Cumulative Return",values:[{label:"LABEL_USER",value:o},{label:"LABEL_PUBLIC",value:r}]}],s.push(a),e.onload_CO2=!0,e.onload_speed&&e.onload_consumption&&(e.onload_all=!0,window.dispatchEvent(new Event("resize")),t(function(){window.dispatchEvent(new Event("resize")),t(function(){window.dispatchEvent(new Event("resize"))},300)},300))},function(e){console.log("error "+e)})},function(e){console.log("error "+e)}),t(function(){window.dispatchEvent(new Event("resize"))},300),t(function(){window.dispatchEvent(new Event("resize"))},500)}e.$inject=["$scope","$timeout","$translate","$mdDialog","StatisticsService","UserCredentialsService"],angular.module("enviroCar").controller("ComparisonChartCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/dashboard/dashboard.charts/comparison_chart/comparison_chart.directive.html",controller:"ComparisonChartCtrl"}}angular.module("enviroCar").directive("comparisonChart",e)}(),function(){"use strict";function e(e,t,a,n,r,o,s){"ngInject";var i={};e.track_number=0,e.onload_tracks_timeline=!1,e.username=o.getCredentials().username,e.goToActivity=function(e){t.go("chart",{trackid:e})};var l=[];n.getUserTracks(e.username).then(function(t){console.log(t),e.number=t.data.tracks.length,e.track_number=e.number;var a=0;a=e.number>=6?6:e.number;for(var n=0;n<a;n++)!function(e){var a={};a.car=t.data.tracks[e].sensor.properties.model,a.manufacturer=t.data.tracks[e].sensor.properties.manufacturer,a.id=t.data.tracks[e].id,a.title=t.data.tracks[e].name,a.url="https://envirocar.org/api/stable/tracks/"+t.data.tracks[e].id+"/preview";var n=new Date(t.data.tracks[e].end).getTime()-new Date(t.data.tracks[e].begin).getTime(),r=n/1e3,o=new Date(null);o.setSeconds(r);var s=o.toISOString().substr(11,8);a.travelTime=s,a.begin=new Date(t.data.tracks[e].begin),a.distance=void 0!=t.data.tracks[e].length?t.data.tracks[e].length.toFixed(2):"NA",l.push(a)}(n);e.timelinevalues=i,e.events=l,e.onload_tracks_timeline=!0,window.dispatchEvent(new Event("resize"))},function(e){console.log("error "+e)})}e.$inject=["$scope","$state","$translate","TrackService","UserService","UserCredentialsService","ecBaseUrl"],angular.module("enviroCar").controller("LatestTracksChartCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/dashboard/dashboard.charts/latest_tracks/latest_tracks.directive.html",controller:"LatestTracksChartCtrl",controllerAs:"vm"}}angular.module("enviroCar").directive("latestTracksChart",e)}(),function(){"use strict";function e(e,t,a,n,r){"ngInject";e.onload_heat_map=!1,angular.extend(e,{map:{layers2:{baselayers:{osm:{name:"OpenStreetMap",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz"},mapbox_light:{name:"Mapbox Light",url:"http://api.tiles.mapbox.com/v4/{mapid}/{z}/{x}/{y}.png?access_token={apikey}",type:"xyz",layerOptions:{apikey:"pk.eyJ1IjoibmF2ZWVuamFmZXIiLCJhIjoiY2lsYnVmamE0MDA1MXdnbHpvNGZianRuOCJ9.5KqDlJGBKr7ZF9Rdg6j_yQ",mapid:"naveenjafer.0n3ooo76"}}},overlays:{heat:{name:"Heat Map",type:"heat",data:e.heat_dataset,layerOptions:{radius:20,blur:30,minopacity:0,maxZoom:12},visible:!0,doRefresh:!0}}},defaults2:{maxZoom:10,zoomControlPosition:"topright",scrollWheelZoom:!1,zoomControl:!1,doubleClickZoom:!1,dragging:!1},bounds2:{}}}),e.track_number=0,e.username=a.getCredentials().username,e.password=a.getCredentials().password,e.heat_dataset=[];var o=[],s=[];n.getUserStatistic(e.username,e.password).then(function(a){console.log(a);for(var n=a.data.trackSummaries,i=0;i<n.length;i++){var l=[],c=[];l[1]=n[i].startPosition.geometry.coordinates[0],l[0]=n[i].startPosition.geometry.coordinates[1],l[2]=1,c[1]=n[i].endPosition.geometry.coordinates[0],c[0]=n[i].endPosition.geometry.coordinates[1],c[2]=1,o.push(l),s.push(c),e.heat_dataset.push(l),e.heat_dataset.push(c)}e.map.layers2.overlays={heat:{name:"Heat Map",type:"heat",data:e.heat_dataset,layerOptions:{radius:20,blur:30,minopacity:0,maxZoom:8},visible:!0,doRefresh:!0}};var d,u,m,h;n[0].endPosition.geometry.coordinates[1]<n[0].startPosition.geometry.coordinates[1]?(d=n[0].endPosition.geometry.coordinates[1],u=n[0].startPosition.geometry.coordinates[1]):(d=n[0].startPosition.geometry.coordinates[1],u=n[0].endPosition.geometry.coordinates[1]),n[0].endPosition.geometry.coordinates[0]<n[0].startPosition.geometry.coordinates[0]?(m=n[0].endPosition.geometry.coordinates[0],h=n[0].startPosition.geometry.coordinates[0]):(m=n[0].startPosition.geometry.coordinates[0],h=n[0].endPosition.geometry.coordinates[0]);for(var i=1;i<n.length;i++){var g=n[i].startPosition.geometry.coordinates,p=n[i].endPosition.geometry.coordinates;d>g[1]&&(d=g[1]),d>p[1]&&(d=p[1]),m>g[0]&&(m=g[0]),m>p[0]&&(m=p[0]),u<g[1]&&(u=g[1]),u<p[1]&&(u=p[1]),h<g[0]&&(h=g[0]),h<p[0]&&(h=p[0])}e.southwest={lat:d,lng:m},e.northeast={lat:u,lng:h};var _=(e.northeast.lat-e.southwest.lat)/10,v=(e.northeast.lng-e.southwest.lng)/10;e.map.bounds2=r.createBoundsFromArray([[e.northeast.lat+_,e.northeast.lng+v],[e.southwest.lat-_,e.southwest.lng-v]]),t(function(){e.onload_heat_map=!0,window.dispatchEvent(new Event("resize"))},300)},function(e){console.log(e)}),e.$on("sidenav:item-selected",function(a,n){t(function(){console.log("heatmap reloading..."),e.map.layers2.overlays={},e.map.layers2.overlays={heat:{name:"Heat Map",type:"heat",data:e.heat_dataset,layerOptions:{radius:20,blur:30,minopacity:0,maxZoom:8},visible:!0,doRefresh:!0}};var a=(e.northeast.lat-e.southwest.lat)/10,n=(e.northeast.lng-e.southwest.lng)/10;e.map.bounds2=r.createBoundsFromArray([[e.northeast.lat+a,e.northeast.lng+n],[e.southwest.lat-a,e.southwest.lng-n]]),t(function(){e.onload_heat_map=!0,window.dispatchEvent(new Event("resize"))},300),e.map.layers2.overlays.doRefresh=!0},500)})}e.$inject=["$scope","$timeout","UserCredentialsService","UserService","leafletBoundsHelpers"],angular.module("enviroCar").controller("HeatMapCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/dashboard/dashboard.charts/heatmap/heat_map.directive.html",controller:"HeatMapCtrl"}}angular.module("enviroCar").directive("heatMapChart",e)}(),function(){"use strict";function e(e,t,a,n,r){"ngInject";e.onload_weekdays=!1,e.loading=!0,e.username=r.getCredentials().username,e.password=r.getCredentials().password,e.optionsWeekdays={chart:{type:"discreteBarChart",height:240,margin:{top:20,right:20,bottom:45,left:45},showValues:!0,duration:200,xAxis:{showMaxMin:!1,staggerLabels:!0},yAxis:{axisLabel:"km",axisLabelDistance:-20},staggerLabels:!0,tooltip:{contentGenerator:function(e){return"<h3><b>"+e.data.x+"</b> = "+e.data.y.toFixed(1)+"km </h3>"}}}},e.dataWeekdays=[],e.$on("sidenav:item-selected",function(a,n){t(function(){e.optionsWeekdays.chart.yAxis.axisLabel="",window.dispatchEvent(new Event("resize")),t(function(){e.optionsWeekdays.chart.yAxis.axisLabel="km",window.dispatchEvent(new Event("resize"))},200)},100),t(function(){window.dispatchEvent(new Event("resize"))})},500),e.$on("toolbar:language-changed",function(n,r){e.dataWeekdays[0].values[0].x=a.instant("SUNDAY"),e.dataWeekdays[0].values[1].x=a.instant("MONDAY"),e.dataWeekdays[0].values[2].x=a.instant("TUESDAY"),e.dataWeekdays[0].values[3].x=a.instant("WEDNESDAY"),e.dataWeekdays[0].values[4].x=a.instant("THURSDAY"),e.dataWeekdays[0].values[5].x=a.instant("FRIDAY"),e.dataWeekdays[0].values[6].x=a.instant("SATURDAY"),e.optionsWeekdays.chart.yAxis={axisLabel:"km",axisLabelDistance:-20},t(function(){window.dispatchEvent(new Event("resize"))},500)}),n.getUserTracks(e.username,e.password).then(function(t){for(var n=t.data.tracks,r=[{key:"Cumulative Return",values:[{x:a.instant("SUNDAY"),y:0},{x:a.instant("MONDAY"),y:0},{x:a.instant("TUESDAY"),y:0},{x:a.instant("WEDNESDAY"),y:0},{x:a.instant("THURSDAY"),y:0},{x:a.instant("FRIDAY"),y:0},{x:a.instant("SATURDAY"),y:0}],yAxis:1,type:"bar"}],o=0;o<n.length;o++){var s=n[o],i=new Date(s.begin);s.length&&(r[0].values[i.getDay()].y+=s.length)}e.dataWeekdays=r,e.onload_weekdays=!0}),t(function(){window.dispatchEvent(new Event("resize"))},300),t(function(){window.dispatchEvent(new Event("resize"))},700)}e.$inject=["$scope","$timeout","$translate","TrackService","UserCredentialsService"],angular.module("enviroCar").controller("WeekdaysChartCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/dashboard/dashboard.charts/weekdays_chart/weekdays_chart.directive.html",controller:"WeekdaysChartCtrl"}}angular.module("enviroCar").directive("weekdaysChart",e)}(),function(){"use strict";function e(e,t,a,n,r){"ngInject";e.onloadSpeedZones=!1,e.loading=!0,e.NaN_exist=!1,e.username=r.getCredentials().username,e.password=r.getCredentials().password,e.userstatistics={distance:0,duration:0,distance130:0,duration130:0,distance60:0,duration60:0,distanceNaN:0,durationNaN:0};var o=function(e){var t=parseFloat(e+"");t*=60;var a=Math.floor(t/60);t-=60*a;var n=Math.floor(t);return a<10&&(a="0"+a),n<10&&(n="0"+n),a+":"+n};n.getUserStatistic(e.username,e.password).then(function(a){console.log(a);var n=a.data,r=a.data.userstatistic;e.userstatistics={distance:n.distance.toFixed(2),duration:o(n.duration),distance130:r.above130kmh.distance.toFixed(2),duration130:o(r.above130kmh.duration),distance60:r.below60kmh.distance.toFixed(2),duration60:o(r.below60kmh.duration),distance60to130:(n.distance-r.above130kmh.distance-r.below60kmh.distance-r.NaN.distance).toFixed(2),duration60to130:o(n.duration-r.above130kmh.duration-r.below60kmh.duration-r.NaN.duration),distanceNaN:r.NaN.distance,durationNaN:o(r.NaN.duration)},e.userstatistics.distanceNaN>0&&(e.NaN_exist=!0),e.onloadSpeedZones=!0,t(function(){window.dispatchEvent(new Event("resize")),t(function(){window.dispatchEvent(new Event("resize"))},300)},200)},function(e){console.log(e)}),t(function(){window.dispatchEvent(new Event("resize"))},300)}e.$inject=["$scope","$timeout","$translate","UserService","UserCredentialsService"],angular.module("enviroCar").controller("SpeedZonesChartCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/dashboard/dashboard.charts/speed_zones_chart/speed_zones.directive.html",controller:"SpeedZonesChartCtrl"}}angular.module("enviroCar").directive("speedZonesChart",e)}(),function(){LanguageMenuCtrl=["$rootScope","$scope","$translate","$cookieStore",function(e,t,a,n){"ngInject";t.optionsLanguage=[{name:"Deutsch",shortcut:"de",image:"app/components/assets/button_icons/germ-flag-40x30.jpg"},{name:"English",shortcut:"en",image:"app/components/assets/button_icons/engl-flag-40x30.jpg"}],t.currOption=t.optionsLanguage[1];var r={name:"English",shortcut:"en"};if(r=n.get("language"),console.log(r),t.saveLanguageSetting=function(){r={name:t.currOption.name,shortcut:t.currOption.shortcut},n.put("language",r)},r)switch(a.use(r.shortcut),r.shortcut){case"en":a.use("en"),t.currOption=t.optionsLanguage[1];break;case"de":a.use("de"),t.currOption=t.optionsLanguage[0]}else a.use("en"),t.currOption=t.optionsLanguage[1],t.saveLanguageSetting();t.changeLanguage=function(){"en"===t.currOption.shortcut?t.currOption=t.optionsLanguage[0]:t.currOption=t.optionsLanguage[1],console.log(t.currOption),t.saveLanguageSetting(),a.use(t.currOption.shortcut),e.$broadcast("toolbar:language-changed",t.language)}}],angular.module("enviroCar").controller("LanguageMenuCtrl",LanguageMenuCtrl)}(),function(){function e(){"use strict";return{restrict:"EA",templateUrl:"./app/components/toolbar/toolbar.partials/language_menu/language_menu.directive.html",controller:"LanguageMenuCtrl"}}angular.module("enviroCar").directive("languageMenu",e)}(),function(){PhenomenonDropdownCtrl=["$rootScope","$scope","$translate",function(e,t,a){"ngInject";t.phenomenon=a.instant("SPEED"),t.storeSelection=0,t.phenomsIDs=["SPEED","CONSUMPTION","CO2","RPM","ENGINE_LOAD","GPS_SPEED"],t.phenomenonNamesEnglish=["Speed","Consumption","CO2","Rpm","Engine Load","GPS Speed"],t.phenomenonNames=[a.instant("SPEED"),a.instant("CONSUMPTION"),a.instant("CO2"),a.instant("RPM"),a.instant("ENGINE_LOAD"),a.instant("GPS_SPEED")],t.currentPhenomenonDisplayName=t.phenomenon,t.changePhenomenon=function(a){t.currentPhenomenonDisplayName=a,t.phenomenon=a;for(var n=0;n<6;n++)t.phenomenonNames[n]===t.phenomenon&&(t.storeSelection=n);var r=t.phenomenonNamesEnglish[t.storeSelection];e.$broadcast("track-toolbar:phenomenon-changed",r)},t.$on("single_track_page:phenomenons-available",function(e,n){console.log(n),t.phenomenonNamesEnglish=[],t.phenomenonNames=[],t.phenomsIDs=[],n.Speed&&(t.phenomenonNamesEnglish.push("Speed"),t.phenomenonNames.push(a.instant("SPEED")),t.phenomsIDs.push("SPEED")),n.Consumption&&(t.phenomenonNamesEnglish.push("Consumption"),t.phenomenonNames.push(a.instant("CONSUMPTION")),t.phenomsIDs.push("CONSUMPTION")),n.CO2&&(t.phenomenonNamesEnglish.push("CO2"),t.phenomenonNames.push(a.instant("CO2")),t.phenomsIDs.push("CO2")),n.Rpm&&(t.phenomenonNamesEnglish.push("Rpm"),t.phenomenonNames.push(a.instant("RPM")),t.phenomsIDs.push("RPM")),n["Engine Load"]&&(t.phenomenonNamesEnglish.push("Engine Load"),t.phenomenonNames.push(a.instant("ENGINE_LOAD")),t.phenomsIDs.push("ENGINE_LOAD")),n["GPS Speed"]&&(t.phenomenonNamesEnglish.push("GPS Speed"),t.phenomenonNames.push(a.instant("GPS_SPEED")),t.phenomsIDs.push("GPS_SPEED"))}),t.$on("toolbar:language-changed",function(e,n){console.log("language changed received."),t.phenomenonNames=[];for(var r=0;r<t.phenomsIDs.length;r++)t.phenomenonNames.push(a.instant(t.phenomsIDs[r]));console.log(t.phenomenonNames),t.phenomenon=t.phenomenonNames[t.storeSelection],t.currentPhenomenonDisplayName=t.phenomenon})}],angular.module("enviroCar").controller("PhenomenonDropdownCtrl",PhenomenonDropdownCtrl)}(),function(){function e(){"use strict";return{restrict:"A",replace:!0,template:'<div class="phenomenon-select" ><label><select ng-model="currentPhenomenonDisplayName"ng-options="phenomenonName for phenomenonName in phenomenonNames"ng-change="changePhenomenon(currentPhenomenonDisplayName)"></select></label></div>',controller:"PhenomenonDropdownCtrl"}}angular.module("enviroCar").directive("phenomenonDropdown",e)}(),function(){"use strict";function e(e){"ngInject";console.log(e.filters),e.showAlert=function(){}}function t(){return{restrict:"E",replace:!0,transclude:!0,scope:{title:"@",description:"@",btn_help:"@",btn_edit:"@",btn_close:"@",template:"@",options:"@"},template:'<md-card flex="100">   <div layout="row" flex="100">       <p style="color:#1A80C1;background-color:white; margin-left:20px;">           <span>{{title| translate}}</span>       </p>       <div layout="row" flex>           <span flex class="flex"></span>           <md-button ng-click="btn_help()" class="md-icon-button md-accent" aria-label="Info">               <md-icon class="material-icons  md-24">info</md-icon>               <md-tooltip>                   {{"CLICK_FOR_MORE_INFO"| translate}}               </md-tooltip>           </md-button>           <md-button ng-click="btn_edit" class="md-icon-button md-accent" aria-label="edit">               <md-icon class="material-icons md-24">build</md-icon>               <md-tooltip>                   {{"CLICK_TO_CHANGE_FILTER_OPTION"| translate}}               </md-tooltip>           </md-button>           <md-button ng-click="btn_close; filtersChanged()" class="md-icon-button md-warn" aria-label="close">               <md-icon class="material-icons  md-24">close</md-icon>               <md-tooltip>                   {{"CLICK_TO_REMOVE"| translate}}               </md-tooltip>           </md-button>       </div>   </div>   <div ng-include="template"/></md-card>',compile:function(e,t,a){return function(e,t){a(e,function(e){t.append(e)})}}}}e.$inject=["$scope"],angular.module("enviroCar.tracks").directive("filterCard",t).controller("FilterDistanceCardCtrl",e)}(),function(){"use strict";function e(e){"ngInject"}e.$inject=["$scope"],angular.module("enviroCar.tracks").controller("muh",e)}(),function(){"use strict";function e(e,t,a){"ngInject";var n=a.getDateFilterState();e.dateStartCustom=e.date_min,e.dateEndCustom=e.date_max,e.filters.date.params.min=n.min?n.min:e.date_min,e.filters.date.params.min.setHours(0,0,0,0),e.filters.date.params.max=n.max?n.max:e.date_max,e.filters.date.params.max.setHours(23,59,0,0),e.sliderDate={minValue:n.min?n.min:e.date_min,maxValue:n.max?n.max:e.date_max,options:{floor:e.dateStartCustom.getTime(),ceil:e.dateEndCustom.getTime(),step:1,draggableRange:!0,getSelectionBarColor:function(e){return"#8cbf3f"},getPointerColor:function(e){return"#8cbf3f"},translate:function(e){var t=new Date(e);return'<font color="black">'+t.getDate()+"-"+(t.getMonth()+1)+"-"+t.getFullYear()+"</font>"},id:"sliderDistance",onChange:function(t){e.changeSelectionRange(e.sliderDate.minValue,e.sliderDate.maxValue)}}},e.setToUnused=function(){e.filters.date.inUse=!1,a.setFilterInUse("date",!1)},e.changeSelectionRange=function(t,n){e.filters.date.params.min=new Date(t),e.filters.date.params.min.setHours(0,0,0,0),e.filters.date.params.max=new Date(n),e.filters.date.params.max.setHours(23,59,0,0);var r=new Date(t);r.setHours(0,0,0,0);var o=new Date(n);o.setHours(23,59,0,0),a.setDateFilterState(!0,r,o),e.filters.date.inUse=!0,e.filtersChanged()},e.filtersChanged(),t(function(){window.dispatchEvent(new Event("resize"))},50),t(function(){window.dispatchEvent(new Event("resize"))},50)}e.$inject=["$scope","$timeout","FilterStateService"],angular.module("enviroCar.tracks").controller("FilterDateCardCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/tracks/all_tracks_pagination_tab/filter_cards/date/filter_date_card.directive.html",controller:"FilterDateCardCtrl"}}angular.module("enviroCar.tracks").directive("filterDateCard",e)}(),function(){"use strict";function e(e,t,a){"ngInject";var n=a.getDistanceFilterState();e.filters.distance.params.min=n.min?n.min:e.distance_min,e.filters.distance.params.max=n.max?n.max:e.distance_max,e.sliderDistance={minValue:n.min?n.min:e.distance_min,maxValue:n.max?n.max:e.distance_max,options:{floor:e.distance_min,ceil:e.distance_max,step:1,draggableRange:!0,getSelectionBarColor:function(e){return"#8cbf3f"},getPointerColor:function(e){return"#8cbf3f"},translate:function(e){return'<font color="black">'+e+"km</font>"},id:"sliderDistance",onChange:function(t){e.changeSelectionRange(e.sliderDistance.minValue,e.sliderDistance.maxValue)}}},e.filtersChanged(),t(function(){window.dispatchEvent(new Event("resize"))},50),e.setToUnused=function(){e.filters.distance.inUse=!1,a.setFilterInUse("distance",!1)},e.changeSelectionRange=function(t,n){e.filters.distance.params.min=t,e.filters.distance.params.max=n,a.setDistanceFilterState(!0,t,n),e.filters.distance.inUse=!0,e.filtersChanged()},t(function(){window.dispatchEvent(new Event("resize"))},50)}e.$inject=["$scope","$timeout","FilterStateService"],angular.module("enviroCar.tracks").controller("FilterDistanceCardCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/tracks/all_tracks_pagination_tab/filter_cards/distance/filter_distance_card.directive.html",controller:"FilterDistanceCardCtrl"}}angular.module("enviroCar.tracks").directive("filterDistanceCard",e)}(),function(){"use strict";function e(e,t,a){"ngInject";var n=a.getDurationFilterState();e.filters.duration.params.min=n.min?n.min:e.duration_min,e.filters.duration.params.max=n.max?n.max:e.duration_max,e.sliderDuration={minValue:n.min?n.min:e.duration_min,maxValue:n.max?n.max:e.duration_max,options:{floor:e.duration_min,ceil:e.duration_max,step:1,draggableRange:!0,getSelectionBarColor:function(e){return"#8cbf3f"},getPointerColor:function(e){return"#8cbf3f"},translate:function(e){return'<font color="black">'+e+"min</font>"},id:"sliderDistance",onChange:function(t){e.changeSelectionRange(e.sliderDuration.minValue,e.sliderDuration.maxValue)}}},e.setToUnused=function(){e.filters.duration.inUse=!1,a.setFilterInUse("duration",!1)},e.changeSelectionRange=function(t,n){e.filters.duration.params.min=t,e.filters.duration.params.max=n,a.setDurationFilterState(!0,t,n),e.filters.duration.inUse=!0,e.filtersChanged()},e.filtersChanged(),t(function(){window.dispatchEvent(new Event("resize"))},50),t(function(){window.dispatchEvent(new Event("resize"))},50)}e.$inject=["$scope","$timeout","FilterStateService"],angular.module("enviroCar.tracks").controller("FilterDurationCardCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/tracks/all_tracks_pagination_tab/filter_cards/duration/filter_duration_card.directive.html",controller:"FilterDurationCardCtrl"}}angular.module("enviroCar.tracks").directive("filterDurationCard",e)}(),function(){"use strict";function e(e,t,a){"ngInject";e.errorNothingSelected=!1,e.items=[],e.selected=[];var n=a.getVehicleFilterState();if(e.filters.vehicle.params.cars_set=n.set.length>0?n.set:[],e.filters.vehicle.params.cars_all=n.all.length>0?n.all:[],e.items=e.filters.vehicle.params.cars_all,e.selected=e.filters.vehicle.params.cars_set,e.filters.vehicle.params.cars_set.length>0);else{for(var r=0;r<e.items.length;r++)e.selected.push(e.items[r]),e.filters.vehicle.params.cars_set.push(e.items[r]);n.set=e.filters.vehicle.params.cars_set}e.setToUnused=function(){e.filters.vehicle.inUse=!1,a.setFilterInUse("vehicle",!1)},e.hide=function(){e.errorNothingSelected=!1,0===e.filters.vehicle.params.cars_set.length?e.errorNothingSelected=!0:(e.filters.vehicle.inUse=!0,e.filtersChanged(),a.setVehicleFilterState(!0,e.filters.vehicle.params.cars_all,e.filters.vehicle.params.cars_set))},e.toggle=function(t,a){var n=a.indexOf(t);if(n>-1){1===e.filters.vehicle.params.cars_set.length&&(e.errorNothingSelected=!0),a.splice(n,1);var r=e.filters.vehicle.params.cars_set.indexOf(t);r>-1&&e.filters.vehicle.params.cars_set.splice(r,1)}else a.push(t),e.filters.vehicle.params.cars_set.push(t);e.hide()},e.exists=function(e,t){return t.indexOf(e)>-1},e.hide(),e.filtersChanged(),t(function(){window.dispatchEvent(new Event("resize"))},50)}e.$inject=["$scope","$timeout","FilterStateService"],angular.module("enviroCar.tracks").controller("FilterVehicleCardCtrl",e)}(),function(){function e(){return{restrict:"EA",templateUrl:"./app/components/tracks/all_tracks_pagination_tab/filter_cards/vehicle/filter_vehicle_card.directive.html",controller:"FilterVehicleCardCtrl"}}angular.module("enviroCar.tracks").directive("filterVehicleCard",e)}(),function(){SpatialDialogCtrl=["$scope","$mdDialog","$timeout","UserService","FilterStateService","UserCredentialsService",function(e,t,a,n,r,o){"ngInject";e.okay_pressed=!1,e.errorOverlap=!1,e.errorServerRequest=!1;var s=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{name:"OpenStreetMap",type:"xyz"});a(function(){if(e.mymap=L.map("spatial_filter_dialog_map",{center:[51.505,-.09],zoom:10,layers:[s]}),e.drawnItems=new L.FeatureGroup,e.mymap.addLayer(e.drawnItems),e.drawOptions={position:"bottomright",draw:{polyline:!1,polygon:!1,circle:!1,rectangle:{metric:!1,showArea:!0,shapeOptions:{color:"#1A80C1"}},marker:!1},edit:{featureGroup:e.drawnItems,remove:!1}},e.drawControl=new L.Control.Draw(e.drawOptions),e.mymap.addControl(e.drawControl),e.mymap.on(L.Draw.Event.CREATED,function(t){console.log(t);var a=t.layer;void 0!==e.old&&e.drawnItems.removeLayer(e.old),void 0!==e.loaded&&e.drawnItems.removeLayer(e.loaded),e.filters.spatial.layer=a,e.drawnItems.addLayer(e.filters.spatial.layer);var n=a._latlngs[0];e.northEast={lat:n[2].lat,lng:n[2].lng},e.southWest={lat:n[0].lat,lng:n[0].lng},e.old=a,e.drawnItems.addLayer(a)}),e.filters.spatial.inUse)void 0!==e.filters.spatial.params.southwest.lat&&(e.southWest.lat=e.filters.spatial.params.southwest.lat),void 0!==e.filters.spatial.params.southwest.lng&&(e.southWest.lng=e.filters.spatial.params.southwest.lng),void 0!==e.filters.spatial.params.northeast.lat&&(e.northEast.lat=e.filters.spatial.params.northeast.lat),void 0!==e.filters.spatial.params.northeast.lng&&(e.northEast.lng=e.filters.spatial.params.northeast.lng),e.updateDialogMap();else{void 0!==r.getSpatialFilterState().northeast.lat?(void 0!==e.filters.spatial.params.southwest.lat&&(e.southWest.lat=e.filters.spatial.params.southwest.lat),void 0!==e.filters.spatial.params.southwest.lng&&(e.southWest.lng=e.filters.spatial.params.southwest.lng),void 0!==e.filters.spatial.params.northeast.lat&&(e.northEast.lat=e.filters.spatial.params.northeast.lat),void 0!==e.filters.spatial.params.northeast.lng&&(e.northEast.lng=e.filters.spatial.params.northeast.lng),e.updateDialogMap()):(e.username=o.getCredentials().username,n.getUserStatistic(e.username).then(function(t){var n=t.data.trackSummaries;if(console.log(n),n.length>0){var r,o,s,i;n[0].endPosition.geometry.coordinates[1]<n[0].startPosition.geometry.coordinates[1]?(r=n[0].endPosition.geometry.coordinates[1],o=n[0].startPosition.geometry.coordinates[1]):(r=n[0].startPosition.geometry.coordinates[1],o=n[0].endPosition.geometry.coordinates[1]),n[0].endPosition.geometry.coordinates[0]<n[0].startPosition.geometry.coordinates[0]?(s=n[0].endPosition.geometry.coordinates[0],i=n[0].startPosition.geometry.coordinates[0]):(s=n[0].startPosition.geometry.coordinates[0],i=n[0].endPosition.geometry.coordinates[0]);for(var l=1;l<n.length;l++){var c=n[l].startPosition.geometry.coordinates,d=n[l].endPosition.geometry.coordinates;r>c[1]&&(r=c[1]),r>d[1]&&(r=d[1]),s>c[0]&&(s=c[0]),s>d[0]&&(s=d[0]),o<c[1]&&(o=c[1]),o<d[1]&&(o=d[1]),i<c[0]&&(i=c[0]),i<d[0]&&(i=d[0])}var u=new L.LatLng(r,s),m=new L.LatLng(o,i),h=new L.LatLngBounds(u,m);e.mymap.fitBounds(h)}window.dispatchEvent(new Event("resize")),a(function(){window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)},function(e){console.log(e)}))}},300),e.northEast={lat:void 0,lng:void 0},e.southWest={lat:void 0,lng:void 0},e.updateDialogMap=function(){a(function(){var t=new L.LatLng(e.filters.spatial.params.southwest.lat,e.filters.spatial.params.southwest.lng),a=new L.LatLng(e.filters.spatial.params.northeast.lat,e.filters.spatial.params.northeast.lng),n=new L.LatLngBounds(t,a);if(e.mymap.fitBounds(n),void 0!==e.filters.spatial.layer){var r=new L.Rectangle([t,a]);e.loaded=r.addTo(e.drawnItems)}},300)},e.hide=function(){if(e.errorOverlap=!1,e.ptMissing=!1,void 0===e.southWest.lat&&void 0===e.northEast.lat)e.ptMissing=!0;else if(e.southWest.lat>=e.northEast.lat||e.southWest.lng>=e.northEast.lng)e.errorOverlap=!0;else{e.okay_pressed=!0;var o=e.filters.spatial.params.southwest,s=e.filters.spatial.params.northeast;o.lat=e.southWest.lat,o.lng=e.southWest.lng,s.lat=e.northEast.lat,s.lng=e.northEast.lng,n.getUserTracksBBox(e.username,e.filters.spatial.params.southwest.lng,e.filters.spatial.params.southwest.lat,e.filters.spatial.params.northeast.lng,e.filters.spatial.params.northeast.lat).then(function(a){e.filters.spatial.params.track_ids=[];for(var n=0;n<a.data.tracks.length;n++){var i=a.data.tracks[n];e.filters.spatial.params.track_ids.push(i.id)}e.filters.spatial.inUse=!0,r.setSpatialFilterState(!0,o.lat,o.lng,s.lat,s.lng,e.filters.spatial.params.track_ids),t.hide(),e.filtersChanged()},function(t){console.log("error "+t),a(function(){e.okay_pressed=!1,e.errorServerRequest=!0,window.dispatchEvent(new Event("resize"))},300),a(function(){window.dispatchEvent(new Event("resize"))},500)})}},e.cancel=function(){t.cancel()},e.$on("toolbar:language-changed",function(e,t){})}],angular.module("enviroCar.tracks").controller("SpatialDialogCtrl",SpatialDialogCtrl)}(),function(){"use strict";function e(e,t,a,n){"ngInject";var r=new L.FeatureGroup;e.onEachFeature=function(e,t){t.on({mouseover:function(){},mouseout:function(){},click:function(){}})},angular.extend(e,{map2:{spatial_bounds_card:{},layers_card:{baselayers:{osm:{name:"OpenStreetMap",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz"}}},drawOptions:{position:"bottomright",draw:{polyline:!1,polygon:!1,circle:!1,rectangle:{metric:!1,showArea:!0,shapeOptions:{color:"blue"},edit:!1},marker:!1,edit:!1},edit:{featureGroup:r,remove:!1,edit:!1}},geojson:{data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[e.filters.spatial.params.southwest.lng,e.filters.spatial.params.southwest.lat],[e.filters.spatial.params.southwest.lng,e.filters.spatial.params.northeast.lat],[e.filters.spatial.params.northeast.lng,e.filters.spatial.params.northeast.lat],[e.filters.spatial.params.northeast.lng,e.filters.spatial.params.southwest.lat]]]},properties:{name:"Area1"}}]},style:{fillColor:"#1A80C1",fillOpacity:.3,weight:2,opacity:.5,color:"#1A80C1"},onEachFeature:e.onEachFeature},defaults:{scrollWheelZoom:!1,zoomControl:!1,doubleClickZoom:!1,dragging:!1}}}),e.setToUnused=function(){e.filters.spatial.inUse=!1,n.setFilterInUse("spatial",!1)},e.updateMap=function(){t(function(){e.map2.geojson={data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[e.filters.spatial.params.southwest.lng,e.filters.spatial.params.southwest.lat],[e.filters.spatial.params.southwest.lng,e.filters.spatial.params.northeast.lat],[e.filters.spatial.params.northeast.lng,e.filters.spatial.params.northeast.lat],[e.filters.spatial.params.northeast.lng,e.filters.spatial.params.southwest.lat]]]},properties:{name:"Area1"}}]},style:{fillColor:"#1A80C1",fillOpacity:.3,weight:2,opacity:.5,color:"#1A80C1"},onEachFeature:e.onEachFeature};var t=(e.filters.spatial.params.northeast.lat-e.filters.spatial.params.southwest.lat)/10;e.map2.spatial_bounds_card=a.createBoundsFromArray([[e.filters.spatial.params.northeast.lat+t,e.filters.spatial.params.northeast.lng],[e.filters.spatial.params.southwest.lat-t,e.filters.spatial.params.southwest.lng]]),window.dispatchEvent(new Event("resize"))},100),t(function(){window.dispatchEvent(new Event("resize"))},500)},e.updateMap(),e.$on("filter:spatial-filter-changed",function(t,a){e.updateMap()}),e.$on("toolbar:language-changed",function(t,a){e.updateMap()}),e.filtersChanged(),t(function(){window.dispatchEvent(new Event("resize"))},50),t(function(){window.dispatchEvent(new Event("resize"))},50)}e.$inject=["$scope","$timeout","leafletBoundsHelpers","FilterStateService"],angular.module("enviroCar.tracks").controller("FilterSpatialCardCtrl",e)}(),function(){function e(){return{restrict:"EA",
templateUrl:"./app/components/tracks/all_tracks_pagination_tab/filter_cards/spatial/filter_spatial_card.directive.html",controller:"FilterSpatialCardCtrl"}}angular.module("enviroCar.tracks").directive("filterSpatialCard",e)}();